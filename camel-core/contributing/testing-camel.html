<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Testing Camel :: Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/camel-core/contributing/testing-camel.html"> <meta name="generator" content="Antora 3.1.7"> <link rel="stylesheet" href="../../_/css/site-b287b96c63.css"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Testing Camel"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org"> <meta property="og:description" content="Camel is an open source integration framework that empowers you to quickly and easily integrate various systems consuming or producing data."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/_/img/logo-d-a567cee6fa.svg"> <link rel="manifest" href="../../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href="../.."></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../../blog/"> <img alt="Blog" src="/_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../docs/"> <img alt="Documentation" src="/_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../community/"> <img alt="Community" src="/_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../download/"> <img alt="Download" src="/_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../security/"> <img alt="Security" src="/_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="../../_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <div class="nav-container" data-component="camel-core" data-version=""> <aside class="nav" aria-label="Side menu"> <div class="panels"> <div class="nav-panel-menu is-active"> <nav class="nav-menu" data-panel="menu" aria-label="Topics"> <h3 class="title"><a href="../index.html">Camel Core</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../getting-started/index.html">Index</a> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title noversion">Camel Core</span> </div> <ul class="components"> <li class="component"> <span class="title"> <a href="../../manual/index.html">User manual</a> </span></li> <li class="component"><span class="title">Camel Components</span> <ul class="versions"> <li class="version"> <a href="../../components/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../components/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../../components/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../../components/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component is-current"> <span class="title"> <a href="../index.html">Camel Core</a> </span></li> <li class="component"><span class="title">Camel K</span> <ul class="versions"> <li class="version"> <a href="../../camel-k/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../camel-k/2.4.x/index.html">2.4.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Kafka Connector</span> <ul class="versions"> <li class="version"> <a href="../../camel-kafka-connector/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../camel-kafka-connector/4.8.x/index.html">4.8.x</a> </li> </ul></li> <li class="component"><span class="title">Kamelet Catalog</span> <ul class="versions"> <li class="version"> <a href="../../camel-kamelets/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../camel-kamelets/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../../camel-kamelets/4.4.x/index.html">4.4.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Karaf</span> <ul class="versions"> <li class="version"> <a href="../../camel-karaf/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Quarkus</span> <ul class="versions"> <li class="version"> <a href="../../camel-quarkus/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../camel-quarkus/3.15.x/index.html">3.15.x</a> </li> <li class="version"> <a href="../../camel-quarkus/3.8.x/index.html">3.8.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Spring Boot</span> <ul class="versions"> <li class="version"> <a href="../../camel-spring-boot/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../../camel-spring-boot/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../../camel-spring-boot/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../../camel-spring-boot/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> </ul> </div> </div> </aside> </div> <main class="article"> <nav class="toolbar" aria-label="Toolbar"> <button class="nav-toggle" type="button" aria-label="Toggle submenu"></button> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="../index.html">Camel Core</a></li> <li><a href="testing-camel.html">Testing Camel</a></li> </ul> </nav> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/main/docs/main/modules/contributing/pages/testing-camel.adoc">Edit this Page</a></div> </nav> <div class="content"> <article class="doc"> <h1 class="page">Testing Camel</h1> <div class="sect1"> <h2 id="_basic_testing"><a class="anchor" href="#_basic_testing"></a>Basic testing</h2> <div class="sectionbody"> <div class="paragraph"> <p>After you have <a href="building.html" class="xref page">Build</a> the code, you should test your changes. Our project follows <a href="http://maven.apache.org">Apache Maven</a> conventions for building and testing the code.</p> </div> <div class="paragraph"> <p>The code base relies on the <a href="https://maven.apache.org/surefire/maven-surefire-plugin/">Maven Surefire Plugin</a> for running the unit tests and the <a href="https://maven.apache.org/surefire/maven-failsafe-plugin/">Maven Failsafe Plugin</a> for running the integration tests.</p> </div> <div class="paragraph"> <p>To run the unit tests, use the following command:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn test</code></pre> </div> </div> <div class="paragraph"> <p>To run the integration tests, use the following command:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn verify</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>The command <code>mvn verify</code> will also run the unit tests.</p> </div> </td> </tr> </table></div> </div> <div class="paragraph"> <p>The set of tests executed may differ according to the platform, operating system and Java version used.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Our project has automation that will automatically test contributions made via pull-requests. Nonetheless, it&#8217;s always better to ensure your contribution works before sending it.</p> </div> </td> </tr> </table></div> </div> <div class="sect2"> <h3 id="_unit_tests_versus_integration_tests"><a class="anchor" href="#_unit_tests_versus_integration_tests"></a>Unit Tests versus Integration Tests</h3> <div class="paragraph"> <p>Since Camel is an integration framework, which by definition depends on external systems, tools and platforms to produce or consume data, the distinction of unit/integration tests may not be so clear.</p> </div> <div class="paragraph"> <p>Tests must follow the following naming convention:</p> </div> <div class="ulist"> <ul> <li> <p><code>*Test.java</code> (i.e.: MyComponentTest.java) for unit tests.</p> </li> <li> <p><code>*IT.java</code> (i.e.: MyComponentIT.java) for integration tests.</p> </li> <li> <p><code>*ManualTest.java</code> (i.e.: MyComponentManualTest.java) for manual tests.</p> </li> </ul> </div> </div> </div> </div> <div class="sect1"> <h2 id="_implementing_new_tests"><a class="anchor" href="#_implementing_new_tests"></a>Implementing new tests</h2> <div class="sectionbody"> <div class="paragraph"> <p>If you need to implement tests for your changes, which is highly recommended, you will probably need to handle three separate things:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>writing testable code</p> </li> <li> <p>writing Apache Camel tests</p> </li> <li> <p>simulating the infrastructure</p> </li> </ol> </div> <div class="sect2"> <h3 id="_writing_testable_code"><a class="anchor" href="#_writing_testable_code"></a>Writing testable code</h3> <div class="paragraph"> <p>Camel has multiple features to simplify testing. You can use those features to maximize your ability to test your code contribution. The <a href="../../manual/testing.html" class="xref page">Testing</a> page in the User Manual provides detailed information and examples for writing Camel tests.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Although the testing information on the User Manual is aimed at Camel users, the same features are also used to test Camel itself.</p> </div> </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_writing_apache_camel_tests"><a class="anchor" href="#_writing_apache_camel_tests"></a>Writing Apache Camel tests</h3> <div class="paragraph"> <p>Naturally, there is no rule of thumb for how the code changes, and test logic should be written. There are, however, a few things to avoid and good practices to follow when writing tests for Apache Camel.</p> </div> <div class="paragraph"> <p><strong>Things to avoid</strong>:</p> </div> <div class="ulist"> <ul> <li> <p>Calling <code>Thread.sleep</code> in tests</p> </li> <li> <p>Disabling tests without providing a reason (when needed, create a Jira ticket and use that as part of the reason string)</p> </li> <li> <p>Writing large tests</p> </li> <li> <p>Writing assertions without a fail message</p> </li> <li> <p>Writing custom profiles for enabling/disabling tests</p> </li> </ul> </div> <div class="paragraph"> <p><strong>Good things to do</strong>:</p> </div> <div class="ulist"> <ul> <li> <p>Use the <a href="http://www.awaitility.org/">Awaitility</a> library</p> </li> <li> <p>Writing small tests</p> </li> <li> <p>Coordinating test execution using <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-test-execution-order">JUnit&#8217;s @Order annotation</a></p> </li> <li> <p>Providing fail messages for assertions</p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="_simulating_the_test_infrastructure"><a class="anchor" href="#_simulating_the_test_infrastructure"></a>Simulating the test infrastructure</h3> <div class="paragraph"> <p>In many cases, it may be necessary to access or simulate access to a certain infrastructure to execute the tests.</p> </div> <div class="paragraph"> <p>As an integration framework, by nature, Camel needs to interact with other systems to execute its tests.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>Typical assumptions made when writing tests for user-level applications, don&#8217;t necessarily translate well to Camel. In many cases, it is necessary to evaluate the specific needs and requirements of each component. For instance, assumptions about whether it&#8217;s OK or not to reuse resources, whether data ordering matters, and a lot more have to be evaluated per-component.</p> </div> </td> </tr> </table></div> </div> <div class="paragraph"> <p>Camel has a growing library of reusable components to help providing the <a href="../../manual/test-infra.html" class="xref page">test infra structure</a>.</p> </div> <div class="paragraph"> <p>These components are located in the test-infra module and provide support for simulating message brokers, cloud environments, databases, and much more.</p> </div> <div class="paragraph"> <p>Using these components is usually as simple as registering them as JUnit 5 extensions:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterExtension
static NatsService service = NatsServiceFactory.createService();</code></pre> </div> </div> <div class="paragraph"> <p>Then you can access the service by using the methods and properties provided by the services. This varies according to each service.</p> </div> <div class="paragraph"> <p>If you need to implement a new test-infra service, check the <a href="../../manual/test-infra.html" class="xref page">test infra structure</a> documentation for additional details.</p> </div> </div> </div> </div> </article> <aside class="toc sidebar" aria-label="Table of contents" data-title="Contents" data-levels="2"> <div class="toc-menu"></div> </aside> </div> </main> </div> <div class="footer-tools"> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../../_/img/logo-d-a567cee6fa.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../../blog/">Blog</a></dd> <dd><a href="../../docs/">Documentation</a></dd> <dd><a href="../../community/support/">Community</a></dd> <dd><a href="../../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../../manual/">User Manual</a></dd> <dd><a href="../../components/next/index.html">Components</a></dd> <dd><a href="../../camel-k/next/">Camel-K</a></dd> <dd><a href="../../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../../community/support/">Support</a></dd> <dd><a href="../../community/contributing/">Contributing</a></dd> <dd><a href="../../community/mailing-list/">Mailing Lists</a></dd> <dd><a href="../../community/user-stories/">User stories</a></dd> <dd><a href="../../community/articles/">Articles</a></dd> <dd><a href="../../community/books/">Books</a></dd> <dd><a href="../../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use xlink:href="../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../../_/js/site-c215fb6972.js"></script> <script async src="../../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script async src="../../_/js/vendor/tabs-5aea11bcf5.js" data-sync-storage-key="preferred-tab"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https://camel.apache.org", "sameAs": [ "https://twitter.com/ApacheCamel" ], "logo": "../../_/img/logo-d-a567cee6fa.svg", "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Apache Camel", "item": "https://camel.apache.org/" }, { "@type": "ListItem", "position": 2, "name": "Camel Core", "item": "https://camel.apache.org/camel-core/index.html" }, { "@type": "ListItem", "position": 3, "name": "default", "item": "https://camel.apache.org/camel-core/index.html" }, { "@type": "ListItem", "position": 4, "name": "Testing Camel", "item": "https://camel.apache.org/camel-core/contributing/testing-camel.html" }] } </script> </body> </html> 