<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../../../favicon-128.png" sizes="128x128"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Camel K 1.0 is here"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org/blog/2020/06/camel-k-release-1.0.0/"> <meta name="og:description" content="What&#39;s new in the Camel K 1.0 GA release."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/blog/2020/06/camel-k-release-1.0.0/featured.png"> <link rel="manifest" href="../../../../site.webmanifest"> <title>Camel K 1.0 is here - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/blog/2020/06/camel-k-release-1.0.0/"> <link rel="stylesheet" href="../../../../_/css/site-b287b96c63.css"> </head> <body class="article"> <header class="header" aria-label="Header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href="../../../../" title="Apache Camel"></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../blog/"> <img alt="Blog" src="../../../../_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../docs/"> <img alt="Documentation" src="../../../../_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../community/"> <img alt="Community" src="../../../../_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../download/"> <img alt="Download" src="../../../../_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../security/"> <img alt="Security" src="../../../../_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="/_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <main role="main blog"> <article class="blog doc"> <header aria-labelledby="title"> <a class="category" href="../../../../categories/Releases/">RELEASES</a><a class="category" href="../../../../categories/Camel-K/">CAMEL K</a> <h1 id="title">Camel K 1.0 is here</h1> </header> <div class="post"> <aside aria-label="Post details"> <div class="summary">What&#39;s new in the Camel K 1.0 GA release.</div> Posted on <time itemprop="published" datetime="2020-06-08" title="Monday, June 8, 2020">June 8, 2020</time>, by <figure> <img src="https://avatars.githubusercontent.com/u/4151857?v=4" alt="Nicola Ferraro"> <figcaption rel="author">Nicola Ferraro</figcaption> </figure> <h4>Share this blog</h4> <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f06%2fcamel-k-release-1.0.0%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"> <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Camel%20K%201.0%20is%20here&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f06%2fcamel-k-release-1.0.0%2f&hashtags=ApacheCamel" target="_blank" rel="noopener" aria-label="Share on Twitter"> <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f06%2fcamel-k-release-1.0.0%2f&title=Camel%20K%201.0%20is%20here&summary=What%27s%20new%20in%20the%20Camel%20K%201.0%20GA%20release.&source=https%3A%2F%2Fcamel.apache.org" target="_blank" rel="noopener" aria-label="Share on LinkedIn" title="Share on LinkedIn"> <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg> </div> </div> </a> <p> <a class="arrow prev" href="../../../../blog/2020/06/camel-quarkus-release-1.0.0-CR2/" title="Previous post: Camel Quarkus 1.0.0-CR2 Released">&#10094;</a> <a class="arrow next" href="../../../../blog/2020/06/whatsnew-camel-3-webinar/" title="Next post: What&#39;s new with Apache Camel 3 webinar">&#10095;</a> </p> </aside> <div class="post-content"> <img class="featured" alt="Blog post featured image" src="../../../../blog/2020/06/camel-k-release-1.0.0/featured_hu31df77efa5dae096d0f9ef26e93d4fe1_334247_800x0_resize_q95_gaussian_3.png" width="800" height="596"> <p>Apache Camel K has made a lot of progress since its inception and we&rsquo;re now proud to <strong>announce the 1.0 release</strong>. We&rsquo;ve been working hard in the past months to add more awesome features to Camel K, but also to improve stability and performance. This post contains a list of cool stuff that you&rsquo;ll find in the 1.0 GA release.</p> <p>First of all, if you&rsquo;re living under a rock and it&rsquo;s the first time you hear about Camel K, you can read some introductory blog posts here (<a href="https://nicolaferraro.me/2018/10/15/introducing-camel-k/" rel="noopener nofollow noreferrer">1 - introducing camel k</a>, <a href="https://www.nicolaferraro.me/2018/12/10/camel-k-on-knative/" rel="noopener nofollow noreferrer">2 - camel k on knative</a>) or look at the Apache Camel website that contains a <a href="../../../../camel-k/next/">Camel K section</a> with a lot of material that is automatically generated from the <a href="https://github.com/apache/camel-k" rel="noopener nofollow noreferrer">Github repository</a>.</p> <h2 id="user-experience">User experience</h2> <p>Camel K development style is minimalistic: you need just to write a single file with your integration routes and you can immediately run them on any Kubernetes cluster. This way of defining things is common to many FaaS platforms (although Camel K is not a proper FaaS platform, but a lightweight <em>integration</em> platform) and it&rsquo;s technically difficult to provide IDE support, such as code completion and other utilities, to developers.</p> <p>But now we&rsquo;ve done it. The integration tooling team has created some cool extensions for VS Code that make the development experience with Camel K even more exciting. You don&rsquo;t need to remember the Camel DSL syntax, the IDE will give you suggestions and error highlighting.</p> <p><img src="./ide-autocompletion.gif" alt="IDE Autocompletion"></p> <p>Code completion works with Java code, but it&rsquo;s not only limited to it: you also have suggestions and documentation out of the box when writing the Camel URIs and property files. And you also have many options to run integrations and interact with them, all integrated in the IDE.</p> <p>Just install the VS Code <a href="https://marketplace.visualstudio.com/items?itemName=redhat.apache-camel-extension-pack" rel="noopener nofollow noreferrer">Extension Pack for Apache Camel</a> to have all these features available.</p> <h2 id="getting-started-tutorials">Getting started tutorials</h2> <p>Good tools are fundamental to have a great development experience with Camel K, but then you need to learn what you can do with such a great power. We&rsquo;ve created a new repository in the Apache organization that hosts getting started examples: the <a href="https://github.com/apache/camel-k-examples" rel="noopener nofollow noreferrer">camel-k-examples</a> repository.</p> <p>So far we&rsquo;ve added guides that drive you through:</p> <ul> <li><a href="https://github.com/apache/camel-k-examples/tree/master/01-basic" rel="noopener nofollow noreferrer">01 Basic</a>: Learn the basics of Camel K and some interesting use cases</li> <li><a href="https://github.com/apache/camel-k-examples/tree/master/02-serverless-api" rel="noopener nofollow noreferrer">02 Serverless APIs</a>: How to design a serverless (i.e. auto-scaling, scaling to zero) API and run it in a few minutes</li> </ul> <p>The <strong>basic quickstart is <a href="https://learn.openshift.com/middleware/courses/middleware-camelk/camel-k-basic" rel="noopener nofollow noreferrer">also available online</a></strong>, so you can have a look at how camel k works <strong>without installing anything on your laptop</strong>.</p> <p>More tutorials are expected to come in the following months. You are also welcome if you want to help us by <strong>contributing your own</strong>. They are based on the <a href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-didact" rel="noopener nofollow noreferrer">VSCode Didact</a> project, that provides an awesome user experience.</p> <p>If you are looking for Camel K code samples that you can just pick and run using the CLI, the <a href="https://github.com/apache/camel-k/tree/master/examples" rel="noopener nofollow noreferrer">examples directory</a> of the Camel K main repository contains a lot of them. You can also run them directly from Github:</p> <pre tabindex="0"><code>kamel run https://raw.githubusercontent.com/apache/camel-k/master/examples/Sample.java
</code></pre><p>You can find ready-to-use examples written in different languages (e.g. <a href="https://github.com/apache/camel-k/blob/5fb589090c2f45b28aef586118df48fad8838b3f/examples/hello.xml" rel="noopener nofollow noreferrer">XML</a>, <a href="https://github.com/apache/camel-k/blob/5fb589090c2f45b28aef586118df48fad8838b3f/examples/simple.js" rel="noopener nofollow noreferrer">JavaScript</a> and others).</p> <h2 id="serverless">Serverless</h2> <p>Serverless is the most important area where we&rsquo;re focusing the new developments in Apache Camel K, although, you should remember, you can have a wonderful Camel K experience even without serverless features. To enable the serverless profile in Camel K, you just need to have <strong><a href="https://knative.dev" rel="noopener nofollow noreferrer">Knative</a> installed</strong>.</p> <p>In recent releases, we have added support for the most recent advancements in Knative, for example, Camel K is very well integrated with the <strong>Knative event broker</strong> and you can easily produce or consume events from it.</p> <p>With <strong>2 lines of code</strong> you can transfer events (e.g. generated by IoT devices) <strong>from your MQTT broker to the mesh</strong>:</p> <p><em>bridge.groovy</em></p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">from</span><span class="o">(</span><span class="s1">&#39;paho:mytopic?brokerUrl=tcp://broker-address:1883&amp;clientId=knative-bridge&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">to</span><span class="o">(</span><span class="s1">&#39;knative:event/device-event&#39;</span><span class="o">)</span>
</span></span></code></pre></div><p>No kidding, you just need to write those two lines of code in a file and run it with <code>kamel run bridge.groovy</code> to push data into the Knative broker.</p> <p>And you can also scale the Integration out (<em>Integration</em> is a Kubernetes custom resource, <code>kubectl get integrations</code> to see all of them) to have a higher throughput. Scaling here is manual because the source of events is a MQTT broker (but we&rsquo;ve plans to put <a href="https://github.com/apache/camel-k/issues/1107" rel="noopener nofollow noreferrer">auto-scaling also in this scenario</a>).</p> <p>The Camel K embedded auto-scaling feature works really well when you want to react to some Knative events:</p> <p><em>listener.groovy</em></p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-groovy" data-lang="groovy"><span class="line"><span class="cl"><span class="n">from</span><span class="o">(</span><span class="s1">&#39;knative:event/device-event&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="na">to</span><span class="o">(</span><span class="s1">&#39;http://myhost/webhook/random-id&#39;</span><span class="o">)</span>
</span></span></code></pre></div><p>This integration is configured to receive all events with <code>type=device-event</code> and <strong>scales automatically with the load</strong> because it is materialized into a <a href="https://knative.dev/docs/serving/spec/knative-api-specification-1.0/#service" rel="noopener nofollow noreferrer">Knative Serving Service</a> and automatically <a href="https://knative.dev/docs/eventing/broker/" rel="noopener nofollow noreferrer">subscribed to the Eventing Broker via a Trigger</a>.</p> <p>It then receives a <a href="https://cloudevents.io/" rel="noopener nofollow noreferrer">CloudEvent</a> when your IoT devices produce something and scales down to zero if there&rsquo;s no data coming. You just need to create it (as before, just <code>kamel run listener.groovy</code>), all the remaining configuration is done <strong>automatically by the Camel K operator</strong>.</p> <p>We&rsquo;ve added much more features for having a better integration with the Knative ecosystem and we&rsquo;ve also fixed some compatibility and performance issues that were present in previous versions. The user experience is now much smoother.</p> <p>If you are a Knative YAML developer (!), instead of using Camel K directly, you also have the option to use <strong><a href="https://knative.dev/docs/eventing/samples/apache-camel-source/" rel="noopener nofollow noreferrer">Knative Camel Sources</a></strong> which are part of the Knative release. They are wrappers for Camel K integrations that are compatible with all the tools used by Knative developers (such as the <code>kn</code> CLI or the OpenShift serverless console). Sources in Knative can only push data into the various Knative endpoints, but not the other way around (i.e. they cannot be used to publish data from Knative to the outside). In Camel K you don&rsquo;t have this limitation: the Route is the fundamental building block of a Camel integration and you can do whatever you want with it.</p> <h2 id="fast-startup-and-low-memory">Fast startup and low memory</h2> <p>We cannot say we&rsquo;re serverless without mentioning the work that we&rsquo;ve been doing in improving the performance of Camel K integrations.</p> <p>Starting from <strong>Camel 3.3.0</strong> which is the default version used by Camel K 1.0.0, you can benefit from all improvements that have been made directly in the Camel core to make it much more lightweight. More in depth details of the Camel core improvements can be found the following blog series that highlights what has been changed in the 3.x Camel timeline to reduce memory footprint and speedup the startup time, which is foundamental when running integrations in a serverless environment: <a href="http://www.davsclaus.com/2020/01/apache-camel-31-more-camel-core.html?m=1" rel="noopener nofollow noreferrer">part 1</a>, <a href="http://www.davsclaus.com/2020/01/apache-camel-31-more-camel-core_30.html?m=1" rel="noopener nofollow noreferrer">part 2</a>, <a href="http://www.davsclaus.com/2020/02/apache-camel-31-more-camel-core.html?m=1" rel="noopener nofollow noreferrer">part 3</a>, <a href="http://www.davsclaus.com/2020/03/apache-camel-32-reflection-free.html?m=1" rel="noopener nofollow noreferrer">part 4</a>.</p> <p>But improvements are not only limited to the Camel core: we&rsquo;re doing much more. Several months ago we&rsquo;ve started a new subproject of Apache Camel named <a href="https://github.com/apache/camel-quarkus" rel="noopener nofollow noreferrer">&ldquo;Camel Quarkus&rdquo;</a> with the goal of seamlessly running integrations on top of the Quarkus framework. As you probably know, Quarkus is able to reduce the memory footprint of Java applications and improve the startup time, because it moves much startup logic to the build phase. And Quarkus applications can also be compiled to a native binary, allowing a dramatic improvements in startup performance and very low memory footprint.</p> <p>In Camel K 1.0.0 we support <strong>Camel Quarkus in JVM mode</strong>. A goal is to have also the in-cluster native compilation soon (for some DSL languages, such as YAML), in one of next releases!</p> <p>To use Quarkus as underlying runtime, you just need to enable the <strong><a href="../../../../camel-k/next/traits/quarkus.html">Quarkus trait</a></strong> when running an integration:</p> <pre tabindex="0"><code>kamel run myintegration.groovy -t quarkus.enabled=true
</code></pre><p>Quarkus is expected to be the default underlying runtime in the next release, and support for Standalone mode (via camel-main) will be deprecated and removed. This means that you won&rsquo;t need to enable Quarkus manually in the next releases, but you still need to do it in 1.0.</p> <h2 id="fast-build-time">Fast build time</h2> <p>Every application running on Kubernetes needs to be packaged in a container image, but <strong>in Camel K you only provide the integration DSL and the operator does what it takes to run it</strong>, including building images directly in the cluster.</p> <p>The operator manages a pool of reusable container images and if you redeploy your integration code, it does try to reuse existing images from the pool rather than building a new one at each change, because it takes some time to build a new one. <strong>It was 1 minute at the beginning&hellip;</strong></p> <p>But Kubernetes is moving so fast that you cannot solve a problem once and forget about it, you need to take care of it continuously. It happened that some of our third party dependencies that we used for doing builds in &ldquo;vanilla Kube&rdquo; has slowly degraded in performance up to a point where Camel K user experience was highly affected.</p> <p>We decided to work harder on the build system in order to dramatically improve (again!) the build phase of Camel K integrations.</p> <p>Build time can be be now measured in seconds in dev environments such as Minikube. <strong>A bunch of seconds</strong>, most of the times. This is more than a simple improvement!</p> <h2 id="better-cli">Better CLI</h2> <p>The &lsquo;kamel&rsquo; CLI is the main tool we provide to developers to run integrations. It&rsquo;s not a mandatory requirement: at the end, an Integration is a Kubernetes custom resources and you can manage it with any Kubernetes standard tool (e.g. <code>kubectl</code>). But the <code>kamel</code> CLI adds a lot of value for integration developers.</p> <p>For example, if you&rsquo;re a Camel Java developer it&rsquo;s not super easy to remember the boilerplate that you have to write in order to instantiate a Camel route builder. Now you don&rsquo;t have to remember that:</p> <pre tabindex="0"><code>kamel init Handler.java
</code></pre><p>You get a Java file with <strong>all the boilerplate written for you</strong> and you just have to write your integration routes.</p> <p>It works also with all other languages: Groovy, XML, YAML, Kotlin and JavaScript. For example you can write:</p> <pre tabindex="0"><code>kamel init foo.js
</code></pre><p>This way you get a simple route written in JavaScript.</p> <p>It&rsquo;s not just that. Often Camel K developers need to add a lot of command line options to configure the final behavior of their integration. For example, you may want to add a custom library with the <code>-d</code> option or configure a trait with <code>-t</code>. E.g.:</p> <pre tabindex="0"><code>kamel run -d mvn:org.my:lib:1.0.0 -d mvn:org.my:otherlib:2.0.0 -t quarkus.enabled=true Handler.java
</code></pre><p>Sometimes the number of command line parameters you&rsquo;ve to add <strong>can become too many</strong>. For this reason we&rsquo;ve added the possibility to specify them as <strong>modeline options</strong> in the integration file (done by adding a comment line with <code>camel-k:</code> as prefix).</p> <p><em>Handler.java</em></p> <pre tabindex="0"><code>// camel-k: dependency=mvn:org.my:lib:1.0.0 dependency=mvn:org.my:otherlib:2.0.0 trait=quarkus.enabled=true

// ...
// your routes here
</code></pre><p>Once the options are written in the file, you can run the routes with just:</p> <pre tabindex="0"><code>// simply this, additional args are read from the file
kamel run Handler.java
</code></pre><p>The other options are taken automatically from the file modeline. The CLI also displays the full command to let you know what&rsquo;s running.</p> <p>This kind of configuration is extremely useful in CI/CD scenarios because it allows you to have self-contained integration files and you don&rsquo;t need to change the pipeline to setup additional options. If you&rsquo;re curious about the CI/CD configurations, you can follow the tutorial about Tekton pipelines to have more information.</p> <h2 id="monitoring-and-tracing">Monitoring and Tracing</h2> <p>Ok, you&rsquo;ve finished level 1 of Camel K development and you want to make serious things. You&rsquo;re in a very good position because Camel K provides a lot of useful tools to add visibility on <strong>what your integration routes are doing</strong>.</p> <p>Let&rsquo;s suppose you&rsquo;ve a <strong><a href="https://prometheus.io/" rel="noopener nofollow noreferrer">Prometheus</a></strong> instance in your namespace and you want to <strong>publish your integration metrics</strong>:</p> <pre tabindex="0"><code>kamel run Routes.java -t prometheus.enabled=true
</code></pre><p>That&rsquo;s it. No need to setup services and labels to enable scraping. A default prometheus configuration file is also provided for the integration, with sensible defaults. Of course you also have the option to provide <a href="../../../../camel-k/next/traits/prometheus.html">your own configuration</a> for advanced use cases.</p> <p>Now, let&rsquo;s suppose you want to see what your routes are doing and trace the execution flow of an integration. What you need to do is to install an opentracing compatible application in the namespace, such as <strong><a href="https://www.jaegertracing.io/" rel="noopener nofollow noreferrer">Jaeger</a></strong>, and run the integration as:</p> <pre tabindex="0"><code>kamel run Routes.java -t prometheus.enabled=true -t tracing.enabled=true
</code></pre><p>That&rsquo;s it again. The Camel K operator will add the camel-opentracing library and <strong>connect it to the Jaeger collector that is available in the namespace</strong>.</p> <h2 id="master-routes">Master routes</h2> <p>Good old Camel users know why and when master routes are useful, but for those who are not familiar with the term, I&rsquo;m going to provide a brief explanation.</p> <p>Whenever you have an integration route that must be running, at any point in time, in at most one single Camel instance, you need to use a master route. Master routes can be declared by simply prefixing the consumer endpoint by the &lsquo;master&rsquo; keyword and a name that will be used to create a named lock, e.g.</p> <pre tabindex="0"><code>from(&#39;master:mylock:telegram:bots&#39;)
  .to(&#39;log:info&#39;)
</code></pre><p>It can be used to print all messages that are sent to your Telegram bot. Since the Telegram API support a single consumer only, you can guard the route with a master prefix to have the guarantee that there will be at most only one consumer at any given time.</p> <p>If you&rsquo;re wondering how there can be two instances running of you deploy one, well, think just to when you change your code and need to do a rolling update: for some time there&rsquo;ll be two pods running in parallel. In some cases, you may decide to scale your service out but keep only one instance of a particular route among all the pods of your service. Or you may want to embed a master route in a Knative autoscaling service: in this case, the service can scale autonomously based on the load, but there&rsquo;ll be only one telegram consumer at any time.</p> <p>Master routes <strong>work out of the box</strong> in Camel K, you just need to put a prefix in your endpoint uri. <strong>A leader election protocol</strong> based on Kubernetes APIs resource locks will be <strong>automatically configured</strong> for you!</p> <h2 id="cronjobs">CronJobs</h2> <p>All complex enough systems contain several scheduled jobs. This is especially true for that part of the system that handles integration with the outside.</p> <p>Ideally, if you need to execute a quick periodic task, say, every two seconds, you would startup an integration with a route based on timer to execute the periodic task. E.g.</p> <pre tabindex="0"><code>from(&#34;timer:task?period=2000&#34;)
  .to(this, &#34;businessLogic&#34;)
</code></pre><p>But if the period between two executions, instead of 2 seconds (&ldquo;2000&rdquo; in the Camel URI, which is measured in milliseconds) is 2 minutes (&ldquo;120000&rdquo;) or 2 hours (&ldquo;7200000&rdquo;)?</p> <p>You can see that keeping a container with a JVM running for a task that should be executed once every two minutes may be overkill (it is overkill for sure when the period is 2 hours). We live in a time where resources such as <strong>memory and CPU are really valuable</strong>.</p> <p>So the Camel K operator automatically handles this situation by deploying your integration not as a Kubernetes deployment, but as a <strong>Kubernetes CronJob</strong>. This saves a lot of resources, especially when the period between executions is high. When it&rsquo;s time to run your integration code, a container starts, triggers the execution and then gracefully terminates. Everything is handled automatically by Camel K and Kubernetes.</p> <p>There are cases when you don&rsquo;t want this feature to be enabled, for example, when your code makes use of in memory caches that is better to keep between executions. In these cases, you can safely turn off the feature by passing the flag <code>-t cron.enabled=false</code> to the <code>kamel run</code> command.</p> <p>The Cron feature does not only work with the <code>timer</code> component. We&rsquo;ve also added a <a href="../../../../components/next/cron-component.html">cron component</a> since Camel 3.1 that works really well in combination with the <a href="../../../../camel-k/next/traits/cron.html">cron trait</a>.</p> <p>So you can also write the cron expression in the route directly:</p> <pre tabindex="0"><code>from(&#34;cron:job?schedule=0/5+*+*+*+?&#34;)
  .to(this, &#34;businessLogic&#34;)
</code></pre><p>In this case, a new pod with a JVM is started every 5 minutes to execute your scheduled task. For the remaining 4+ minutes you don&rsquo;t use any resource.</p> <h2 id="transparency">Transparency</h2> <p>Camel K does a lot of work for you when you run your integration code in the cluster and it&rsquo;s possible that you put some errors in the code that can block the deployment process. We&rsquo;ve added a lot of visibility on the deployment process that now communicates with the users via Kubernetes events that are printed to the console when you use the CLI.</p> <p>This way you&rsquo;re always notified of problems in the code and you can better understand what to fix to make your integration run.</p> <h2 id="how-to-try-camel-k-10">How to try Camel K 1.0</h2> <p>The first step is to go to the <a href="https://github.com/apache/camel-k/releases" rel="noopener nofollow noreferrer">Camel K release page</a> on Github (or the official <a href="https://dist.apache.org/repos/dist/release/camel/camel-k/1.0.0/" rel="noopener nofollow noreferrer">Apache release repository</a>), <strong>download the kamel CLI</strong> for your OS and put it in your system path.</p> <p>Installation is done usually using the <code>kamel install</code> command, but, depending on the kind of Kubernetes cluster you&rsquo;re using, you may need to execute additional configuration steps. The Camel K documentation contains a section about <strong><a href="../../../../camel-k/next/installation/installation.html">installing it on various types of Kubernetes clusters</a></strong>.</p> <p>If you have trouble or you need to install it on a particular cluster that is not listed, just reach out in the <a href="https://gitter.im/apache/camel-k" rel="noopener nofollow noreferrer">Gitter chat</a> and we&rsquo;ll do our best to help you.</p> <h2 id="future">Future</h2> <p>We&rsquo;ve reached version 1.0.0 and this is a great milestone for us. But we are not going to stop now: we&rsquo;ve big plans for the future and we&rsquo;ll continue to develop awesome new features.</p> <p>We need your help to improve Camel K and <strong>we love contributions!</strong></p> <p>Join us on:</p> <ul> <li>Gitter: <a href="https://gitter.im/apache/camel-k" rel="noopener nofollow noreferrer">https://gitter.im/apache/camel-k</a></li> <li>GitHub: <a href="https://github.com/apache/camel-k" rel="noopener nofollow noreferrer">https://github.com/apache/camel-k</a></li> </ul> <div class="related"> </div> </div> </div> </article> </main> </div> <div class="footer-tools"> <a title="Improve this document, receive free virtual hugs &hearts;" href="https://github.com/apache/camel-website/edit/main/content/blog/2020/06/camel-k-release-1.0.0/index.md">Edit this Page</a> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img class="logo" src="../../../../_/img/logo-d-a567cee6fa.svg" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../../../../blog/">Blog</a></dd> <dd><a href="../../../../docs/">Documentation</a></dd> <dd><a href="../../../../community/support/">Community</a></dd> <dd><a href="../../../../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../../../../manual/">User Manual</a></dd> <dd><a href="../../../../components/next/index.html">Components</a></dd> <dd><a href="../../../../camel-k/next/">Camel-K</a></dd> <dd><a href="../../../../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../../../../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../../../../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../../../../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../../../../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../../../../community/support/">Support</a></dd> <dd><a href="../../../../community/contributing/">Contributing</a></dd> <dd><a href="../../../../community/mailing-list">Mailing Lists</a></dd> <dd><a href="../../../../community/user-stories/">User stories</a></dd> <dd><a href="../../../../community/articles/">Articles</a></dd> <dd><a href="../../../../community/books/">Books</a></dd> <dd><a href="../../../../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../../../../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../../../../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../../../../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../../../../_/js/site-c215fb6972.js"></script> <script async src="../../../../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../../../../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https:\/\/camel.apache.org\/" , "sameAs": ["https://twitter.com/ApacheCamel"] , "logo": "https:\/\/camel.apache.org\/_\/img\/logo-d.svg" , "description": "Apache Camel â„¢ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1 , "item": { "@id": "https://camel.apache.org/", "name": "Apache Camel" } },{ "@type": "ListItem", "position": 2 , "item": { "@id": "https://camel.apache.org/blog/", "name": "blog" } },{ "@type": "ListItem", "position": 3 , "item": { "@id": "https://camel.apache.org/blog/2020/", "name": "2020" } },{ "@type": "ListItem", "position": 4 , "item": { "@id": "https://camel.apache.org/blog/2020/06/", "name": "06" } },{ "@type": "ListItem", "position": 5 , "item": { "@id": "https://camel.apache.org/blog/2020/06/camel-k-release-1.0.0/", "name": "camel-k-release-1.0.0" } }] } </script> </body> </html> 