<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../../../favicon-128.png" sizes="128x128"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Upgrading to Camel 3.0.0 with Windup"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org/blog/2020/09/windup/"> <meta name="og:description" content="Plan your upgrade to Camel 3.0.0"> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/_/img/logo-d.svg"> <link rel="manifest" href="../../../../site.webmanifest"> <title>Upgrading to Camel 3.0.0 with Windup - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/blog/2020/09/windup/"> <link rel="stylesheet" href="../../../../_/css/site-b287b96c63.css"> </head> <body class="article"> <header class="header" aria-label="Header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href="../../../../" title="Apache Camel"></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../blog/"> <img alt="Blog" src="../../../../_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../docs/"> <img alt="Documentation" src="../../../../_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../community/"> <img alt="Community" src="../../../../_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../download/"> <img alt="Download" src="../../../../_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../security/"> <img alt="Security" src="../../../../_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="/_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <main role="main blog"> <article class="blog doc"> <header aria-labelledby="title"> <a class="category" href="../../../../categories/Tooling/">TOOLING</a> <h1 id="title">Upgrading to Camel 3.0.0 with Windup</h1> </header> <div class="post"> <aside aria-label="Post details"> <div class="summary">Plan your upgrade to Camel 3.0.0</div> Posted on <time itemprop="published" datetime="2020-09-07" title="Monday, September 7, 2020">September 7, 2020</time>, by <figure> <img src="https://avatars.githubusercontent.com/u/2589562?v=4" alt=""> <figcaption rel="author"></figcaption> </figure> <h4>Share this blog</h4> <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f09%2fwindup%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"> <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Upgrading%20to%20Camel%203.0.0%20with%20Windup&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f09%2fwindup%2f&hashtags=ApacheCamel" target="_blank" rel="noopener" aria-label="Share on Twitter"> <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2020%2f09%2fwindup%2f&title=Upgrading%20to%20Camel%203.0.0%20with%20Windup&summary=Plan%20your%20upgrade%20to%20Camel%203.0.0&source=https%3A%2F%2Fcamel.apache.org" target="_blank" rel="noopener" aria-label="Share on LinkedIn" title="Share on LinkedIn"> <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg> </div> </div> </a> <p> <a class="arrow prev" href="../../../../blog/2020/09/RELEASE-3.5.0/" title="Previous post: RELEASE 3.5.0">&#10094;</a> <a class="arrow next" href="../../../../blog/2020/09/Camel35-Whatsnew/" title="Next post: Apache Camel 3.5 What&#39;s New">&#10095;</a> </p> </aside> <div class="post-content"> <h2 id="tldr">TL;DR:</h2> <p><a href="https://github.com/windup/windup#installation-and-usage" rel="noopener nofollow noreferrer">Install</a> Windup and generate your migration report to Camel 3.0.0 by running:</p> <pre><code>_bin/mta-cli --input PATH_TO_CAMEL_PROJET --sourceMode --source camel:2 --target camel:3_
</code></pre> <p>Checkout sample reports for <a href="http://windup.surge.sh/cia2/reports/migration_issues.html" rel="noopener nofollow noreferrer">Camel in Action, Second Edition</a>, <a href="http://windup.surge.sh/cookbook/reports/migration_issues.html" rel="noopener nofollow noreferrer">Apache Camel Developer&rsquo;s Cookbook</a> and <a href="http://windup.surge.sh/mastering/reports/migration_issues.html" rel="noopener nofollow noreferrer">Mastering Apache Camel</a>.</p> <h2 id="introduction">Introduction</h2> <p>Camel 3.0.0 has been released in late 2019 which comes a decade after Camel 2.0.0 was released back in 2009. Camel 3 is a major upgrade from Camel 2 with lots of breaking changes. The Camel team has done a great job <a href="../../../../manual/camel-3-migration-guide.html">documenting</a> those changes. In order to ease the upgrade, <a href="https://github.com/mmelko" rel="noopener nofollow noreferrer">Matej</a> and I have decided to leverage the open source application migration tool <a href="https://github.com/windup/windup" rel="noopener nofollow noreferrer">Windup</a> and extend it&rsquo;s existing migration <a href="https://github.com/windup/windup-rulesets" rel="noopener nofollow noreferrer">rules</a> by adding Camel 2.x &ndash;&gt; Camel 3 <a href="https://github.com/windup/windup-rulesets/tree/master/rules-reviewed/camel3/camel2" rel="noopener nofollow noreferrer">rules</a>.</p> <h2 id="running-windup-locally">Running Windup locally</h2> <p>The easiest way to run Windup against your Camel 2 project is to follow the installation <a href="https://github.com/windup/windup#installation-and-usage" rel="noopener nofollow noreferrer">instructions</a> which is just downloading a ZIP archive containing a <em>bin/mta-cli</em> executable. Unfortunately, you will need to create a <a href="https://developers.redhat.com" rel="noopener nofollow noreferrer">https://developers.redhat.com</a> account if you don&rsquo;t have one already. You can then run it against your project:</p> <pre><code>_./mta-cli --input PATH_TO_CAMEL_PROJET --sourceMode --source camel:2 --target camel:3_
</code></pre> <p>and that&rsquo;s it! Once it&rsquo;s done, you should see a message containing the location of the generated Windup report which you can view by opening the generated <em>index.html</em> file with your favorite browser.</p> <p>To get an idea of what a Windup report looks like, I&rsquo;ve generated and published Windup reports for source codes of well known Camel books: <a href="http://windup.surge.sh/cia2/reports/migration_issues.html" rel="noopener nofollow noreferrer">Camel in Action, Second Edition</a>, <a href="http://windup.surge.sh/cookbook/reports/migration_issues.html" rel="noopener nofollow noreferrer">Apache Camel Developer&rsquo;s Cookbook</a> and <a href="http://windup.surge.sh/mastering/reports/migration_issues.html" rel="noopener nofollow noreferrer">Mastering Apache Camel</a>.</p> <h2 id="contributing">Contributing</h2> <p>If you like what you see and want to contribute: good news! Windup loves <a href="https://github.com/windup/windup#get-involved" rel="noopener nofollow noreferrer">PRs</a> üòÅ</p> <p>We&rsquo;ve created tasks for Camel <a href="https://issues.redhat.com/browse/WINDUPRULE-391" rel="noopener nofollow noreferrer">3.0</a> &ndash;&gt; <a href="https://issues.redhat.com/browse/WINDUPRULE-519" rel="noopener nofollow noreferrer">3.1</a>&ndash;&gt;<a href="">3.2</a>&ndash;&gt;<a href="https://issues.redhat.com/browse/WINDUPRULE-521" rel="noopener nofollow noreferrer">3.3</a>.</p> <p>To get an idea of what needs to be done to create a new rule, let&rsquo;s look at some examples.</p> <p>The <a href="https://github.com/windup/windup-rulesets/tree/master/rules-reviewed/camel3/camel2" rel="noopener nofollow noreferrer">rules</a> can be either written in Groovy or XML. Groovy rules are more powerful than XML rules but if you prefer writting XML and the rule isn&rsquo;t too complicated, you can go for XML. Each file contains rules whose filename describes what kind of rules it holds. For example, the file <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/xml-removed-components.windup.xml" rel="noopener nofollow noreferrer">xml-removed-components.windup.xml</a> contains XML rules that check whether your project uses Camel Components that have been removed in Camel 3. As with programming in general, some file names are better than others. For each file there is a corresponding test file and a test folder that are used to test your rules.</p> <p>For example, <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/xml-removed-components.windup.xml" rel="noopener nofollow noreferrer">xml-removed-components.windup.xml</a> contains the rule with id <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/xml-removed-components.windup.xml#L15" rel="noopener nofollow noreferrer">xml-removed-components-00000</a> that checks whether your Maven project is using the <em>camel-linkedin</em> component, which has been removed in Camel 3, and if so, output a helpful message:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&#34;xml-removed-components-00000&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;project&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifact</span> <span class="na">groupId=</span><span class="s">&#34;org.apache.camel&#34;</span> <span class="na">artifactId=</span><span class="s">&#34;camel-linkedin&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/project&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;perform&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;hint</span> <span class="na">title=</span><span class="s">&#34;`org.apache.camel:camel-linkedin` artifact has been removed&#34;</span> <span class="na">effort=</span><span class="s">&#34;7&#34;</span> <span class="na">category-id=</span><span class="s">&#34;mandatory&#34;</span> <span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;message&gt;</span>`org.apache.camel:camel-linkedin` artifact has been removed in Apache Camel 3 so it won&#39;t be available<span class="nt">&lt;/message&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&#34;/manual/camel-3-migration-guide.html#_removed_components&#34;</span> <span class="na">title=</span><span class="s">&#34;Camel 3 - Migration Guide: Removed components&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/hint&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/perform&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/rule&gt;</span>
</span></span></code></pre></div><p>It&rsquo;s corresponding test is located in <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/tests/xml-removed-components.windup.test.xml#L10" rel="noopener nofollow noreferrer">tests/xml-removed-components.windup.test.xml</a>:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&#34;xml-removed-components-00000-test&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;not&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;iterable-filter</span> <span class="na">size=</span><span class="s">&#34;1&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;hint-exists</span> <span class="na">message=</span><span class="s">&#34;`org.apache.camel:camel-linkedin` artifact has been removed in Apache Camel 3 so it won&#39;t be available&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/iterable-filter&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/not&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;perform&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;fail</span> <span class="na">message=</span><span class="s">&#34;[xml-removed-components] &#39;camel-linkedin&#39; dependency removed hint was not found!&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/perform&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/rule&gt;</span>
</span></span></code></pre></div><p>which tests that given the <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/tests/xml-removed-components.windup.test.xml#L5" rel="noopener nofollow noreferrer">test resources</a> located in the test <a href="https://github.com/windup/windup-rulesets/tree/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/tests/data/xml-removed-components" rel="noopener nofollow noreferrer">folder</a>, the camel-linkedin error message is produced exactly once. The syntax for writting rules is pretty self explanatory but you can always check the official <a href="https://access.redhat.com/documentation/en-us/red_hat_application_migration_toolkit/4.3/html/rules_development_guide/index" rel="noopener nofollow noreferrer">documentation</a> for help. You can run the tests in <em>xml-removed-components.windup.test.xml</em> by running:</p> <pre><code>_mvn -DrunTestsMatching=xml-removed-components clean test_.
</code></pre> <p>Notice how the rule only checks if the project refers to <em>org.apache.camel:camel-linkedin</em>. Sometimes that dependency is pulled transitively and so a better idea would be to <em>also</em> check whether your project contains Java, Blueprint or Spring files referencing the LinkedIn Camel Component. You can find how to do that in XML by looking at the rule that checks for usage of the <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/xml-removed-components.windup.xml#L67" rel="noopener nofollow noreferrer">twitter-streaming</a> Component. A similar <a href="https://github.com/windup/windup-rulesets/blob/2cc95ff40536c31f8c836e3acf7339d53ab4b282/rules-reviewed/camel3/camel2/xml-moved-components.windup.groovy#L59" rel="noopener nofollow noreferrer">example</a> exists in Groovy for AWS Components.</p> <p>As you&rsquo;ve probably figured out by now, the best way to write a new rule is to look at existing ones.</p> <h2 id="limitations">Limitations</h2> <p>As we&rsquo;ve seen in the previous section, the rules are only as powerful as you&rsquo;ve written them to be. However there are some limitations. Behind the scenes, Windup uses parsing. It will not compile your project. This has some limitations. For example, the following snippets checks whether some deprecated methods are used:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&#34;java-generic-information-00032&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;javaclass</span> <span class="na">references=</span><span class="s">&#34;org.apache.camel.CamelContext.{get|set}Propert{y|ies}({*})&#34;</span> <span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;location&gt;</span>METHOD_CALL<span class="nt">&lt;/location&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/javaclass&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;perform&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;hint</span> <span class="na">title=</span><span class="s">&#34;`org.apache.camel.CamelContext` property methods have been removed.&#34;</span> <span class="na">effort=</span><span class="s">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">category-id=</span><span class="s">&#34;mandatory&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;message&gt;</span>The `getProperties` and `setProperty` methods have been removed from `org.apache.camel.CamelContext`. Please use `getGlobalOptions` and `setGlobalOptions` instead<span class="nt">&lt;/message&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;link</span> <span class="na">title=</span><span class="s">&#34;Camel 3 - Migration Guide: CONFIGURING GLOBAL OPTIONS ON CAMELCONTEXT&#34;</span>
</span></span><span class="line"><span class="cl">                  <span class="na">href=</span><span class="s">&#34;/manual/camel-3-migration-guide.html#_configuring_global_options_on_camelcontext&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/hint&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/perform&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/rule&gt;</span>
</span></span></code></pre></div><p>When running the rule, Windup will scan your Java files and try to find ones that import <em>org.apache.camel.CamelContext</em> and then use the <em>{get|set}Propert{y|ies}({*})</em> regular expression to match method names on declared variables of type <em>CamelContext</em>. One would think that it convers all use cases right? Well no. What if the class in question is a sublclass of another class that already imports <em>org.apache.camel.CamelContext</em> ? Then the subclass doesn&rsquo;t need to reimport it and the Windup rule won&rsquo;t detect it&rsquo;s usage. This also happens when chaining method calls e.g <code>getCamelContext().getProperties()</code> which happens a lot in Camel.</p> <p>Another problem is string interpolation. When writting a rule that tries to match a certain String, for example:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;rule</span> <span class="na">id=</span><span class="s">&#34;xml-removed-components-00004&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;when&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;filecontent</span> <span class="na">pattern=</span><span class="s">&#34;from(&amp;quot;twitter-streaming:{*}&#34;</span> <span class="na">filename=</span><span class="s">&#34;{*}.java&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/when&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;perform&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;hint</span> <span class="na">title=</span><span class="s">&#34;`twitter-streaming` component has been removed&#34;</span> <span class="na">effort=</span><span class="s">&#34;7&#34;</span> <span class="na">category-id=</span><span class="s">&#34;mandatory&#34;</span> <span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;message&gt;</span>`twitter-streaming` component has been deprecated in Apache Camel 2 and removed in Apache Camel 3 because it relied on the deprecated Twitter Streaming API and is no longer functional.<span class="nt">&lt;/message&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&#34;/manual/camel-3-migration-guide.html#_removed_components&#34;</span> <span class="na">title=</span><span class="s">&#34;Camel 3 - Migration Guide: Removed components&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/hint&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/perform&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/rule&gt;</span>
</span></span></code></pre></div><p>tries to match Camel routes using the <em>twitter-streaming</em> component by matching <em>from(&ldquo;twitter-streaming&hellip;&rdquo;</em> in .java files. However if the route URI is stored in a variable as so:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">String</span><span class="w"> </span><span class="n">route_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;twitter-streaming://filter?type=event&amp;twitterStream=#twitterStream&amp;keywords=#cameltest&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">from</span><span class="p">(</span><span class="n">route_uri</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">transform</span><span class="p">(</span><span class="n">body</span><span class="p">().</span><span class="na">convertToString</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&#34;direct:result&#34;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>then the rule&rsquo;s regular expression will not match.</p> <p>Another limitation when writing XML rules is the lack of debugging capabilities. This can lead to some frustration. In best cases, this is because the project is setup incorrectly. In worst cases, it&rsquo;s because there is a bug in Windup or the rule syntax is misleading and should not be used that way. Fortunately, the latter doesn&rsquo;t happen too often and you can always ask for help by sending an email to <em>windup-users@lists.jboss.org</em> or using IRC on the irc.freenode.net #windup channel.</p> <p>Thanks!</p> <div class="related"> </div> </div> </div> </article> </main> </div> <div class="footer-tools"> <a title="Improve this document, receive free virtual hugs &hearts;" href="https://github.com/apache/camel-website/edit/main/content/blog/2020/09/windup/index.md">Edit this Page</a> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img class="logo" src="../../../../_/img/logo-d-a567cee6fa.svg" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../../../../blog/">Blog</a></dd> <dd><a href="../../../../docs/">Documentation</a></dd> <dd><a href="../../../../community/support/">Community</a></dd> <dd><a href="../../../../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../../../../manual/">User Manual</a></dd> <dd><a href="../../../../components/next/index.html">Components</a></dd> <dd><a href="../../../../camel-k/next/">Camel-K</a></dd> <dd><a href="../../../../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../../../../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../../../../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../../../../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../../../../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../../../../community/support/">Support</a></dd> <dd><a href="../../../../community/contributing/">Contributing</a></dd> <dd><a href="../../../../community/mailing-list">Mailing Lists</a></dd> <dd><a href="../../../../community/user-stories/">User stories</a></dd> <dd><a href="../../../../community/articles/">Articles</a></dd> <dd><a href="../../../../community/books/">Books</a></dd> <dd><a href="../../../../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../../../../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../../../../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../../../../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../../../../_/js/site-c215fb6972.js"></script> <script async src="../../../../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../../../../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https:\/\/camel.apache.org\/" , "sameAs": ["https://twitter.com/ApacheCamel"] , "logo": "https:\/\/camel.apache.org\/_\/img\/logo-d.svg" , "description": "Apache Camel ‚Ñ¢ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1 , "item": { "@id": "https://camel.apache.org/", "name": "Apache Camel" } },{ "@type": "ListItem", "position": 2 , "item": { "@id": "https://camel.apache.org/blog/", "name": "blog" } },{ "@type": "ListItem", "position": 3 , "item": { "@id": "https://camel.apache.org/blog/2020/", "name": "2020" } },{ "@type": "ListItem", "position": 4 , "item": { "@id": "https://camel.apache.org/blog/2020/09/", "name": "09" } },{ "@type": "ListItem", "position": 5 , "item": { "@id": "https://camel.apache.org/blog/2020/09/windup/", "name": "windup" } }] } </script> </body> </html> 