<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../../../favicon-128.png" sizes="128x128"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Apache Camel AI: Leverage power of AI with DJL component"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org/blog/2024/09/camel-ai-examples/"> <meta name="og:description" content="Explore the possibilities of intelligent routing based on neural network model inference with Camel and DJL."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/blog/2024/09/camel-ai-examples/featured.jpg"> <link rel="manifest" href="../../../../site.webmanifest"> <title>Apache Camel AI: Leverage power of AI with DJL component - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/blog/2024/09/camel-ai-examples/"> <link rel="stylesheet" href="../../../../_/css/site-b287b96c63.css"> </head> <body class="article"> <header class="header" aria-label="Header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href="../../../../" title="Apache Camel"></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../blog/"> <img alt="Blog" src="../../../../_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../docs/"> <img alt="Documentation" src="../../../../_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../community/"> <img alt="Community" src="../../../../_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../download/"> <img alt="Download" src="../../../../_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../../../../security/"> <img alt="Security" src="../../../../_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="/_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <main role="main blog"> <article class="blog doc"> <header aria-labelledby="title"> <a class="category" href="../../../../categories/Camel/">CAMEL</a><a class="category" href="../../../../categories/AI/">AI</a> <h1 id="title">Apache Camel AI: Leverage power of AI with DJL component</h1> </header> <div class="post"> <aside aria-label="Post details"> <div class="summary">Explore the possibilities of intelligent routing based on neural network model inference with Camel and DJL.</div> Posted on <time itemprop="published" datetime="2024-09-04" title="Wednesday, September 4, 2024">September 4, 2024</time>, by <figure> <img src="https://avatars.githubusercontent.com/u/156692?v=4" alt="Tadayoshi Sato"> <figcaption rel="author">Tadayoshi Sato</figcaption> </figure> <h4>Share this blog</h4> <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fcamel.apache.org%2fblog%2f2024%2f09%2fcamel-ai-examples%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"> <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Apache%20Camel%20AI%3a%20Leverage%20power%20of%20AI%20with%20DJL%20component&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2024%2f09%2fcamel-ai-examples%2f&hashtags=ApacheCamel" target="_blank" rel="noopener" aria-label="Share on Twitter"> <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg> </div> </div> </a> <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fcamel.apache.org%2fblog%2f2024%2f09%2fcamel-ai-examples%2f&title=Apache%20Camel%20AI%3a%20Leverage%20power%20of%20AI%20with%20DJL%20component&summary=Explore%20the%20possibilities%20of%20intelligent%20routing%20based%20on%20neural%20network%20model%20inference%20with%20Camel%20and%20DJL.&source=https%3A%2F%2Fcamel.apache.org" target="_blank" rel="noopener" aria-label="Share on LinkedIn" title="Share on LinkedIn"> <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg> </div> </div> </a> <p> <a class="arrow prev" href="../../../../blog/2024/08/camel-quarkus-release-3.14.0/" title="Previous post: Camel Quarkus 3.14.0 Released">&#10094;</a> <a class="arrow next" href="../../../../blog/2024/09/chunking-dsl/" title="Next post: Unlocking Efficient Data Processing with the Chunking DSL">&#10095;</a> </p> </aside> <div class="post-content"> <img class="featured" alt="Blog post featured image" src="../../../../blog/2024/09/camel-ai-examples/featured_hub2c43d19c655a75fc6dc62870ed0fd8c_370479_800x0_resize_q95_gaussian.jpg" width="800" height="1040"> <p><a href="../../../../components/next/ai-summary.html">Apache Camel AI</a> is a set of components that allow various AI-related technologies to be integrated with Camel.</p> <p>Nowadays, LLMs such as OpenAI ChatGPT and Meta Llama are gaining a lot of attention, and many frameworks and tools are exploring ways to utilise them. Camel AI also includes the LangChain4j component suite, and there are already blog posts about how you can utilise LLMs using <a href="https://docs.langchain4j.dev/" rel="noopener nofollow noreferrer">LangChain4j</a> in the Camel Blog:</p> <ul> <li><a href="../../../../blog/2024/02/camel-whatsapp-langchain4j/">Integrate your AI models effortlessly with Apache Camel</a> by Federico Mariani.</li> <li><a href="../../../../blog/2024/07/data-extraction-first-experiment/">Experimenting extraction from unstructured data with Apache Camel and LangChain4j</a> by Alexandre Gallice</li> </ul> <p>Behind this focus on LLMs, there is an often overlooked but yet important AI technology: inference using traditional neural network models that are not Transformer-based.</p> <h2 id="camel-djl-component">Camel DJL component</h2> <p>The <a href="../../../../components/next/djl-component.html">DJL component</a> is a Camel component that allows you to integrate <a href="https://djl.ai/" rel="noopener nofollow noreferrer">Deep Java Library</a>, a deep learning library for Java, with your Camel routes. The component can run models trained with popular machine learning frameworks such as PyTorch and TensorFlow to do inference in Java. It also supports models in <a href="https://onnx.ai/" rel="noopener nofollow noreferrer">ONNX</a> format, a standard format for machine learning models.</p> <p>The idea of incorporating the inference of these traditional machine learning models in system-to-system integration has not yet been fully explored. One of the features of traditional machine learning models compared to LLMs is that inference is a relatively lightweight process and thus can be performed on the fly in an integration.</p> <p>Unlike LLMs, each machine learning model is dedicated to a particular application, as follows:</p> <ul> <li>Computer vision (CV) <ul> <li>Image classification</li> <li>Object detection and image segmentation</li> <li>Body, facial expression and gesture analysis</li> <li>Image manipulation</li> </ul> </li> <li>Natural language processing (NLP) <ul> <li>Machine comprehension</li> <li>Machine translation</li> <li>Q&amp;A</li> </ul> </li> <li>Other <ul> <li>Speech recognition</li> <li>Time series forecasting</li> <li>Recommendation engines</li> </ul> </li> </ul> <p>The DJL component will be significantly improved in the coming Camel 4.8.0 LTS release <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. It will allow performing inference with models for those various applications.</p> <p>This blog post presents two examples of Camel AI that combine image recognition, natural language processing and speech recognition, to demonstrate what kinds of intelligent routing become possible with the DJL component that were nearly infeasible without it on Camel.</p> <h2 id="image-to-text-routing">Image to Text routing</h2> <p>One of the areas where neural network models excel is image processing: without AI technologies, it would be almost impossible to implement Camel routing that can identify objects in an incoming image, classify what is in it, and so on. The DJL component makes it easy to implement routings for such processing in real-time.</p> <p>Let&rsquo;s consider an example of edge AI. In this scenario, image data is recorded in snapshots from a camera input at the edge terminal, which is then read by Camel to perform classification and route the results to a central server.</p> <p><img src="./image-to-text.png" alt="Image to Text routing"></p> <h3 id="image-to-text-source-code">Image to Text: Source code</h3> <p>To realise this scenario, we use two pre-trained neural network models: <a href="https://arxiv.org/abs/1512.02325" rel="noopener nofollow noreferrer">SSD</a> and <a href="https://en.wikipedia.org/wiki/Residual_neural_network" rel="noopener nofollow noreferrer">ResNet</a>. The code is as follows:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java:image_to_text.java" data-lang="java:image_to_text.java"><span class="line"><span class="cl"><span class="c1">// camel-k: dependency=camel:djl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS ai.djl.pytorch:pytorch-engine:0.29.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS ai.djl.pytorch:pytorch-model-zoo:0.29.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS net.sf.extjwnl:extjwnl:2.0.5</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS net.sf.extjwnl:extjwnl-data-wn31:1.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.camel.Exchange</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.camel.RuntimeCamelException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.camel.builder.RouteBuilder</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.camel.component.djl.DJLConstants</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.modality.Classifications</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.modality.cv.Image</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">net.sf.extjwnl.data.POS</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">net.sf.extjwnl.data.PointerUtils</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">net.sf.extjwnl.dictionary.Dictionary</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">image_to_text</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">RouteBuilder</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">from</span><span class="p">(</span><span class="s">&#34;file:data/inbox?include=.*\\.(jpg|png)&#34;</span><span class="p">)</span><span class="w">    </span><span class="c1">// (1)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&#34;Processing: ${headers.camelFileName}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&#34;djl:cv/object_detection?artifactId=ssd&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">// (2)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">convertBodyTo</span><span class="p">(</span><span class="n">Image</span><span class="o">[]</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">                 </span><span class="c1">// (3)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="n">body</span><span class="p">())</span><span class="w">                                           </span><span class="c1">// (4)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&#34;djl:cv/image_classification?artifactId=resnet&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">// (4)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">                 * The output from the image classification model is classified
</span></span></span><span class="line"><span class="cl"><span class="cm">                 * as one of 1000 labels from WordNet.
</span></span></span><span class="line"><span class="cl"><span class="cm">                 * Since it&#39;s too fine-grained, we want to find the higher-level
</span></span></span><span class="line"><span class="cl"><span class="cm">                 * group (= hypernym) for the classification using the WordNet
</span></span></span><span class="line"><span class="cl"><span class="cm">                 * dictionary.
</span></span></span><span class="line"><span class="cl"><span class="cm">                 */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">process</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">extractClassName</span><span class="p">)</span><span class="w">          </span><span class="c1">// (5)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">process</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">addHypernym</span><span class="p">)</span><span class="w">               </span><span class="c1">// (5)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&#34;  =&gt; ${body}&#34;</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (6)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">extractClassName</span><span class="p">(</span><span class="n">Exchange</span><span class="w"> </span><span class="n">exchange</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchange</span><span class="p">.</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getBody</span><span class="p">(</span><span class="n">Classifications</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">body</span><span class="p">.</span><span class="na">best</span><span class="p">().</span><span class="na">getClassName</span><span class="p">().</span><span class="na">split</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">)</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">,</span><span class="w"> </span><span class="n">2</span><span class="p">)</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">exchange</span><span class="p">.</span><span class="na">getMessage</span><span class="p">().</span><span class="na">setBody</span><span class="p">(</span><span class="n">className</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">addHypernym</span><span class="p">(</span><span class="n">Exchange</span><span class="w"> </span><span class="n">exchange</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exchange</span><span class="p">.</span><span class="na">getMessage</span><span class="p">().</span><span class="na">getBody</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">dic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Dictionary</span><span class="p">.</span><span class="na">getDefaultResourceInstance</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dic</span><span class="p">.</span><span class="na">getIndexWord</span><span class="p">(</span><span class="n">POS</span><span class="p">.</span><span class="na">NOUN</span><span class="p">,</span><span class="w"> </span><span class="n">className</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">word</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeCamelException</span><span class="p">(</span><span class="s">&#34;Word not found: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">className</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">hypernyms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PointerUtils</span><span class="p">.</span><span class="na">getDirectHypernyms</span><span class="p">(</span><span class="n">word</span><span class="p">.</span><span class="na">getSenses</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">0</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">hypernym</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hypernyms</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="na">getSynset</span><span class="p">().</span><span class="na">getWords</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="n">0</span><span class="p">).</span><span class="na">getLemma</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">findFirst</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">className</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">exchange</span><span class="p">.</span><span class="na">getMessage</span><span class="p">().</span><span class="na">setBody</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">className</span><span class="p">,</span><span class="w"> </span><span class="n">hypernym</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>What the code does is as follows:</p> <ol> <li>Read image files (<code>.jpg</code> or <code>.png</code>) from the <code>data/inbox</code> directory</li> <li>Feed them to a pre-trained SSD model for object detection</li> <li>Convert the results of type <code>DetectedObjects</code> to <code>Image[]</code></li> <li>Split the <code>Image[]</code> data one by one and feed each into a pre-trained ResNet model for image classification</li> <li>Look up the hypernym of each classification result with the WordNet database</li> <li>Output the final results to log (or send them as a message to the central server in a real scenario)</li> </ol> <h3 id="image-to-text-running-the-example">Image to Text: Running the example</h3> <p>The code can be run with <a href="../../../../manual/camel-jbang.html">Camel JBang</a>:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">camel run --camel-version=4.8.0-SNAPSHOT image_to_text.java
</span></span></span></code></pre></div><p>(Post 4.8.0)</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">camel run image_to_text.java
</span></span></span></code></pre></div><p>For example, let&rsquo;s copy an image of <a href="https://kabosu112.exblog.jp/iv/detail/?s=9944144&amp;i=201002%2F12%2F90%2Fa0126590_22301391.jpg" rel="noopener nofollow noreferrer">Kabosu</a> a.k.a. Doge into <code>data/inbox</code>. We should get the following result:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cp doge.jpg data/inbox
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">INFO 26599 --- [le://data/inbox] image_to_text.java:26 : Processing: doge.jpg
</span></span><span class="line"><span class="cl">INFO 26599 --- [le://data/inbox] image_to_text.java:43 :   =&gt; [dingo, wild dog]
</span></span></code></pre></div><h3 id="github-repository-of-image-to-text-sample-code">GitHub repository of Image to Text sample code</h3> <p>The sample code is available in the following GitHub repository:</p> <p><a href="https://github.com/megacamelus/camel-ai-examples/tree/main/image-to-text" rel="noopener nofollow noreferrer">https://github.com/megacamelus/camel-ai-examples/tree/main/image-to-text</a></p> <h2 id="speech-to-text-routing">Speech to Text routing</h2> <p>Another area where neural network models are particularly proficient is natural language processing. AI is excellent at ambiguous natural language processing that is difficult to represent with algorithms, such as knowledge-based Q&amp;A, sentiment analysis of texts and machine translation.</p> <p>Let&rsquo;s consider another example, which combines sentiment analysis of sentences with speech recognition. Wave files recorded from a microphone input are read by Camel to convert them into texts by speech recognition and then apply sentiment analysis to determine whether they are positive or negative.</p> <p><img src="./speech-to-text.png" alt="Speech to Text routing"></p> <h3 id="speech-to-text-source-code">Speech to Text: Source code</h3> <p><em><strong>WARNING:</strong> At the moment, this sample code does not work on macOS (Apple Silicon). It is because the speech recognition model used is not compatible with Apple Silicon chips.</em></p> <p>To realise this scenario, we combine two pre-trained neural network models: <a href="https://arxiv.org/abs/2006.11477" rel="noopener nofollow noreferrer">wav2vec 2.0</a> and <a href="https://medium.com/huggingface/distilbert-8cf3380435b5" rel="noopener nofollow noreferrer">DistilBERT</a>. Here is the code:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// camel-k: dependency=camel:djl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS ai.djl.pytorch:pytorch-engine:0.29.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//DEPS ai.djl.pytorch:pytorch-model-zoo:0.29.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.URI</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.net.URISyntaxException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.file.Files</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.camel.builder.RouteBuilder</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.MalformedModelException</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.Model</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.modality.audio.translator.SpeechRecognitionTranslator</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">ai.djl.util.ZipUtils</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">speech_to_text</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">RouteBuilder</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">MODEL_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;https://resources.djl.ai/test-models/pytorch/wav2vec2.zip&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">MODEL_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;wav2vec2.ptl&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configure</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">loadSpeechToTextModel</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">from</span><span class="p">(</span><span class="s">&#34;file:data/inbox?include=.*\\.wav&#34;</span><span class="p">)</span><span class="w">                    </span><span class="c1">// (1)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&#34;Processing: ${headers.camelFileName}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&#34;djl:audio?model=SpeechToTextModel&amp;translator=SpeechToTextTranslator&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">// (2)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// The output of the model is all uppercase, which tends to be recognised</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// as negative by the following distilbert model</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">setBody</span><span class="p">(</span><span class="n">simple</span><span class="p">(</span><span class="s">&#34;${body.toLowerCase()}&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&#34;  =&gt; ${body}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&#34;djl:nlp/sentiment_analysis?artifactId=distilbert&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">// (3)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">log</span><span class="p">(</span><span class="s">&#34;  =&gt; ${body.best}&#34;</span><span class="p">);</span><span class="w">                              </span><span class="c1">// (4)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">loadSpeechToTextModel</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">MalformedModelException</span><span class="p">,</span><span class="w"> </span><span class="n">URISyntaxException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Load a model</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Model</span><span class="p">.</span><span class="na">newInstance</span><span class="p">(</span><span class="n">MODEL_NAME</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// TfModel doesn&#39;t allow direct loading from remote input stream yet</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// https://github.com/deepjavalibrary/djl/issues/3303</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">modelDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Files</span><span class="p">.</span><span class="na">createTempDirectory</span><span class="p">(</span><span class="n">MODEL_NAME</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ZipUtils</span><span class="p">.</span><span class="na">unzip</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">URI</span><span class="p">(</span><span class="n">MODEL_URL</span><span class="p">).</span><span class="na">toURL</span><span class="p">().</span><span class="na">openStream</span><span class="p">(),</span><span class="w"> </span><span class="n">modelDir</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">modelDir</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// Bind model beans</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getContext</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">getRegistry</span><span class="p">().</span><span class="na">bind</span><span class="p">(</span><span class="s">&#34;SpeechToTextModel&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">getRegistry</span><span class="p">().</span><span class="na">bind</span><span class="p">(</span><span class="s">&#34;SpeechToTextTranslator&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpeechRecognitionTranslator</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>What the code does is as follows:</p> <ol> <li>Read audio files (<code>.wav</code>) from the <code>data/inbox</code> directory</li> <li>Feed them to a pre-trained wav2vec 2.0 model for speech recognition</li> <li>Apply the resulted texts to a pre-trained DistilBERT model for sentiment analysis (classified as either <code>positive</code> or <code>negative</code>)</li> <li>Output the best results to log (or route them as a message to a queue in the message broker in a real scenario)</li> </ol> <h3 id="speech-to-text-running-the-example">Speech to Text: Running the example</h3> <p>This can also be run directly with Camel JBang:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">camel run --camel-version=4.8.0-SNAPSHOT speech_to_text.java
</span></span></span></code></pre></div><p>(Post 4.8.0)</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">camel run speech_to_text.java
</span></span></span></code></pre></div><p>Let&rsquo;s try downloading sample Wave files <code>speech*.wav</code> from the <a href="https://github.com/megacamelus/camel-ai-examples/tree/main/data/speech" rel="noopener nofollow noreferrer">sample repository</a> and copying them into <code>data/inbox</code>:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cp speech1.wav data/inbox
</span></span></span><span class="line"><span class="cl"><span class="go">cp speech2.wav data/inbox
</span></span></span><span class="line"><span class="cl"><span class="go">cp speech3.wav data/inbox
</span></span></span></code></pre></div><p>You will get the following results:</p> <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:26 : Processing: speech1.wav
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:31 :   =&gt; oh grreat many things so
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:33 :   =&gt; {&#34;class&#34;: &#34;Positive&#34;, &#34;probability&#34;: 0.87968}
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:26 : Processing: speech2.wav
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:31 :   =&gt; dan this is not acceptable i&#39;ve not even been notified about this automatic change
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:33 :   =&gt; {&#34;class&#34;: &#34;Negative&#34;, &#34;probability&#34;: 0.99945}
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:26 : Processing: speech3.wav
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:31 :   =&gt; many thanks that&#39;s so helpful i&#39;m a bit more relieved now
</span></span><span class="line"><span class="cl">INFO 3351853 --- [le://data/inbox] speech_to_text.java:33 :   =&gt; {&#34;class&#34;: &#34;Positive&#34;, &#34;probability&#34;: 0.97949}
</span></span></code></pre></div><h3 id="github-repository-of-speech-to-text-sample-code">GitHub repository of Speech to Text sample code</h3> <p>The sample code is available in the following GitHub repository:</p> <p><a href="https://github.com/megacamelus/camel-ai-examples/tree/main/speech-to-text" rel="noopener nofollow noreferrer">https://github.com/megacamelus/camel-ai-examples/tree/main/speech-to-text</a></p> <h2 id="how-can-inference-be-made-more-accurate">How can inference be made more accurate?</h2> <p>I hope that the two samples using the DJL component have shown that there is great potential in the combination of Camel and neural networks. On the other hand, some of you may not have been satisfied with the results of running the samples.</p> <p>The reliability of the outputs of an AI solution using machine learning models ultimately depends on how accurate the models are for the specific applications. All of the sample code here use only publicly available pre-trained models. There are already a large number of highly accurate pre-trained models available in the world:</p> <ul> <li><a href="https://github.com/onnx/models" rel="noopener nofollow noreferrer">ONNX Model Zoo</a></li> <li><a href="https://github.com/openvinotoolkit/open_model_zoo" rel="noopener nofollow noreferrer">OpenVINO - Open Model Zoo repository</a></li> <li><a href="https://github.com/PINTO0309/PINTO_model_zoo" rel="noopener nofollow noreferrer">PINTO_model_zoo</a></li> </ul> <p>To begin with, you can easily start building interesting AI solutions as Camel routing by simply combining some of the published models.</p> <p>Then, when you get to the stage where you need more rigorous inference accuracy, you will eventually need to train your own custom models. This principle applies not just to Camel AI but to the development of any AI solution. In such cases, you will need to prepare your own custom dataset and environment for model training. Fortunately, Camel DJL component supports various model formats such as PyTorch, TensorFlow and ONNX, so you can use classic PyTorch and TensorFlow frameworks directly for model training.</p> <h2 id="where-to-perform-inference-embedded-vs-external-serving">Where to perform inference: embedded vs. external serving</h2> <p>There is another important topic to consider when building routing with machine learning models in Camel: where inference should be performed.</p> <p>In the examples, all inference is performed <em>embedded</em> within the Camel route. This is because, unlike LLMs, it can perform inference at a speed that makes it possible. Nevertheless, multi-dimensional array data sent as messages must be computed in the multiple layers of a model. If the messages to be processed are large, or the model is complex with many layers, additional computational resources such as GPUs may be required to run the Camel route.</p> <p>When implementing a full-fledged machine learning solution with a Camel route, what can be more scalable is a configuration that delegates the execution of inference to an external server; machine learning frameworks such as PyTorch and TensorFlow provide the <em>serving</em> features that allow the frameworks&rsquo; inference engines to act as external servers via REST APIs. Camel can consume the inference servers as a REST client. In this case, Camel does not perform the inference directly in a route, but delegates it by calling the API over HTTP. Experts recommend this approach as it is considered easier to scale out as an enterprise AI solution.</p> <p>Which configuration really performs better is a difficult question. It reminds me of the EJB vs. POJO debate back in the application server days of the 2000s. The question is whether heavy processing should be distributed remotely or whether everything should be executed locally. In practice, it would be a trade-off between the efficiency of inference execution and the cost of transferring multi-dimensional arrays of input data over the network to make remote calls. Without benchmarking, it should not be possible to know which is really better.</p> <h2 id="summary">Summary</h2> <p>We have seen that the DJL component in the next Camel 4.8.0 LTS release will enable intelligent routing using various neural network models.</p> <p>There is still much room for the application of LLM and other AI technologies in the field of Camel-enabled enterprise integration. In fact, the idea of using neural network models in the world of system-to-system integration and Enterprise Integration Patterns (EIP) has only just begun to be explored. We will continue to enhance the DJL component and add more new components to further extend the capabilities of Camel AI.</p> <p>We will also continue to provide various examples of Camel AI in the following repository. If you are interested in this subject, please follow this repository:</p> <p><a href="https://github.com/megacamelus/camel-ai-examples" rel="noopener nofollow noreferrer">https://github.com/megacamelus/camel-ai-examples</a></p> <div class="footnotes" role="doc-endnotes"> <hr> <ol> <li id="fn:1"> <p>Actually, it has been already improved since 4.7.0. See: <a href="../../../../blog/2024/07/camel47-whatsnew/">Apache Camel 4.7 What&rsquo;s new</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p> </li> </ol> </div> <div class="related"> <h3 id="related"><a class="anchor" href="#related"></a>Related posts</h3> <article class="blog doc"> <header aria-label="Blog post"> <a href="../../../../blog/2024/07/data-extraction-first-experiment/"><h1>Experimenting extraction from unstructured data with Apache Camel and LangChain4j</h1></a> <time itemprop="published" datetime="2024-07-19" title="Friday, July 19, 2024">July 19, 2024</time>, by <span rel="author">Alexandre Gallice</span> </header> <p>This blog is based on experiments done about extracting structured data into its structured counterpart. More precisely, in this post, we&rsquo;ll give directions about how to convert a conversation transcript into a Java object. Introduction Reading articles like this over the net, it seems that folks have a lot of unstructured data at the disposal while not being able to take advantage on it. So probably, in the future we might expect to deal more and more with unstructured data extraction in integration flow.</p> <p><a class="continue" href="../../../../blog/2024/07/data-extraction-first-experiment/">Continue reading &#10095;</a></p> <p> <a class="category" href="../../../../categories/Camel/">CAMEL</a><a class="category" href="../../../../categories/AI/">AI</a> </p> </article> </div> </div> </div> </article> </main> </div> <div class="footer-tools"> <a title="Improve this document, receive free virtual hugs &hearts;" href="https://github.com/apache/camel-website/edit/main/content/blog/2024/09/camel-ai-examples/index.md">Edit this Page</a> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img class="logo" src="../../../../_/img/logo-d-a567cee6fa.svg" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../../../../blog/">Blog</a></dd> <dd><a href="../../../../docs/">Documentation</a></dd> <dd><a href="../../../../community/support/">Community</a></dd> <dd><a href="../../../../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../../../../manual/">User Manual</a></dd> <dd><a href="../../../../components/next/index.html">Components</a></dd> <dd><a href="../../../../camel-k/next/">Camel-K</a></dd> <dd><a href="../../../../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../../../../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../../../../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../../../../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../../../../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../../../../community/support/">Support</a></dd> <dd><a href="../../../../community/contributing/">Contributing</a></dd> <dd><a href="../../../../community/mailing-list">Mailing Lists</a></dd> <dd><a href="../../../../community/user-stories/">User stories</a></dd> <dd><a href="../../../../community/articles/">Articles</a></dd> <dd><a href="../../../../community/books/">Books</a></dd> <dd><a href="../../../../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../../../../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../../../../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use href="../../../../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../../../../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../../../../_/js/site-c215fb6972.js"></script> <script async src="../../../../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../../../../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https:\/\/camel.apache.org\/" , "sameAs": ["https://twitter.com/ApacheCamel"] , "logo": "https:\/\/camel.apache.org\/_\/img\/logo-d.svg" , "description": "Apache Camel  is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1 , "item": { "@id": "https://camel.apache.org/", "name": "Apache Camel" } },{ "@type": "ListItem", "position": 2 , "item": { "@id": "https://camel.apache.org/blog/", "name": "blog" } },{ "@type": "ListItem", "position": 3 , "item": { "@id": "https://camel.apache.org/blog/2024/", "name": "2024" } },{ "@type": "ListItem", "position": 4 , "item": { "@id": "https://camel.apache.org/blog/2024/09/", "name": "09" } },{ "@type": "ListItem", "position": 5 , "item": { "@id": "https://camel.apache.org/blog/2024/09/camel-ai-examples/", "name": "camel-ai-examples" } }] } </script> </body> </html> 