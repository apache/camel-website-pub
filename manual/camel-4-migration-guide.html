<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Apache Camel 3.x to 4.0 Migration Guide :: Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/manual/camel-4-migration-guide.html"> <meta name="generator" content="Antora 3.1.7"> <link rel="stylesheet" href="../_/css/site-b287b96c63.css"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Apache Camel 3.x to 4.0 Migration Guide"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org"> <meta property="og:description" content="Camel is an open source integration framework that empowers you to quickly and easily integrate various systems consuming or producing data."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/_/img/logo-d-a567cee6fa.svg"> <link rel="manifest" href="../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href=".."></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../blog/"> <img alt="Blog" src="/_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../docs/"> <img alt="Documentation" src="/_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../community/"> <img alt="Community" src="/_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../download/"> <img alt="Download" src="/_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../security/"> <img alt="Security" src="/_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="../_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <div class="nav-container" data-component="manual" data-version=""> <aside class="nav" aria-label="Side menu"> <div class="panels"> <div class="nav-panel-menu is-active"> <nav class="nav-menu" data-panel="menu" aria-label="Topics"> <h3 class="title"><a href="index.html">User manual</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="getting-started.html">Getting started</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Resources &amp; Guides</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/books/">Books</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="building.html">Building</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-console.html">Camel Developer Console</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="camel-jbang.html">Camel JBang</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-kubernetes.html">Camel Kubernetes plugin</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-k.html">Camel K plugin</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-plugin.html">Camel Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-component-maven-plugin.html">Camel Component Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-report-maven-plugin.html">Camel Maven Report Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-archetypes.html">Camel Maven Archetypes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="configuring-route-startup-ordering-and-autostartup.html">Configuring route startup ordering and autostartup</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component-dsl.html">Component DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="Endpoint-dsl.html">Endpoint DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dataformat-dsl.html">DataFormat DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="examples.html">Examples</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="graceful-shutdown.html">Graceful Shutdown</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-propertyplaceholder.html">How to use Camel property placeholders</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="variables.html">How to use Variables</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="testing.html">Testing</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="test-infra.html">Test Infra</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="notify-builder.html">NotifyBuilder</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="advice-with.html">AdviceWith</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="rest-dsl.html">Working with REST and Rest DSL</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="rest-dsl-openapi.html">Rest DSL contract first</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="writing-components.html">Writing Components</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="release-guide.html">Release guide</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="release-guide-website.html">Adding doc versions to the website</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="improving-the-documentation.html">Improving the Documentation</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="migration-and-upgrade.html">Migration and Upgrade</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a> </li> <li class="nav-item is-current-page" data-depth="2"> <a class="nav-link" href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-4x-upgrade-guide.html">Camel 4.x Upgrade Guide</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="architecture.html">Architecture</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-debugger.html">Backlog debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-tracer.html">Backlog Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-consumer.html">Batch Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-binding.html">Bean Binding</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-integration.html">Bean Integration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext.html">CamelContext</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext-autoconfigure.html">CamelContext Auto Configuration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="clustering.html">Clustering and Load Balancing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component.html">Component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="data-format.html">Data Format</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="debugger.html">Debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-interceptor.html">Delayer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint.html">Endpoints</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint-annotations.html">Endpoint Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exception-clause.html">Exception Clause</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pooling.html">Exchange Pooling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="http-session-handling.html">HTTP-Session Handling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-producing.html">POJO Producing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="producertemplate.html">ProducerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="consumertemplate.html">ConsumerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error Handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange.html">Message Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="expression.html">Expressions</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/content-enricher.html">Content Enrichment</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="injector.html">Injector</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/intercept.html">Intercept</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="jmx.html">JMX</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="oncompletion.html">OnCompletion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pluggable-class-resolvers.html">Pluggable Class Resolvers</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="predicate.html">Predicates</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="processor.html">Processor</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="registry.html">Registry</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-builder.html">RouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lambda-route-builder.html">LambdaRouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-controller.html">RouteController</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-policy.html">RoutePolicy</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-configuration.html">RouteConfiguration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="context-reload.html">ContextReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-reload.html">RouteReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-template.html">RouteTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routes.html">Routes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="startup-condition.html">Startup Condition</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stream-caching.html">Stream caching</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transformer.html">Transformer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="threading-model.html">Threading Model</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="tracer.html">Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="type-converter.html">Type Converter</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uris.html">URIs</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uuidgenerator.html">UuidGenerator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validator.html">Validator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="health-check.html">Health Checks</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Domain Specific Languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">Languages</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="java-dsl.html">Java DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring.html">Spring support</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="faq/index.html">FAQ</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/support/">How can I get help?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">What languages are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <span class="nav-text"><strong>Reference</strong></span> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/index.html">Components</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/dataformats/index.html">Data Formats</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/languages/index.html">Languages</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/eips/enterprise-integration-patterns.html">EIPs</a> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title noversion">User manual</span> </div> <ul class="components"> <li class="component is-current"> <span class="title"> <a href="index.html">User manual</a> </span></li> <li class="component"><span class="title">Camel Components</span> <ul class="versions"> <li class="version"> <a href="../components/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../components/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../components/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../components/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"> <span class="title"> <a href="../camel-core/index.html">Camel Core</a> </span></li> <li class="component"><span class="title">Camel K</span> <ul class="versions"> <li class="version"> <a href="../camel-k/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-k/2.4.x/index.html">2.4.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Kafka Connector</span> <ul class="versions"> <li class="version"> <a href="../camel-kafka-connector/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kafka-connector/4.8.x/index.html">4.8.x</a> </li> </ul></li> <li class="component"><span class="title">Kamelet Catalog</span> <ul class="versions"> <li class="version"> <a href="../camel-kamelets/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kamelets/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-kamelets/4.4.x/index.html">4.4.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Karaf</span> <ul class="versions"> <li class="version"> <a href="../camel-karaf/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Quarkus</span> <ul class="versions"> <li class="version"> <a href="../camel-quarkus/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-quarkus/3.15.x/index.html">3.15.x</a> </li> <li class="version"> <a href="../camel-quarkus/3.8.x/index.html">3.8.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Spring Boot</span> <ul class="versions"> <li class="version"> <a href="../camel-spring-boot/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> </ul> </div> </div> </aside> </div> <main class="article"> <nav class="toolbar" aria-label="Toolbar"> <button class="nav-toggle" type="button" aria-label="Toggle submenu"></button> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">User manual</a></li> <li><a href="migration-and-upgrade.html">Migration and Upgrade</a></li> <li><a href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a></li> </ul> </nav> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/main/docs/user-manual/modules/ROOT/pages/camel-4-migration-guide.adoc">Edit this Page</a></div> </nav> <div class="content"> <article class="doc"> <h1 class="page">Apache Camel 3.x to 4.0 Migration Guide</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This document is intended to help you migrate your Apache Camel applications from version 3.20 or higher to 4.0. If you are upgrading from an older Camel 3.x release, such as 3.14, then make sure to read the individual <a href="camel-3x-upgrade-guide.html" class="xref page">Camel 3.x Upgrade Guide</a> to upgrade to the 3.20 release, prior to upgrade to Camel 4.</p> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> If you are upgrading Camel 4.x to 4.y then use the <a href="camel-4x-upgrade-guide.html" class="xref page">Camel 4.x Upgrade Guide</a>. </td> </tr> </table></div> </div> </div> </div> <div class="sect1"> <h2 id="_java_versions"><a class="anchor" href="#_java_versions"></a>Java versions</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel 4 supports Java 17. Support for Java 11 is dropped.</p> </div> </div> </div> <div class="sect1"> <h2 id="_removed_components"><a class="anchor" href="#_removed_components"></a>Removed Components</h2> <div class="sectionbody"> <div class="paragraph"> <p>The following components have been removed:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Component</th> <th class="tableblock halign-left valign-top">Alternative component(s)</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-any23</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-atlasmap</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-atmos</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-caffeine-lrucache</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-cache, camel-ignite, camel-infinispan</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-cdi</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-spring-boot, camel-quarkus</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-corda</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-directvm</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-direct</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-dozer</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-mapstruct</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-elasticsearch-rest</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-elasticsearch</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-gora</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-hbase</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-hyperledger-aries</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-iota</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-ipfs</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-jbpm</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-jclouds</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-johnzon</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-jackson, camel-fastjson, camel-gson</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-microprofile-metrics</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-micrometer, camel-opentelemetry</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-milo</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-opentracing</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-micrometer, camel-opentelemetry</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-rabbitmq</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">spring-rabbitmq-component</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-rest-swagger</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-openapi-rest</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-restdsl-swagger-plugin</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-restdsl-openapi-plugin</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-resteasy</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-cxf, camel-rest</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-solr</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-spark</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-spring-integration</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-swagger-java</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-openapi-java</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-websocket</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-vertx-websocket</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-websocket-jsr356</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-vertx-websocket</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-vertx-kafka</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-kafka</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-vm</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-seda</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-weka</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-xstream</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-jacksonxml</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-zipkin</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel-micrometer, camel-opentelemetry</p></td> </tr> </tbody> </table></div> </div> </div> <div class="sect1"> <h2 id="_logging"><a class="anchor" href="#_logging"></a>Logging</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel 4 has upgraded logging facade API <code>slf4j-api</code> from 1.7 to 2.0.</p> </div> </div> </div> <div class="sect1"> <h2 id="_junit_4"><a class="anchor" href="#_junit_4"></a>JUnit 4</h2> <div class="sectionbody"> <div class="paragraph"> <p>All the <code>camel-test</code> modules that were JUnit 4.x based has been removed. All test modules now use JUnit 5.</p> </div> </div> </div> <div class="sect1"> <h2 id="_api_changes"><a class="anchor" href="#_api_changes"></a>API Changes</h2> <div class="sectionbody"> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Type of Change</th> <th class="tableblock halign-left valign-top">API</th> <th class="tableblock halign-left valign-top">Alternative</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>InOptionalOut</code> from <code>org.apache.camel.ExchangePattern</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>InOut</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>@FallbackConverter</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Converter(fallback = true)</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>getEndpointMap()</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri</code> attribute on <code>@EndpointInject</code>, <code>@Produce</code>, and <code>@Consume</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use <code>value</code> (default) instead. For example <code>@Produce(uri = "kafka:cheese")</code> should be changed to <code>@Produce("kafka:cheese")</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>label</code> on <code>@UriEndpoint</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">use <code>category</code> instead.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>consumerClass</code> on <code>@UriEndpoint</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">all <code>asyncCallback</code> methods on <code>ProducerTemplate</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>asyncSend</code> or <code>asyncRequest</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.camel.spi.OnCamelContextStart</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.camel.spi.OnCamelContextStarting</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.camel.spi.OnCamelContextStop</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.camel.spi.OnCamelContextStopping</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Discard</code> and <code>DiscardOldest</code> from <code>org.apache.camel.util.concurrent.ThreadPoolRejectedPolicy</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.camel.builder.SimpleBuilder</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">This API was mostly used internally in Camel with the Java DSL in some situations.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>archetypeCatalogAsXml</code> method from <code>org.apache.camel.catalog.CamelCatalog</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>configure</code> from the interface <code>org.apache.camel.main.Listener</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Removed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>getExtension</code> from the interface <code>CamelContext</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Use <code>getCamelContextExtension</code> instead. For example <code>ManagedCamelContext managed = context.getCamelContextExtension().getContextPlugin(ManagedCamelContext.class);</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Moved</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Moved <code>org.apache.camel.support.IntrospectionSupport</code> to <code>camel-core-engine</code> for internal use only</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">End users should use <code>org.apache.camel.spi.BeanIntrospection</code> instead.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Moved</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exchange failure handling status has moved from being a property defined as <code>ExchangePropertyKey.FAILURE_HANDLED</code> to a member of the ExtendedExchange, accessible via `isFailureHandled()`method.</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Replaced</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Replaced <code>adapt()</code> from <code>org.apache.camel.CamelContext</code> with <code>getCamelContextExtension</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Replaced</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Replaced <code>adapt()</code> from <code>org.apache.camel.ExtendedExchange</code> with <code>getExchangeExtension</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Added</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Added <code>position</code> method to <code>org.apache.camel.StreamCache</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Decoupled</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Decoupled the <code>org.apache.camel.ExtendedCamelContext</code> from the <code>org.apache.camel.CamelContext</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Decoupled</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Decoupled the <code>org.apache.camel.ExtendedExchange</code> from the <code>org.apache.camel.Exchange</code>.</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The type for <code>dumpRoutes</code> on <code>CamelContext</code> has changed from <code>boolean</code> to <code>String</code> to allow specifying either xml or yaml.</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The <code>org.apache.camel.health.HealthCheck</code> method <code>isLiveness</code> is now default <code>false</code> instead of <code>true</code>.</p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Added</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Added <code>position</code> method to <code>org.apache.camel.StreamCache</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Added</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The <code>org.apache.camel.support.EventNotifierSupport</code> abstract class now implements <code>CamelContextAware</code>.</p></td> <td class="tableblock halign-left valign-top"></td> </tr> </tbody> </table></div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> The <code>org.apache.camel.support.PluginHelper</code> gives easy access to various extensions and context plugins, that was available previously in Camel v3 directly from <code>CamelContext</code>. </td> </tr> </table></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You can get access to the advanced APIs in <code>CamelContext</code> known as <code>ExtendedCamelContext</code> via <code>context.getCamelContextExtension()</code>. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To get hold of <code>ManagedCamelContext</code> then you should use the following way:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ManagedCamelContext managed = camelContext.getCamelContextExtension().getContextPlugin(ManagedCamelContext.class);</code></pre> </div> </div> <div class="paragraph"> <p>This can be done by many other advanced Camel features such as <code>RoutesLoader</code> or <code>ModelToXMLDumper</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">RoutesLoader loader = camelContext.getCamelContextExtension().getContextPlugin(RoutesLoader.class);</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_eip_changes"><a class="anchor" href="#_eip_changes"></a>EIP Changes</h2> <div class="sectionbody"> <div class="paragraph"> <p>Removed <code>lang</code> attribute for the <code>&lt;description&gt;</code> on every EIPs.</p> </div> <div class="paragraph"> <p>The <code>InOnly</code> and <code>InOut</code> EIPs has been removed. Instead, use <code>SetExchangePattern</code> or <code>To</code> where you can specify exchange pattern to use.</p> </div> <div class="sect2"> <h3 id="_poll_enrich_eip"><a class="anchor" href="#_poll_enrich_eip"></a>Poll Enrich EIP</h3> <div class="paragraph"> <p>The polled endpoint URI is now stored as property on the <code>Exchange</code> (with key <code>CamelToEndpoint</code>) like all other EIPs. Before the URI was stored as a message header.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_circuitbreaker_eip"><a class="anchor" href="#_circuitbreaker_eip"></a>CircuitBreaker EIP</h2> <div class="sectionbody"> <div class="paragraph"> <p>The following options in <code>camel-resilience4j</code> was mistakenly not defined as attributes:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Option</strong></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">bulkheadEnabled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">bulkheadMaxConcurrentCalls</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">bulkheadMaxWaitDuration</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">timeoutEnabled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">timeoutExecutorService</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">timeoutDuration</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">timeoutCancelRunningFuture</p></td> </tr> </tbody> </table></div> <div class="paragraph"> <p>These options were not exposed in YAML DSL, and in XML DSL you need to migrate from:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;circuitBreaker&gt;
    &lt;resilience4jConfiguration&gt;
        &lt;timeoutEnabled&gt;true&lt;/timeoutEnabled&gt;
        &lt;timeoutDuration&gt;2000&lt;/timeoutDuration&gt;
    &lt;/resilience4jConfiguration&gt;
...
&lt;/circuitBreaker&gt;</code></pre> </div> </div> <div class="paragraph"> <p>To use attributes instead:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;circuitBreaker&gt;
    &lt;resilience4jConfiguration timeoutEnabled="true" timeoutDuration="2000"/&gt;
...
&lt;/circuitBreaker&gt;</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_xml_dsl"><a class="anchor" href="#_xml_dsl"></a>XML DSL</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <code>&lt;description&gt;</code> to set a description on a route or node, has been changed from an element to an attribute.</p> </div> <div class="paragraph"> <p>Before:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route id="myRoute"&gt;
  &lt;description&gt;Something that this route do&lt;/description&gt;
  &lt;from uri="kafka:cheese"/&gt;
  ...
&lt;/route&gt;</code></pre> </div> </div> <div class="paragraph"> <p>After:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route id="myRoute" description="Something that this route do"&gt;
  &lt;from uri="kafka:cheese"/&gt;
  ...
&lt;/route&gt;</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_type_converter"><a class="anchor" href="#_type_converter"></a>Type Converter</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <code>String</code> &#8594; <code>java.io.File</code> converter has been removed.</p> </div> </div> </div> <div class="sect1"> <h2 id="_tracing"><a class="anchor" href="#_tracing"></a>Tracing</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <a href="tracer.html" class="xref page">Tracer</a> and <a href="backlog-tracer.html" class="xref page">Backlog Tracer</a> no longer includes internal tracing events from routes that was created by Rest DSL or route templates or Kamelets. You can turn this on, by setting <code>traceTemplates=true</code> in the tracer.</p> </div> <div class="paragraph"> <p>The <a href="backlog-tracer.html" class="xref page">Backlog Tracer</a> has been enhanced and <em>fixed</em> to trace message headers (also streaming types). This means that previously headers of type <code>InputStream</code> was not traced before, but is now included. This could mean that the header stream is positioned at the end, and logging the header afterward may appear as the header value is empty.</p> </div> </div> </div> <div class="sect1"> <h2 id="_useoriginalmessage_useoriginalbody"><a class="anchor" href="#_useoriginalmessage_useoriginalbody"></a>UseOriginalMessage / UseOriginalBody</h2> <div class="sectionbody"> <div class="paragraph"> <p>When <code>useOriginalMessage</code> or <code>useOriginalBody</code> is enabled in <code>OnException</code>, <code>OnCompletion</code> or error handlers, then the original message body is defensively copied and if possible converted to <code>StreamCache</code> to ensure the body can be re-read when accessed. Previously the original body was not converted to <code>StreamCache</code> which could lead to the body not able to be read or the stream has been closed.</p> </div> </div> </div> <div class="sect1"> <h2 id="_camel_health"><a class="anchor" href="#_camel_health"></a>Camel Health</h2> <div class="sectionbody"> <div class="paragraph"> <p>Health checks are now by default only readiness checks out of the box.</p> </div> <div class="paragraph"> <p>Camel provides the <code>CamelContextCheck</code> as both readiness and liveness checks, so there is at least one of each out of the box.</p> </div> <div class="paragraph"> <p>Only consumer-based health checks are enabled by default.</p> </div> <div class="sect2"> <h3 id="_producer_health_checks"><a class="anchor" href="#_producer_health_checks"></a>Producer Health Checks</h3> <div class="paragraph"> <p>The option <code>camel.health.components-enabled</code> has been renamed to <code>camel.health.producers-enabled</code>.</p> </div> <div class="paragraph"> <p>Some components, in particular AWS, also provide health checks for producers. In Camel 3.x these health checks did not work properly and has been disabled in the source. To continue this behaviour in Camel 4, then producer-based health checks are disabled.</p> </div> <div class="paragraph"> <p>Notice that <code>camel-kafka</code> comes with producer based health-check that worked in Camel 3, and therefore this change in Camel 4, means that this health-check is disabled.</p> </div> <div class="paragraph"> <p>You <strong>MUST</strong> enable producer health-checks globally, such as in <code>application.properties</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">camel.health.producers-enabled = true</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_jmx"><a class="anchor" href="#_jmx"></a>JMX</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel now also include MBeans for <code>doCatch</code> and <code>doFinally</code> in the tree of processor MBeans.</p> </div> <div class="paragraph"> <p>The <code>ManagedChoiceMBean</code> have renamed <code>choiceStatistics</code> to <code>extendedInformation</code>. The <code>ManagedFailoverLoadBalancerMBean</code> have renamed <code>exceptionStatistics</code> to <code>extendedInformation</code>.</p> </div> <div class="paragraph"> <p>The <code>CamelContextMBean</code> and <code>CamelRouteMBean</code> has removed method <code>dumpRouteAsXml(boolean resolvePlaceholders, boolean resolveDelegateEndpoints)</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_yaml_dsl"><a class="anchor" href="#_yaml_dsl"></a>YAML DSL</h2> <div class="sectionbody"> <div class="paragraph"> <p>The backwards compatible mode Camel 3.14 or older, which allowed to have <em>steps</em> as child to <em>route</em> has been removed.</p> </div> <div class="paragraph"> <p>The old syntax:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    from:
      uri: "direct:info"
    steps:
    - log: "message"</code></pre> </div> </div> <div class="paragraph"> <p>should be changed to:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    from:
      uri: "direct:info"
      steps:
      - log: "message"</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_backlog_tracing"><a class="anchor" href="#_backlog_tracing"></a>Backlog Tracing</h2> <div class="sectionbody"> <div class="paragraph"> <p>The option <code>backlogTracing=true</code> now automatic enabled the tracer on startup. The previous behavior was <em>surprisingly</em> that the tracer was only made available, and had to be manually enabled afterward. The old behavior can be archived by setting <code>backlogTracingStandby=true</code>.</p> </div> <div class="paragraph"> <p>Move the following class from <code>org.apache.camel.api.management.mbean.BacklogTracerEventMessage</code> in <code>camel-management-api</code> JAR to <code>org.apache.camel.spi.BacklogTracerEventMessage</code> in <code>camel-api</code> JAR.</p> </div> <div class="paragraph"> <p>The <code>org.apache.camel.impl.debugger.DefaultBacklogTracerEventMessage</code> has been refactored into an interface <code>org.apache.camel.spi.BacklogTracerEventMessage</code> with some additional details about traced messages. For example Camel now captures a <em>first</em> and <em>last</em> trace that contains the input and outgoing (if <code>InOut</code>) messages.</p> </div> </div> </div> <div class="sect1"> <h2 id="_xml_serialization"><a class="anchor" href="#_xml_serialization"></a>XML serialization</h2> <div class="sectionbody"> <div class="paragraph"> <p>The default XML serialization using <code>ModelToXMLDumper</code> has been improved and now uses a generated XML serializer located in the <code>camel-xml-io</code> module instead of the JAXB based one from <code>camel-jaxb</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_openapi_maven_plugin"><a class="anchor" href="#_openapi_maven_plugin"></a>OpenAPI Maven Plugin</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <code>camel-restdsl-openapi-plugin</code> Maven plugin now uses <code>platform-http</code> as the default rest component in the generated Rest DSL code. Previously, the default was servlet. However, platform-http is a better default that works out of the box with Spring Boot and Quarkus.</p> </div> </div> </div> <div class="sect1"> <h2 id="_component_changes"><a class="anchor" href="#_component_changes"></a>Component changes</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_category"><a class="anchor" href="#_category"></a>Category</h3> <div class="paragraph"> <p>The number of enums for <code>org.apache.camel.Category</code> has been reduced from 83 to 37, which means custom components that are using removed values need to choose one of the remainder values. We have done this to consolidate the number of categories of components in the Camel community.</p> </div> </div> <div class="sect2"> <h3 id="_camel_openapi_rest_dsl_generator"><a class="anchor" href="#_camel_openapi_rest_dsl_generator"></a>camel-openapi-rest-dsl-generator</h3> <div class="paragraph"> <p>This dsl-generator has updated the underlying model classes (<code>apicurio-data-models</code>) from 1.1.27 to 2.0.3.</p> </div> </div> <div class="sect2"> <h3 id="_camel_atom"><a class="anchor" href="#_camel_atom"></a>camel-atom</h3> <div class="paragraph"> <p>The <code>camel-atom</code> component has changed the third party atom client from Apache Abdera to RSSReader. This means the feed object is changed from <code>org.apache.abdera.model.Feed</code> to <code>com.apptasticsoftware.rssreader.Item</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_cosmosdb"><a class="anchor" href="#_camel_azure_cosmosdb"></a>camel-azure-cosmosdb</h3> <div class="paragraph"> <p>The <code>itemPartitionKey</code> has been updated. It&#8217;s now a String a not a PartitionKey anymore. More details in CAMEL-19222.</p> </div> </div> <div class="sect2"> <h3 id="_camel_bean"><a class="anchor" href="#_camel_bean"></a>camel-bean</h3> <div class="paragraph"> <p>When using the <code>method</code> option to refer to a specific method, and using parameter types and values, such as: <code>"bean:myBean?method=foo(com.foo.MyOrder, true)"</code> then any class types must now be using <code>.class</code> syntax, i.e. <code>com.foo.MyOrder</code> should now be <code>com.foo.MyOrder.class</code>.</p> </div> <div class="paragraph"> <p>The example from above should now be as follows:</p> </div> <div class="literalblock"> <div class="content"> <pre>"bean:myBean?method=foo(com.foo.MyOrder.class, true)"</pre> </div> </div> <div class="paragraph"> <p>This also applies to Java types such as String, int, etc.:</p> </div> <div class="literalblock"> <div class="content"> <pre>"bean:myBean?method=bar(String.class, int.class)"</pre> </div> </div> </div> <div class="sect2"> <h3 id="_camel_box"><a class="anchor" href="#_camel_box"></a>camel-box</h3> <div class="paragraph"> <p>Upgraded from Box Java SDK v2 to v4, which have some method signature changes. The method to get a file thumbnail is no longer available.</p> </div> </div> <div class="sect2"> <h3 id="_camel_caffeine"><a class="anchor" href="#_camel_caffeine"></a>camel-caffeine</h3> <div class="paragraph"> <p>The <code>keyType</code> parameter has been removed. The Key for the cache will now be only <code>String</code> type. More information in CAMEL-18877.</p> </div> </div> <div class="sect2"> <h3 id="_camel_fhir"><a class="anchor" href="#_camel_fhir"></a>camel-fhir</h3> <div class="paragraph"> <p>The underlying <code>hapi-fhir</code> library has been upgraded from 4.2.0 to 6.2.4. Only the <code>Delete</code> API method has changed and now returns <code>ca.uhn.fhir.rest.api.MethodOutcome</code> instead of <code>org.hl7.fhir.instance.model.api.IBaseOperationOutcome</code>. See <a href="https://hapifhir.io/hapi-fhir/blog/" class="bare">https://hapifhir.io/hapi-fhir/blog/</a> for a more detailed list of underlying changes (only the hapi-fhir client is used in Camel).</p> </div> </div> <div class="sect2"> <h3 id="_camel_google"><a class="anchor" href="#_camel_google"></a>camel-google</h3> <div class="paragraph"> <p>The API-based components <code>camel-google-drive</code>, <code>camel-google-calendar</code>, <code>camel-google-sheets</code> and <code>camel-google-mail</code> has been upgraded from Google Java SDK v1 to v2 and to latest API revisions. The <code>camel-google-drive</code> and <code>camel-google-sheets</code> have some API methods changes, but the others are identical as before.</p> </div> </div> <div class="sect2"> <h3 id="_camel_http"><a class="anchor" href="#_camel_http"></a>camel-http</h3> <div class="paragraph"> <p>The component has been upgraded to use Apache HttpComponents v5 which has an impact on how the underlying client is configured. There are 4 different timeouts (<code>connectionRequestTimeout</code>, <code>connectTimeout</code>, <code>soTimeout</code> and <code>responseTimeout</code>) instead of initially 3 (<code>connectionRequestTimeout</code>, <code>connectTimeout</code> and <code>socketTimeout</code>) and the default value of some of them has changed so please refer to the documentation for more details.</p> </div> <div class="paragraph"> <p>Please note that the <code>socketTimeout</code> has been removed from the possible configuration parameters of <code>HttpClient</code>, use <code>responseTimeout</code> instead.</p> </div> <div class="paragraph"> <p>Finally, the option <code>soTimeout</code> along with any parameters included into <code>SocketConfig</code>, need to be prefixed by <code>httpConnection.</code>, the rest of the parameters including those defined into <code>HttpClientBuilder</code> and <code>RequestConfig</code> still need to be prefixed by <code>httpClient.</code> like before.</p> </div> </div> <div class="sect2"> <h3 id="_camel_http_common"><a class="anchor" href="#_camel_http_common"></a>camel-http-common</h3> <div class="paragraph"> <p>The API in <code>org.apache.camel.http.common.HttpBinding</code> has changed slightly to be more reusable. The <code>parseBody</code> method now takes in <code>HttpServletRequest</code> as input parameter. And all <code>HttpMessage</code> has been changed to generic <code>Message</code> types.</p> </div> </div> <div class="sect2"> <h3 id="_camel_kubernetes"><a class="anchor" href="#_camel_kubernetes"></a>camel-kubernetes</h3> <div class="paragraph"> <p>The <code>io.fabric8:kubernetes-client</code> library has been upgraded and some deprecated API usage has been removed. Operations previously prefixed with <code>replace</code> are now prefixed with <code>update</code>.</p> </div> <div class="paragraph"> <p>For example <code>replaceConfigMap</code> is now <code>updateConfigMap</code>, <code>replacePod</code> is now <code>updatePod</code> etc. The corresponding constants in class <code>KubernetesOperations</code> are also renamed. <code>REPLACE_CONFIGMAP_OPERATION</code> is now <code>UPDATE_CONFIGMAP_OPERATION</code>, <code>REPLACE_POD_OPERATION</code> is now <code>UPDATE_POD_OPERATION</code> etc.</p> </div> </div> <div class="sect2"> <h3 id="_camel_web3j"><a class="anchor" href="#_camel_web3j"></a>camel-web3j</h3> <div class="paragraph"> <p>The <code>camel-web3j</code> has upgraded the <code>web3j</code> JAR from 3.x to 5.0 which has many API changes, and so some previous API calls are no long provided.</p> </div> </div> <div class="sect2"> <h3 id="_camel_main"><a class="anchor" href="#_camel_main"></a>camel-main</h3> <div class="paragraph"> <p>The following constants has been moved from <code>BaseMainSupport</code> / <code>Main</code> to <code>MainConstants</code>:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Old Name</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">New Name</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Main.DEFAULT_PROPERTY_PLACEHOLDER_LOCATION</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">MainConstants.DEFAULT_PROPERTY_PLACEHOLDER_LOCATION</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Main.INITIAL_PROPERTIES_LOCATION</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">MainConstants.INITIAL_PROPERTIES_LOCATION</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Main.OVERRIDE_PROPERTIES_LOCATION</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">MainConstants.OVERRIDE_PROPERTIES_LOCATION</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Main.PROPERTY_PLACEHOLDER_LOCATION</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">MainConstants.PROPERTY_PLACEHOLDER_LOCATION</p></td> </tr> </tbody> </table></div> </div> <div class="sect2"> <h3 id="_camel_micrometer"><a class="anchor" href="#_camel_micrometer"></a>camel-micrometer</h3> <div class="paragraph"> <p>The metrics has been renamed to follow Micrometer naming convention <a href="https://micrometer.io/docs/concepts#_naming_meters">Naming Meters</a>.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> </colgroup> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Old Name</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">New Name</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangeEventNotifier</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchange.event.notifier</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangesFailed</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchanges.failed</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangesFailuresHandled</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchanges.failures.handled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangesInflight</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchanges.external.redeliveries</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangesSucceeded</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchanges.succeeded</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelExchangesTotal</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.exchanges.total</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelMessageHistory</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.message.history</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelRoutePolicy</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.route.policy</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelRoutePolicyLongTask</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.route.policy.long.task</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelRoutesAdded</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.routes.added</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">CamelRoutesRunning</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">camel.routes.running</p></td> </tr> </tbody> </table></div> </div> <div class="sect2"> <h3 id="_camel_jbang"><a class="anchor" href="#_camel_jbang"></a>camel-jbang</h3> <div class="paragraph"> <p>The command <code>camel dependencies</code> has been renamed to <code>camel dependency</code>.</p> </div> <div class="paragraph"> <p>In Camel JBang the <code>-dir</code> parameter for <code>init</code> and <code>run</code> goal has been renamed to require 2 dashes <code>--dir</code> like all the other options.</p> </div> <div class="paragraph"> <p>The <code>camel stop</code> command will now by default stop all running integrations (the option <code>--all</code> has been removed).</p> </div> <div class="paragraph"> <p>The <em>Placeholders substitutes</em> is changed to use <code>#name</code> instead of <code>$name</code> syntax.</p> </div> </div> <div class="sect2"> <h3 id="_camel_jpa"><a class="anchor" href="#_camel_jpa"></a>camel-jpa</h3> <div class="paragraph"> <p>The option <code>transactionManager</code> has been removed, and a new option named <code>transactionStrategy</code> has been added, that acts as vendor neutral abstraction to make it easier to configure Spring Transaction or Quarkus Transaction.</p> </div> </div> <div class="sect2"> <h3 id="_camel_openapi_java"><a class="anchor" href="#_camel_openapi_java"></a>camel-openapi-java</h3> <div class="paragraph"> <p>The <code>camel-openapi-java</code> component has been changed to use <code>io.swagger.v3</code> libraries instead of <code>io.apicurio.datamodels</code>. As a result, the return type of the public method org.apache.camel.openapi.RestOpenApiReader.read() is now <code>io.swagger.v3.oas.models.OpenAPI</code> instead of <code>io.apicurio.datamodels.openapi.models.OasDocument</code>. When an OpenAPI 2.0 (swagger) specification is parsed, it is automatically upgraded to OpenAPI 3.0.x by the swagger parser. This version also supports OpenAPI 3.1.x specifications. The related spring-boot starter components have been modified to use the new return type.</p> </div> </div> <div class="sect2"> <h3 id="_camel_optaplanner"><a class="anchor" href="#_camel_optaplanner"></a>camel-optaplanner</h3> <div class="paragraph"> <p>The <code>camel-optaplanner</code> component has been change to use <code>SolverManager</code>. If you were using <code>SoverManager</code> in Camel 3, you don&#8217;t need anymore the boolean useSolverManager in the Route. Deprecated <code>ProblemFactChange</code> has been replaced by <code>ProblemChange</code>.</p> </div> <div class="paragraph"> <p>The new URI path is:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("optaplanner:myProblemName")
  .to("...")</code></pre> </div> </div> <div class="paragraph"> <p>You can pass the OptaPlanner SolverManager in 2 ways:</p> </div> <div class="ulist"> <ul> <li> <p>as #parameter</p> </li> <li> <p>as header</p> </li> </ul> </div> <div class="paragraph"> <p>When running <code>camel-optaplanner</code> on Spring Boot or Quarkus, it is preferable to use the Spring Boot or Quarkus way of creating the SolverManager.</p> </div> <div class="paragraph"> <p>It is possible to migrate legacy Camel OptaPlanner Routes, by putting the XML config file, as show in the code below. Camel OptaPlanner will handle creating the SolverManager for those legacy Routes:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("optaplanner:myProblemName?configFile=PATH/TO/CONFIG.FILE.xml")
  .to("...")</code></pre> </div> </div> <div class="paragraph"> <p>Solver Daemon solutions should be migrated to use SolverManager.</p> </div> </div> <div class="sect2"> <h3 id="_camel_platform_http_vertx"><a class="anchor" href="#_camel_platform_http_vertx"></a>camel-platform-http-vertx</h3> <div class="paragraph"> <p>If the route or consumer is suspended, then http status 503 is now returned instead of 404.</p> </div> </div> <div class="sect2"> <h3 id="_camel_salesforce"><a class="anchor" href="#_camel_salesforce"></a>camel-salesforce</h3> <div class="paragraph"> <p>Property names of blob fields on generated DTOs no longer have 'Url' affixed. E.g., the <code>ContentVersionUrl</code> property is now just <code>ContentVersion</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_slack"><a class="anchor" href="#_camel_slack"></a>camel-slack</h3> <div class="paragraph"> <p>The default delay (on Slack consumer) is changed from 0.5s to 10s to avoid being rate limited to often by Slack.</p> </div> </div> <div class="sect2"> <h3 id="_camel_spring_rabbitmq"><a class="anchor" href="#_camel_spring_rabbitmq"></a>camel-spring-rabbitmq</h3> <div class="paragraph"> <p>The option <code>replyTimeout</code> in <code>camel-spring-rabbitmq</code> has been fixed and the default value from 5 to 30 seconds (this is the default used by Spring).</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_camel_spring_boot"><a class="anchor" href="#_camel_spring_boot"></a>Camel Spring Boot</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <code>camel-spring-boot</code> dependency no longer includes <code>camel-spring-xml</code>. To use legacy Spring XML files <code>&lt;beans&gt;</code> with Camel on Spring Boot, then include the <code>camel-spring-boot-xml-starter</code> dependency.</p> </div> <div class="sect2"> <h3 id="_graceful_shutdown"><a class="anchor" href="#_graceful_shutdown"></a>Graceful Shutdown</h3> <div class="paragraph"> <p>Apache Camel shutdowns a bit later during Spring Boot shutdown. This allows Spring Boot graceful shutdown to complete first (stopping Spring Boot HTTP server gracefully), and then afterward Camel is doing its own <a href="graceful-shutdown.html" class="xref page">Graceful Shutdown</a>.</p> </div> <div class="paragraph"> <p>Technically <code>camel-spring</code> has changed <code>getPhase()</code> from returning <code>Integer.MAX_VALUE</code> to <code>Integer.MAX_VALUE - 2049</code>. This gives room for Spring Boot services to shut down first.</p> </div> </div> <div class="sect2"> <h3 id="_camel_micrometer_starter"><a class="anchor" href="#_camel_micrometer_starter"></a>camel-micrometer-starter</h3> <div class="paragraph"> <p>The <code>uri</code> tags are now static instead of dynamic (by default), as potential too many tags generated due to URI with dynamic values. This can be enabled again by setting <code>camel.metrics.uriTagDynamic=true</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_platform_http_starter"><a class="anchor" href="#_camel_platform_http_starter"></a>camel-platform-http-starter</h3> <div class="paragraph"> <p>The <code>platform-http-starter</code> has been changed from using <code>camel-servlet</code> to use Spring HTTP server directly. Therefore, all the HTTP endpoints are no longer prefixed with the servlet context-path (default is <code>camel</code>).</p> </div> <div class="paragraph"> <p>For example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("platform-http:myservice")
  .to("...")</code></pre> </div> </div> <div class="paragraph"> <p>Then calling <em>myservice</em> would before require to include the context-path, such as <code><a href="http://localhost:8080/camel/myservice" class="bare">http://localhost:8080/camel/myservice</a></code>. Now the context-path is not in use, and the endpoint can be called with <code><a href="http://localhost:8080/myservice" class="bare">http://localhost:8080/myservice</a></code>.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The <code>platform-http-starter</code> can also be used with Rest DSL. </td> </tr> </table></div> </div> <div class="paragraph"> <p>If the route or consumer is suspended, then http status 503 is now returned instead of 404.</p> </div> </div> <div class="sect2"> <h3 id="_camel_twitter"><a class="anchor" href="#_camel_twitter"></a>camel-twitter</h3> <div class="paragraph"> <p>The component was updated to use Twitter4j version 4.1.2, which <a href="https://twitter4j.org/2022/10/21/264">has moved the packages</a> used by a few of its classes. If accessing certain twitter-related data, such as the Tweet status, you need to update the packages used from <code>twitter4j.Status</code> to <code>twitter4j.v1.Status</code>.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_camel_4_0_1_to_4_0_2"><a class="anchor" href="#_upgrading_camel_4_0_1_to_4_0_2"></a>Upgrading Camel 4.0.1 to 4.0.2</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_camel_file"><a class="anchor" href="#_camel_file"></a>camel-file</h3> <div class="paragraph"> <p>The <code>readLock=changed</code> with using <code>readLockMinAge</code> has been restored to same behaviour as 3.x.</p> </div> <div class="paragraph"> <p>For example, using <code>readLockMinAge=5s</code> would pick up files that are older than 5 seconds from startup time. If you have many existing files on startup that are old, then Camel will now again be fast, and pick up these files immediately.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_camel_4_0_0_to_4_0_1"><a class="anchor" href="#_upgrading_camel_4_0_0_to_4_0_1"></a>Upgrading Camel 4.0.0 to 4.0.1</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_camel_aws2_sns"><a class="anchor" href="#_camel_aws2_sns"></a>camel-aws2-sns</h3> <div class="paragraph"> <p>The <code>queueUrl</code> parameter has been replaced by the <code>queueArn</code> parameter</p> </div> <div class="paragraph"> <p>For Example before</p> </div> <div class="listingblock"> <div class="content"> <pre>from("direct:start")
  .to("aws2-sns://mytopic?subject=mySubject&amp;autoCreateTopic=true&amp;subscribeSNStoSQS=true&amp;queueUrl=https://xxxx")</pre> </div> </div> <div class="paragraph"> <p>Should be changed to</p> </div> <div class="listingblock"> <div class="content"> <pre>from("direct:start")
  .to("aws2-sns://mytopic?subject=mySubject&amp;autoCreateTopic=true&amp;subscribeSNStoSQS=true&amp;queueArn=arn:aws:sqs:xxxxx")</pre> </div> </div> </div> </div> </div> </article> <aside class="toc sidebar" aria-label="Table of contents" data-title="Contents" data-levels="2"> <div class="toc-menu"></div> </aside> </div> </main> </div> <div class="footer-tools"> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../_/img/logo-d-a567cee6fa.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../blog/">Blog</a></dd> <dd><a href="../docs/">Documentation</a></dd> <dd><a href="../community/support/">Community</a></dd> <dd><a href="../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../manual/">User Manual</a></dd> <dd><a href="../components/next/index.html">Components</a></dd> <dd><a href="../camel-k/next/">Camel-K</a></dd> <dd><a href="../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../community/support/">Support</a></dd> <dd><a href="../community/contributing/">Contributing</a></dd> <dd><a href="../community/mailing-list/">Mailing Lists</a></dd> <dd><a href="../community/user-stories/">User stories</a></dd> <dd><a href="../community/articles/">Articles</a></dd> <dd><a href="../community/books/">Books</a></dd> <dd><a href="../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../_/js/site-c215fb6972.js"></script> <script async src="../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script async src="../_/js/vendor/tabs-5aea11bcf5.js" data-sync-storage-key="preferred-tab"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https://camel.apache.org", "sameAs": [ "https://twitter.com/ApacheCamel" ], "logo": "../_/img/logo-d-a567cee6fa.svg", "description": "Apache Camel  is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Apache Camel", "item": "https://camel.apache.org/" }, { "@type": "ListItem", "position": 2, "name": "User manual", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 3, "name": "default", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 4, "name": "Migration and Upgrade", "item": "https://camel.apache.org/manual/migration-and-upgrade.html" }, { "@type": "ListItem", "position": 5, "name": "Camel 3.x to 4.0 Migration Guide", "item": "https://camel.apache.org/manual/camel-4-migration-guide.html" }] } </script> </body> </html> 