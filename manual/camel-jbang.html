<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Camel JBang :: Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/manual/camel-jbang.html"> <meta name="generator" content="Antora 3.1.7"> <link rel="stylesheet" href="../_/css/site-b287b96c63.css"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Camel JBang"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org"> <meta property="og:description" content="Camel is an open source integration framework that empowers you to quickly and easily integrate various systems consuming or producing data."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/_/img/logo-d-a567cee6fa.svg"> <link rel="manifest" href="../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href=".."></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../blog/"> <img alt="Blog" src="/_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../docs/"> <img alt="Documentation" src="/_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../community/"> <img alt="Community" src="/_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../download/"> <img alt="Download" src="/_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../security/"> <img alt="Security" src="/_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="../_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <div class="nav-container" data-component="manual" data-version=""> <aside class="nav" aria-label="Side menu"> <div class="panels"> <div class="nav-panel-menu is-active"> <nav class="nav-menu" data-panel="menu" aria-label="Topics"> <h3 class="title"><a href="index.html">User manual</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="getting-started.html">Getting started</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Resources &amp; Guides</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/books/">Books</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="building.html">Building</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-console.html">Camel Developer Console</a> </li> <li class="nav-item is-current-page" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="camel-jbang.html">Camel JBang</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-kubernetes.html">Camel Kubernetes plugin</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-k.html">Camel K plugin</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-plugin.html">Camel Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-component-maven-plugin.html">Camel Component Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-report-maven-plugin.html">Camel Maven Report Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-archetypes.html">Camel Maven Archetypes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="configuring-route-startup-ordering-and-autostartup.html">Configuring route startup ordering and autostartup</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component-dsl.html">Component DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="Endpoint-dsl.html">Endpoint DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dataformat-dsl.html">DataFormat DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="examples.html">Examples</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="graceful-shutdown.html">Graceful Shutdown</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-propertyplaceholder.html">How to use Camel property placeholders</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="variables.html">How to use Variables</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="testing.html">Testing</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="test-infra.html">Test Infra</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="notify-builder.html">NotifyBuilder</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="advice-with.html">AdviceWith</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="rest-dsl.html">Working with REST and Rest DSL</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="rest-dsl-openapi.html">Rest DSL contract first</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="writing-components.html">Writing Components</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="release-guide.html">Release guide</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="release-guide-website.html">Adding doc versions to the website</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="improving-the-documentation.html">Improving the Documentation</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="migration-and-upgrade.html">Migration and Upgrade</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-4x-upgrade-guide.html">Camel 4.x Upgrade Guide</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="architecture.html">Architecture</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-debugger.html">Backlog debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-tracer.html">Backlog Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-consumer.html">Batch Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-binding.html">Bean Binding</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-integration.html">Bean Integration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext.html">CamelContext</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext-autoconfigure.html">CamelContext Auto Configuration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="clustering.html">Clustering and Load Balancing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component.html">Component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="data-format.html">Data Format</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="debugger.html">Debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-interceptor.html">Delayer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint.html">Endpoints</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint-annotations.html">Endpoint Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exception-clause.html">Exception Clause</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pooling.html">Exchange Pooling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="http-session-handling.html">HTTP-Session Handling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-producing.html">POJO Producing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="producertemplate.html">ProducerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="consumertemplate.html">ConsumerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error Handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange.html">Message Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="expression.html">Expressions</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/content-enricher.html">Content Enrichment</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="injector.html">Injector</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/intercept.html">Intercept</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="jmx.html">JMX</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="oncompletion.html">OnCompletion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pluggable-class-resolvers.html">Pluggable Class Resolvers</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="predicate.html">Predicates</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="processor.html">Processor</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="registry.html">Registry</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-builder.html">RouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lambda-route-builder.html">LambdaRouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-controller.html">RouteController</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-policy.html">RoutePolicy</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-configuration.html">RouteConfiguration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="context-reload.html">ContextReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-reload.html">RouteReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-template.html">RouteTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routes.html">Routes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="startup-condition.html">Startup Condition</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stream-caching.html">Stream caching</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transformer.html">Transformer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="threading-model.html">Threading Model</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="tracer.html">Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="type-converter.html">Type Converter</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uris.html">URIs</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uuidgenerator.html">UuidGenerator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validator.html">Validator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="health-check.html">Health Checks</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Domain Specific Languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">Languages</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="java-dsl.html">Java DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring.html">Spring support</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="faq/index.html">FAQ</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/support/">How can I get help?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">What languages are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <span class="nav-text"><strong>Reference</strong></span> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/index.html">Components</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/dataformats/index.html">Data Formats</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/languages/index.html">Languages</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/eips/enterprise-integration-patterns.html">EIPs</a> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title noversion">User manual</span> </div> <ul class="components"> <li class="component is-current"> <span class="title"> <a href="index.html">User manual</a> </span></li> <li class="component"><span class="title">Camel Components</span> <ul class="versions"> <li class="version"> <a href="../components/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../components/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../components/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../components/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"> <span class="title"> <a href="../camel-core/index.html">Camel Core</a> </span></li> <li class="component"><span class="title">Camel K</span> <ul class="versions"> <li class="version"> <a href="../camel-k/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-k/2.4.x/index.html">2.4.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Kafka Connector</span> <ul class="versions"> <li class="version"> <a href="../camel-kafka-connector/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kafka-connector/4.8.x/index.html">4.8.x</a> </li> </ul></li> <li class="component"><span class="title">Kamelet Catalog</span> <ul class="versions"> <li class="version"> <a href="../camel-kamelets/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kamelets/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-kamelets/4.4.x/index.html">4.4.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Karaf</span> <ul class="versions"> <li class="version"> <a href="../camel-karaf/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Quarkus</span> <ul class="versions"> <li class="version"> <a href="../camel-quarkus/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-quarkus/3.15.x/index.html">3.15.x</a> </li> <li class="version"> <a href="../camel-quarkus/3.8.x/index.html">3.8.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Spring Boot</span> <ul class="versions"> <li class="version"> <a href="../camel-spring-boot/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> </ul> </div> </div> </aside> </div> <main class="article"> <nav class="toolbar" aria-label="Toolbar"> <button class="nav-toggle" type="button" aria-label="Toggle submenu"></button> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">User manual</a></li> <li>Resources &amp; Guides</li> <li><a href="camel-jbang.html">Camel JBang</a></li> </ul> </nav> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/main/docs/user-manual/modules/ROOT/pages/camel-jbang.adoc">Edit this Page</a></div> </nav> <div class="content"> <article class="doc"> <h1 class="page">Camel JBang</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>A JBang-based Camel app for easily running Camel routes.</p> </div> </div> </div> <div class="sect1"> <h2 id="_installation"><a class="anchor" href="#_installation"></a>Installation</h2> <div class="sectionbody"> <div class="paragraph"> <p>First, you must install <a href="https://www.jbang.dev/">JBang</a>, which is used for launching Camel. See instructions on <a href="https://www.jbang.dev/download/">JBang</a> how to download and install.</p> </div> <div class="paragraph"> <p>After JBang is installed, you can verify JBang is working by executing the following command from a command shell:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jbang version</code></pre> </div> </div> <div class="paragraph"> <p>Which should output the version of JBang.</p> </div> <div class="paragraph"> <p>To make it easier to use Camel JBang, then install the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jbang app install camel@apache/camel</code></pre> </div> </div> <div class="paragraph"> <p>This will install Apache Camel as the <code>camel</code> command within JBang, meaning that you can run Camel from the command line by just executing <code>camel</code> (see more next).</p> </div> <div class="paragraph"> <p>Note: It requires access to the internet, in case of using a proxy, please ensure that the proxy is configured for your system. If Camel JBang is not working with your current configuration, please look to <a href="https://www.jbang.dev/documentation/guide/latest/configuration.html#proxy-configuration">Proxy configuration in JBang documentation</a>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_container_image"><a class="anchor" href="#_container_image"></a>Container Image</h2> <div class="sectionbody"> <div class="paragraph"> <p>There is also a container image available in <a href="https://hub.docker.com/r/apache/camel-jbang/">Dockerhub</a></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker pull apache/camel-jbang:4.4.0</code></pre> </div> </div> <div class="paragraph"> <p>or</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman pull apache/camel-jbang:4.4.0</code></pre> </div> </div> <div class="paragraph"> <p>Once you have the image in your local registry, you can run all the commands listed below by simple doing:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run apache/camel-jbang:4.4.0 version</code></pre> </div> </div> <div class="paragraph"> <p>or</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman run apache/camel-jbang:4.4.0 version</code></pre> </div> </div> <div class="paragraph"> <p>This will print the following result:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Camel JBang version: 4.4.0</code></pre> </div> </div> <div class="paragraph"> <p>So running a simple route will be as easy as doing the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run -v .:/integrations apache/camel-jbang:4.4.0 run /integrations/example.yaml</code></pre> </div> </div> <div class="paragraph"> <p>or</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">podman run -v .:/integrations apache/camel-jbang:4.4.0 run /integrations/example.yaml</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_using_camel_jbang"><a class="anchor" href="#_using_camel_jbang"></a>Using Camel JBang</h2> <div class="sectionbody"> <div class="paragraph"> <p>The Camel JBang supports multiple commands. Running the command below will print all of them:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel --help</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> The first time you run this command, it may cause dependencies to be cached, therefore taking a few extra seconds to run. If you are already using JBang and you get first time to run errors such as <code>Exception in thread "main" java.lang.NoClassDefFoundError: "org/apache/camel/dsl/jbang/core/commands/CamelJBangMain"</code> you may try clearing the JBang cache and re-install again. </td> </tr> </table></div> </div> <div class="paragraph"> <p>All the commands support the <code>--help</code> and will display the appropriate help if that flag is provided.</p> </div> <div class="sect2"> <h3 id="_enable_shell_completion"><a class="anchor" href="#_enable_shell_completion"></a>Enable shell completion</h3> <div class="paragraph"> <p>Camel JBang provides shell completion for bash and zsh out of the box. To enable shell completion for Camel JBang, run:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">source &lt;(camel completion)</code></pre> </div> </div> <div class="paragraph"> <p>To make it permanent, run:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo 'source &lt;(camel completion)' &gt;&gt; ~/.bashrc</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_creating_and_running_camel_routes"><a class="anchor" href="#_creating_and_running_camel_routes"></a>Creating and running Camel routes</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can create a new basic routes with the <code>init</code> command.</p> </div> <div class="paragraph"> <p>For example, to create an XML route, you can run:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init cheese.xml</code></pre> </div> </div> <div class="paragraph"> <p>Which creates the file <code>cheese.xml</code> (in the current directory) with a sample route.</p> </div> <div class="paragraph"> <p>To run the file, you do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run cheese.xml</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You can create and run any of the supported <a href="dsl.html" class="xref page">DSLs</a> in Camel such as YAML, XML, Java, Groovy. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To create a new .java route, you simply do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init foo.java</code></pre> </div> </div> <div class="paragraph"> <p>When using the init command, then Camel will by default create the file in the current directory. However, you can use the <code>--directory</code> option to create the file in the specified directory. For example, to create in a folder named <code><em>foobar</em></code> you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init foo.java --directory=foobar</code></pre> </div> </div> <div class="sect2"> <h3 id="_running_routes_from_multiple_files"><a class="anchor" href="#_running_routes_from_multiple_files"></a>Running Routes from multiple files</h3> <div class="paragraph"> <p>You can run more than one file, for example, to run two YAML files you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run one.yaml two.yaml</code></pre> </div> </div> <div class="paragraph"> <p>You can also mix different <a href="dsl.html" class="xref page">DSLs</a> such as YAML and Java:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run one.yaml hello.java</code></pre> </div> </div> <div class="paragraph"> <p>You can also use wildcards (i.e. <code>*</code>) to match multiple files, such as running all the YAML files:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run *.yaml</code></pre> </div> </div> <div class="paragraph"> <p>Or you can run all files starting with foo*</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo*</code></pre> </div> </div> <div class="paragraph"> <p>And to run everything</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run *</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> The run goal can also detect files that are <code>properties</code>, such as <code>application.properties</code>. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_running_a_maven_or_gradle_based_project"><a class="anchor" href="#_running_a_maven_or_gradle_based_project"></a>Running a Maven or Gradle based project</h3> <div class="paragraph"> <p>Camel JBang is intended for flat-file-based projects, where you run small integrations. However, Camel JBang may be used as a tool for migrating existing Maven or Gradle based projects. To make the migration easier, then JBang can do <em>best effort</em> to run, export, or transform these projects.</p> </div> <div class="paragraph"> <p>For example, if you have a Maven-based project, you can execute</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run pom.xml</code></pre> </div> </div> <div class="paragraph"> <p>or for a Gradle project</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run build.gradle</code></pre> </div> </div> <div class="paragraph"> <p>Camel JBang will then scan in <code>src/main/java</code> and <code>src/main/resources</code> for files to include (recursive).</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Using <code>camel run pom.xml</code> is not intended as a fully compatible way of running an existing Maven-based project. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_running_route_with_user_interactive_prompt_for_placeholder_values"><a class="anchor" href="#_running_route_with_user_interactive_prompt_for_placeholder_values"></a>Running Route with user interactive prompt for placeholder values</h3> <div class="paragraph"> <p>You can create Camel integrations that makes it possible for the user to quickly enter placeholder values from command prompt.</p> </div> <div class="paragraph"> <p>For example, given the following route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.apache.camel.builder.RouteBuilder;

public class foo extends RouteBuilder {

    @Override
    public void configure() throws Exception {
        from("timer:java?period={{time:1000}}")
            .setBody()
                .simple("Hello Camel from {{you}}")
            .log("${body}");
    }
}</code></pre> </div> </div> <div class="paragraph"> <p>Then if you run this with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java</code></pre> </div> </div> <div class="paragraph"> <p>You will have an exception on startup about the missing value</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Caused by: java.lang.IllegalArgumentException: Property with key [you] not found in properties from text: Hello Camel from {{you}}`</code></pre> </div> </div> <div class="paragraph"> <p>However, you can then run in prompt mode as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --prompt</code></pre> </div> </div> <div class="paragraph"> <p>And Camel will now prompt in the terminal for you to enter values for the placeholders:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">2023-12-15 21:46:44.218  INFO 15033 --- [           main] org.apache.camel.main.MainSupport   : Apache Camel (JBang) 4.7.0 is starting
2023-12-15 21:46:44.331  INFO 15033 --- [           main] org.apache.camel.main.MainSupport   : Using Java 17.0.5 with PID 15033. Started by davsclaus in /Users/davsclaus/workspace/deleteme/prompt
2023-12-15 21:46:45.360  INFO 15033 --- [           main] mel.cli.connector.LocalCliConnector : Management from Camel JBang enabled
Enter optional value for time (1000):
Enter required value for you: Jack
2023-12-15 21:46:55.239  INFO 15033 --- [           main] el.impl.engine.AbstractCamelContext : Apache Camel 4.7.0 (foo) is starting
2023-12-15 21:46:55.323  INFO 15033 --- [           main] g.apache.camel.main.BaseMainSupport : Property-placeholders summary
2023-12-15 21:46:55.323  INFO 15033 --- [           main] g.apache.camel.main.BaseMainSupport :     [prompt]                       you=Jack
2023-12-15 21:46:55.341  INFO 15033 --- [           main] el.impl.engine.AbstractCamelContext : Routes startup (started:1)</code></pre> </div> </div> <div class="paragraph"> <p>From the snippet above, Camel JBang had two prompts. First for the <code>time</code> which has a default value of <code>1000</code> so you can just press ENTER to accept the default value. And for <code>you</code> a value must be entered, and we entered <code>Jack</code> in this example.</p> </div> <div class="paragraph"> <p>You may want to use this for Camel prototypes where you want the user to be able to enter custom values quickly. Those values can of course be pre-configured in <code>application.properties</code> as well.</p> </div> </div> <div class="sect2"> <h3 id="_running_route_from_input_parameter"><a class="anchor" href="#_running_route_from_input_parameter"></a>Running Route from input parameter</h3> <div class="paragraph"> <p>For very small Java routes then it is possible to provide the route as CLI argument, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --code='from("kamelet:beer-source").to("log:beer")'</code></pre> </div> </div> <div class="paragraph"> <p>This is very limited as the CLI argument is a bit cumbersome to use than files.</p> </div> <div class="ulist"> <ul> <li> <p>Java DSL code is only supported</p> </li> <li> <p>Code wrapped in single quote, so you can use double quote in Java DSL</p> </li> <li> <p>Code limited to what literal values possible to provide from the terminal and JBang.</p> </li> <li> <p>All route(s) must be defined in a single <code>--code</code> parameter.</p> </li> </ul> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Using <code>--code</code> is only usable for very quick and small prototypes. </td> </tr> </table></div> </div> <div class="paragraph"> <p>From <strong>Camel 4.7</strong> onwards the <code>--code</code> parameter can also refer to a <code>.java</code> source file, that are not wrapped in a <code>public class</code> which makes it possible to quickly try a prototype with some Camel java based routes such as the following stored in a file named <code>quick.java</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("timer:java?period=1000")
    .setBody()
        .simple("Hello Quick Camel from ${routeId}")
    .log("${body}");</code></pre> </div> </div> <div class="paragraph"> <p>Then you can run this route via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --code=quick.java</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You cannot use <code>--dev</code> to hot-reload this on code changes. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_running_routes_from_source_directory"><a class="anchor" href="#_running_routes_from_source_directory"></a>Running Routes from source directory</h3> <div class="paragraph"> <p>You can also run dev mode when running Camel with <code>--source-dir</code>, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --source-dir=mycode</code></pre> </div> </div> <div class="paragraph"> <p>This starts Camel where it will load the files from the <em>source dir</em> (also subfolders).</p> </div> </div> <div class="sect2"> <h3 id="_stub_components_that_should_not_be_active"><a class="anchor" href="#_stub_components_that_should_not_be_active"></a>Stub components that should not be active</h3> <div class="paragraph"> <p>Sometimes you need to troubleshoot an existing integration and is given some Camel code (routes). These routes may use different components, and those components may be tricky to run as they are configured in a custom way, or need connection to servers you may not have access to.</p> </div> <div class="paragraph"> <p>You can run Camel JBang by stubbing those components (or all of them).</p> </div> <div class="paragraph"> <p>For example, suppose you need access to a JMS broker in the given route below.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("jms:inbox")
  .log("Incoming order")
  .to("bean:transform")
  .log("After transformation")
  .to("jms:process");</code></pre> </div> </div> <div class="paragraph"> <p>Then you can run this by stub the <code>jms</code> component by:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run syncToDatabase.java --stub=jms</code></pre> </div> </div> <div class="paragraph"> <p>Then Camel will not start up the JMS component but replace it with the <code>stub</code> component, but keep the actual endpoint URIs.</p> </div> <div class="paragraph"> <p>You can then simulate sending messages to Camel with the <code>cmd send</code> command:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd send --body='Something here'</code></pre> </div> </div> <div class="paragraph"> <p>Which then will send the message to the incoming endpoint in the route, i.e. <code>jms:inbox</code> which has been stubbed.</p> </div> <div class="paragraph"> <p>You can also stub a specific endpoint by providing the full uri, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run syncToDatabase.java --stub=jms:inbox</code></pre> </div> </div> <div class="paragraph"> <p>Then only the <code>jms:inbox</code> endpoint is stubbed.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can stub multiple components separated by comma, such as <code>--stub=jms,sql</code> </td> </tr> </table></div> </div> <div class="paragraph"> <p>Camel JBang comes with the <code>camel cmd stub</code> command that allows to list all endpoints that has been stubbed, and also browse any messages that are currently present in their internal queues. A stub endpoint is based on the <code>seda</code> component.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd stub</code></pre> </div> </div> <div class="paragraph"> <p>And to browse the messages:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd stub --browse</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_dev_mode_with_live_reload"><a class="anchor" href="#_dev_mode_with_live_reload"></a>Dev mode with live reload</h3> <div class="paragraph"> <p>You can enable dev mode that comes with live reload of the route(s) when the source file is updated (saved), using the <code>--dev</code> options as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.yaml --dev</code></pre> </div> </div> <div class="paragraph"> <p>Then, while the Camel integration is running, you can update the YAML route and update when saving.</p> </div> <div class="paragraph"> <p>This works for all DSLs, even java, so you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run hello.java --dev</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The live reload is meant for development purposes, and if you encounter problems with reloading such as JVM class loading issues, then you may need to restart the integration. Java files cannot be supported in Spring Boot runtime since they have to be recompiled to trigger a restart. </td> </tr> </table></div> </div> <div class="paragraph"> <p>You can also run dev mode when running Camel with <code>--source-dir</code>, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --source-dir=mycode --dev</code></pre> </div> </div> <div class="paragraph"> <p>This starts Camel where it will load the files from the <em>source dir</em> (also subfolders). And in <em>dev mode</em> then you can add new files, update existing files, and delete files, and Camel will automatically hot-reload on the fly.</p> </div> <div class="paragraph"> <p>Using <em>source dir</em> is more flexible than having to specify the files in the CLI as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run mycode/foo.java mycode/bar.java --dev</code></pre> </div> </div> <div class="paragraph"> <p>In this situation, then Camel will only watch and reload these two files (foo.java and bar.java). So, for example, if you add a new file cheese.xml, then this file is not reloaded. On the other hand, if you use <code>--source-dir</code> then any files in this directory (and subfolders) are automatic detected and reloaded. You can also delete files to remove routes.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You cannot use both files and source dir together. The following is not allowed: <code>camel run abc.java --source-dir=mycode</code>. </td> </tr> </table></div> </div> <div class="sect3"> <h4 id="_uploading_files_to_source_directory_via_http"><a class="anchor" href="#_uploading_files_to_source_directory_via_http"></a>Uploading files to source directory via HTTP</h4> <div class="paragraph"> <p>When running Camel JBang with <code>--source-dir</code>, <code>--console</code> and <code>--dev</code> (reloading) then you can change the source files on-the-fly by copying, modifying or deleting the files in the source directory.</p> </div> <div class="paragraph"> <p>This can also be done via HTTP using the <code>q/upload/:filename</code> HTTP endpoint using PUT and DELETE verbs.</p> </div> <div class="paragraph"> <p>Suppose that you run Camel JBang with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --source-dir=mycode --console --dev</code></pre> </div> </div> <div class="paragraph"> <p>Then you can upload or modify a source file named <code>bar.java</code> you can send a PUT request via curl:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X PUT http://0.0.0.0:8080/q/upload/bar.java --data-binary "@bar.java"</code></pre> </div> </div> <div class="paragraph"> <p>Or via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -T bar.java http://0.0.0.0:8080/q/upload/bar.java</code></pre> </div> </div> <div class="paragraph"> <p>To send the data via PUT, then the file body can be included when using <code>Content-Type: application/x-www-form-urlencoded</code>:</p> </div> <div class="paragraph"> <p>For example, from a CURL <code>--ascii-trace</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">0000: PUT /q/upload/bar.java HTTP/1.1
0021: Host: 0.0.0.0:8080
0035: User-Agent: curl/7.87.0
004e: Accept: */*
005b: Content-Length: 385
0070: Content-Type: application/x-www-form-urlencoded
00a1:
=&gt; Send data, 385 bytes (0x181)
0000: // camel-k: language=java..import org.apache.camel.builder.Route
0040: Builder;..public class bar extends RouteBuilder {..    @Override
0080: .    public void configure() throws Exception {..        // Writ
00c0: e your routes here, for example:.        from("timer:java?period
0100: ={{time:1000}}").            .setBody().                .simple(
0140: "XXXCamel from ${routeId}").            .log("${body}");.    }.}
0180: .
== Info: Mark bundle as not supporting multiuse
&lt;= Recv header, 17 bytes (0x11)
0000: HTTP/1.1 200 OK
&lt;= Recv header, 19 bytes (0x13)
0000: content-length: 0
&lt;= Recv header, 2 bytes (0x2)
0000:
== Info: Connection #0 to host 0.0.0.0 left intact</code></pre> </div> </div> <div class="paragraph"> <p>To delete one or more files, you use the DELETE verb, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X DELETE http://0.0.0.0:8080/q/upload/bar.java</code></pre> </div> </div> <div class="paragraph"> <p>You can also use wildcards ('*') to delete all .java files:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X DELETE http://0.0.0.0:8080/q/upload/*.java</code></pre> </div> </div> <div class="paragraph"> <p>Or to delete everything</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -X DELETE http://0.0.0.0:8080/q/upload/*</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="_developer_console"><a class="anchor" href="#_developer_console"></a>Developer Console</h3> <div class="paragraph"> <p>You can enable the developer console, which presents a variety of information to the developer.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run hello.java --console</code></pre> </div> </div> <div class="paragraph"> <p>The console is then accessible from a web browser at: <a href="http://localhost:8080/q/dev" class="bare">http://localhost:8080/q/dev</a> (by default). The link is also shown in the log when Camel is starting up.</p> </div> <div class="paragraph"> <p>The console can give you insights into your running Camel integration, such as reporting the top routes that takes the longest time to process messages. You can then drill down to pinpoint exactly which individual EIPs in these routes are the slowest.</p> </div> <div class="paragraph"> <p>The developer console can also output the data in JSON format, which, for example, can be used by 3rd-party tooling to scrape the information.</p> </div> <div class="paragraph"> <p>For example, to output the top routes via curl, you can execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -s -H "Accept: application/json"  http://0.0.0.0:8080/q/dev/top/</code></pre> </div> </div> <div class="paragraph"> <p>And if you have <code>jq</code> installed which can format and output the JSON data in color, then do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -s -H "Accept: application/json"  http://0.0.0.0:8080/q/dev/top/ | jq</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_using_profiles"><a class="anchor" href="#_using_profiles"></a>Using profiles</h3> <div class="paragraph"> <p><strong>Available from Camel 4.5</strong></p> </div> <div class="paragraph"> <p>Camel JBang comes with three sets of profiles</p> </div> <div class="ulist"> <ul> <li> <p><code>dev</code>:for development (default)</p> </li> <li> <p><code>test</code>:for testing (currently same as production)</p> </li> <li> <p><code>prod</code>:for production</p> </li> </ul> </div> <div class="paragraph"> <p>The developer profile will pre-configure Camel JBang with a number of developer assisted features when running Camel. For example, tracing messages during routing, additional metrics collected, and more. This is useful during development and also enhanced the Camel JBang CLI tool.</p> </div> <div class="paragraph"> <p>However, you may want to run Camel JBang in a production-like scenario, which you can do with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run hello.java --profile=prod</code></pre> </div> </div> <div class="paragraph"> <p>You can have profile-specific configuration in configuration files using the naming style <code>application-&lt;profile&gt;.properties</code>, such as in the following:</p> </div> <div class="ulist"> <ul> <li> <p><code>application.properties</code>: common configuration that is always in use (default).</p> </li> <li> <p><code>application-dev.properties</code>: developer specific configuration for the <code>dev</code> profile.</p> </li> <li> <p><code>application-prod.properties</code>: developer specific configuration for the <code>prod</code> profile.</p> </li> </ul> </div> <div class="paragraph"> <p>The profile-specific configuration will override values in the common configuration.</p> </div> </div> <div class="sect2"> <h3 id="_downloading_jars_over_the_internet"><a class="anchor" href="#_downloading_jars_over_the_internet"></a>Downloading JARs over the internet</h3> <div class="paragraph"> <p>By default, Camel JBang will automatically resolve dependencies needed to run Camel, which is done by JBang and Camel respectively. Camel itself detects at runtime if a component has a need for JARs that are not currently available on the classpath, and can then automatically download the JARs (incl transitive).</p> </div> <div class="paragraph"> <p>Camel will download these JARs in the following order:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>from local disk in <code>~/.m2/repository</code></p> </li> <li> <p>from the internet in Maven Central</p> </li> <li> <p>from the internet from custom third-party Maven repositories</p> </li> <li> <p>from all the repositories found in active profiles of <code>~/.m2/settings.xml</code> or a settings file specified using <code>--maven-settings</code> option.</p> </li> </ol> </div> <div class="paragraph"> <p>If you do not want Camel JBang to download over the internet, you can turn this off with <code>--download</code>, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --download=false</code></pre> </div> </div> <div class="paragraph"> <p>If you do not want Camel JBang to use your existing Maven settings file, you can use:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --maven-settings=false</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_adding_custom_jars"><a class="anchor" href="#_adding_custom_jars"></a>Adding custom JARs</h3> <div class="paragraph"> <p>Camel JBang will automatically detect dependencies for Camel components, languages, data formats, etc. that from its own release. This means you often do not have to specify which JARs to use.</p> </div> <div class="paragraph"> <p>However, if you need to add 3rd-party custom JARs, then you can specify these with <code>--dep</code> as CLI argument in Maven GAV syntax (<code>groupId:artifactId:version</code>), such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --dep=com.foo:acme:1.0</code></pre> </div> </div> <div class="paragraph"> <p>In case you need to explicit add a Camel dependency you can use a shorthand syntax (starting with <code>camel:</code> or <code>camel-</code>) such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --dep=camel-saxon</code></pre> </div> </div> <div class="paragraph"> <p>You can specify multiple dependencies separated by comma:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --dep=camel-saxon,com.foo:acme:1.0</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_using_3rd_party_maven_repositories"><a class="anchor" href="#_using_3rd_party_maven_repositories"></a>Using 3rd-party Maven repositories</h3> <div class="paragraph"> <p>Camel JBang will download from local repository first, and then online from Maven Central. To be able to download from 3rd-party Maven repositories then you need to specify this as CLI argument, ]or in <code>application.properties</code></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --repos=https://packages.atlassian.com/maven-external</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Multiple repositories can be separated by comma </td> </tr> </table></div> </div> <div class="paragraph"> <p>The configuration for the 3rd-party Maven repositories can also be configured in <code>application.properties</code> with the key <code>camel.jbang.repos</code> as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">camel.jbang.repos=https://packages.atlassian.com/maven-external</code></pre> </div> </div> <div class="paragraph"> <p>And when running Camel then <code>application.properties</code> is automatically loaded:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java</code></pre> </div> </div> <div class="paragraph"> <p>However, you can also explicitly specify the properties file to use:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java application.properties</code></pre> </div> </div> <div class="paragraph"> <p>And even better if you specify this as a profile:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --profile=application</code></pre> </div> </div> <div class="paragraph"> <p>Where the profile id is the name of the properties file.</p> </div> </div> <div class="sect2"> <h3 id="_configuration_of_maven_usage"><a class="anchor" href="#_configuration_of_maven_usage"></a>Configuration of Maven usage</h3> <div class="paragraph"> <p>By default, existing <code>~/.m2/settings.xml</code> file is loaded, so it is possible to alter the behaviour of Maven resolution process. Maven settings file can provide information about Maven mirrors, credential configuration (potentially encrypted) or active profiles, and additional repositories.</p> </div> <div class="paragraph"> <p>Maven repositories can use authentication and the Maven-way to configure credentials is through <code>&lt;server&gt;</code> elements, like this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;server&gt;
    &lt;id&gt;external-repository&lt;/id&gt;
    &lt;username&gt;camel&lt;/username&gt;
    &lt;password&gt;{SSVqy/PexxQHvubrWhdguYuG7HnTvHlaNr6g3dJn7nk=}&lt;/password&gt;
&lt;/server&gt;</code></pre> </div> </div> <div class="paragraph"> <p>While the password may be specified using plain text, it&#8217;s better to configure maven master password first and then use it to configure repository password:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn -emp
Master password: camel
{hqXUuec2RowH8dA8vdqkF6jn4NU9ybOsDjuTmWvYj4U=}</code></pre> </div> </div> <div class="paragraph"> <p>The above password should be added to <code>~/.m2/settings-security.xml</code> file like this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;settingsSecurity&gt;
  &lt;master&gt;{hqXUuec2RowH8dA8vdqkF6jn4NU9ybOsDjuTmWvYj4U=}&lt;/master&gt;
&lt;/settingsSecurity&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Then a normal password can be configured like this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn -ep
Password: camel
{SSVqy/PexxQHvubrWhdguYuG7HnTvHlaNr6g3dJn7nk=}</code></pre> </div> </div> <div class="paragraph"> <p>Finally, such passwords can be used in <code>&lt;server&gt;/&lt;password&gt;</code> configuration.</p> </div> <div class="paragraph"> <p>By default, Maven reads the master password from <code>~/.m2/settings-security.xml</code> file, but we can override it. The location of the <code>settings.xml</code> file itself can be specified as well:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --maven-settings=/path/to/settings.xml --maven-settings-security=/path/to/settings-security.xml</code></pre> </div> </div> <div class="paragraph"> <p>If you want to run Camel application without assuming any location (even <code>~/.m2/settings.xml</code>), use this option:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java --maven-settings=false</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_running_routes_hosted_on_github"><a class="anchor" href="#_running_routes_hosted_on_github"></a>Running routes hosted on GitHub</h3> <div class="paragraph"> <p>You can run a route hosted on GitHub using Camels <a href="../components/4.8.x/others/resourceresolver-github.html" class="xref page">GitHub</a> resource loader.</p> </div> <div class="paragraph"> <p>For example, to run one of the Camel K examples, you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run github:apache:camel-kamelets-examples:jbang/hello-java/Hey.java</code></pre> </div> </div> <div class="paragraph"> <p>You can also use the <code>https</code> URL for GitHub. For example, you can browse the examples from a web-browser and then copy the URL from the browser window and run the example with Camel JBang:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run https://github.com/apache/camel-kamelets-examples/tree/main/jbang/hello-java</code></pre> </div> </div> <div class="paragraph"> <p>You can also use wildcards (i.e. <code>*</code>) to match multiple files, such as running all the groovy files:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run https://github.com/apache/camel-kamelets-examples/tree/main/jbang/languages/*.groovy</code></pre> </div> </div> <div class="paragraph"> <p>Or you can run all files starting with rou*</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run https://github.com/apache/camel-kamelets-examples/tree/main/jbang/languages/rou*</code></pre> </div> </div> <div class="sect3"> <h4 id="_running_routes_from_github_gists"><a class="anchor" href="#_running_routes_from_github_gists"></a>Running routes from GitHub gists</h4> <div class="paragraph"> <p>Using gists from GitHub is a quick way to share small Camel routes that you can easily run.</p> </div> <div class="paragraph"> <p>For example, to run a gist, you can execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run https://gist.github.com/davsclaus/477ddff5cdeb1ae03619aa544ce47e92</code></pre> </div> </div> <div class="paragraph"> <p>A gist can contain one or more files, and Camel JBang will gather all relevant files, so a gist can contain multiple routes, properties files, Java beans, etc.</p> </div> </div> </div> <div class="sect2"> <h3 id="_downloading_routes_hosted_on_github"><a class="anchor" href="#_downloading_routes_hosted_on_github"></a>Downloading routes hosted on GitHub</h3> <div class="paragraph"> <p>We have made it easy for Camel JBang to download existing examples from GitHub to local disk, which allows for modifying the example and to run locally.</p> </div> <div class="paragraph"> <p>All you need to do is to copy the https link from the web browser. For example, you can download the <em>dependency injection</em> example by:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init https://github.com/apache/camel-kamelets-examples/tree/main/jbang/dependency-injection</code></pre> </div> </div> <div class="paragraph"> <p>Then the files (not subfolders) are downloaded to the current directory. The example can then be run locally with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run *</code></pre> </div> </div> <div class="paragraph"> <p>You can also download to a new folder using the <code>--directory</code> option, for example, to download to a folder named <em>myproject</em>, you would do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init https://github.com/apache/camel-kamelets-examples/tree/main/jbang/dependency-injection --directory=myproject</code></pre> </div> </div> <div class="paragraph"> <p>You can also run in dev mode, to hot-deploy on source code changes.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run * --dev</code></pre> </div> </div> <div class="paragraph"> <p>You can also download a single file, such as one of the Camel K examples:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init https://github.com/apache/camel-k-examples/blob/main/generic-examples/languages/simple.groovy</code></pre> </div> </div> <div class="paragraph"> <p>This is a groovy route, which you can run with (or use <code>*</code>):</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run simple.groovy</code></pre> </div> </div> <div class="sect3"> <h4 id="_downloading_routes_form_github_gists"><a class="anchor" href="#_downloading_routes_form_github_gists"></a>Downloading routes form GitHub gists</h4> <div class="paragraph"> <p>You can also download files from gists easily as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init https://gist.github.com/davsclaus/477ddff5cdeb1ae03619aa544ce47e92</code></pre> </div> </div> <div class="paragraph"> <p>This will then download the files to local disk, which you can run afterward:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run *</code></pre> </div> </div> <div class="paragraph"> <p>You can also download to a new folder using the <code>--directory</code> option, for example, to download to a folder named <em>foobar</em>, you would do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init https://gist.github.com/davsclaus/477ddff5cdeb1ae03619aa544ce47e92 --directory=foobar</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="_using_a_specific_camel_version"><a class="anchor" href="#_using_a_specific_camel_version"></a>Using a specific Camel version</h3> <div class="paragraph"> <p>You can specify which Camel version to run as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jbang -Dcamel.jbang.version=3.18.4 camel@apache/camel [command]</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Older versions of Camel may not work as well with Camel JBang as the newest versions. Starting from Camel 3.20 onwards are the versions that are recommended to be used onwards. </td> </tr> </table></div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> In Camel <strong>3.20.3</strong> onwards there is a <code>version</code> command, see the following section for more details. </td> </tr> </table></div> </div> <div class="paragraph"> <p>In <strong>Camel 3.20.2</strong> onwards the <code>run</code> command has built-in support, using <code>--camel-version</code>, for specifying the Camel version to use for the running Camel integration.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run * --camel-version=3.18.4</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> This makes it easy to try different Camel versions, for example, when you need to reproduce an issue, and find out how it works in a different Camel version. </td> </tr> </table></div> </div> <div class="paragraph"> <p>You can also try bleeding-edge development by using SNAPSHOT such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jbang --fresh -Dcamel.jbang.version=3.21.0-SNAPSHOT camel@apache/camel [command]</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_using_the_version_command"><a class="anchor" href="#_using_the_version_command"></a>Using the version command</h3> <div class="paragraph"> <p>In <strong>Camel 3.20.3</strong> onwards the <code>version</code> command makes it possible to configure a specific version of Camel to use when running or exporting. This makes it possible to use the latest Camel JBang CLI and run integrations using an older Camel version.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version
Camel JBang version: 3.20.3</code></pre> </div> </div> <div class="paragraph"> <p>Here Camel JBang is using version 3.20.3. Now suppose we want to run Camel integrations with version 3.18.2.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version set 3.18.2</code></pre> </div> </div> <div class="paragraph"> <p>And you can see what Camel version has been set by:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version
Camel JBang version: 3.20.3
User configuration:
    camel-version = 3.18.2</code></pre> </div> </div> <div class="paragraph"> <p>And when running an integration, then Camel JBang will show you the <em>overridden version</em> when starting.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.java
Running integration with the following configuration:
    --camel-version=3.18.2
2023-03-17 13:35:13.876  INFO 28451 --- [           main] org.apache.camel.main.MainSupport        : Apache Camel (JBang) 3.18.2 is starting
...</code></pre> </div> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> You cannot use both a set version via <code>camel version set</code> and also a version specified via <code>--camel-version</code> option, i.e., the following is not possible: </td> </tr> </table></div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version set 4.0.1
camel run * --camel-version=4.3.0</code></pre> </div> </div> <div class="paragraph"> <p>If you want to unset the version, you can use the <code>--reset</code> option:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version set --reset</code></pre> </div> </div> <div class="paragraph"> <p>Then the Camel version in use will be the same version as Camel JBang.</p> </div> <div class="sect3"> <h4 id="_listing_available_camel_releases"><a class="anchor" href="#_listing_available_camel_releases"></a>Listing available Camel releases</h4> <div class="paragraph"> <p>The <code>version</code> command can also show available Camel releases by checking the Maven central repository.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version list
 CAMEL VERSION   JDK   KIND     RELEASED     SUPPORTED UNTIL
    3.14.0       8,11  LTS    December 2021    December 2023
    3.14.1       8,11  LTS     January 2022    December 2023
    3.14.2       8,11  LTS       March 2022    December 2023
    3.14.3       8,11  LTS         May 2022    December 2023
    3.14.4       8,11  LTS        June 2022    December 2023
    3.14.5       8,11  LTS      August 2022    December 2023
    3.14.6       8,11  LTS    November 2022    December 2023
    3.14.7       8,11  LTS    December 2022    December 2023
    3.15.0         11         February 2022
    3.16.0         11            March 2022
    3.17.0      11,17              May 2022
    3.18.0      11,17  LTS        July 2022        July 2023
    3.18.1      11,17  LTS      August 2022        July 2023
    3.18.2      11,17  LTS   September 2022        July 2023
    3.18.3      11,17  LTS     October 2022        July 2023
    3.18.4      11,17  LTS    December 2022        July 2023
    3.18.5      11,17  LTS     January 2023        July 2023
    3.19.0      11,17          October 2022
    3.20.0      11,17  LTS    December 2022    December 2023
    3.20.1      11,17  LTS     January 2023    December 2023
    3.20.2      11,17  LTS    February 2023    December 2023
   4.0.0-M1        17   RC    February 2023
   4.0.0-M2        17   RC       March 2023</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The <code>version list</code> shows the latest releases going back a few versions, at this time of writing the minimum version is Camel 3.14. To show all Camel 3.x releases, you can specify <code>--from-version=3.0</code> and the list is longer. The list can only go back to Camel 2.18, as we do not have all release meta-data for older releases. </td> </tr> </table></div> </div> <div class="paragraph"> <p>You can also show Camel releases for either Spring Boot or Quarkus using the <code>--runtime</code> option, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel version list --runtime=quarkus
 CAMEL VERSION  QUARKUS   JDK  KIND     RELEASED     SUPPORTED UNTIL
    3.14.0       2.6.0     11         December 2021
    3.14.1       2.7.0     11  LTS    February 2022      August 2022
    3.14.2       2.7.1     11  LTS       April 2022      August 2022
    3.14.4       2.7.2     11  LTS        July 2022      August 2022
    3.15.0      2.8.0-M1   11            March 2022
    3.16.0       2.8.0     11            April 2022
    3.16.0       2.9.0     11              May 2022
    3.17.0       2.10.0    11             June 2022
    3.18.0       2.11.0    11             July 2022
    3.18.1       2.12.0    11        September 2022
    3.18.2       2.13.0    11  LTS   September 2022       March 2023
    3.18.3       2.13.1    11  LTS    November 2022       March 2023
    3.18.3       2.13.2    11  LTS    December 2022       March 2023
    3.19.0       2.14.0    11         November 2022
    3.19.0       2.15.0    11         December 2022
    3.20.1       2.16.0    11          January 2023</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See more options with <code>camel version list --help</code>. </td> </tr> </table></div> </div> </div> </div> <div class="sect2"> <h3 id="_manage_plugins"><a class="anchor" href="#_manage_plugins"></a>Manage plugins</h3> <div class="paragraph"> <p>Camel JBang uses a plugin concept for some of the subcommands so users can add functionality on demand. Each provided plugin adds a list of commands to the Camel JBang command line tool.</p> </div> <div class="paragraph"> <p>You can list the supported plugins with</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel plugin get --all</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Supported plugins:

 NAME        COMMAND     DEPENDENCY                                      DESCRIPTION
 kubernetes  kubernetes  org.apache.camel:camel-jbang-plugin-kubernetes  Run Camel applications on Kubernetes
 camel-k     k           org.apache.camel:camel-jbang-plugin-k           Managed Camel integrations on Kubernetes
 generate    generate    org.apache.camel:camel-jbang-plugin-generate    Generate code such as DTOs</code></pre> </div> </div> <div class="paragraph"> <p>In case you want to enable a plugin and its functionality, you can add it as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel plugin add &lt;plugin-name&gt;</code></pre> </div> </div> <div class="paragraph"> <p>For example to install <code>generate</code> you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel plugin add generate</code></pre> </div> </div> <div class="paragraph"> <p>This adds the plugin, and all subcommands are now available for execution.</p> </div> <div class="paragraph"> <p>You can list the currently installed plugins with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel plugin get</code></pre> </div> </div> <div class="paragraph"> <p>To remove a plugin from the current Camel JBang command line tooling, you can use the <code>plugin delete</code> command.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel plugin delete &lt;plugin-name&gt;</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_running_camel_k_integrations_or_pipes"><a class="anchor" href="#_running_camel_k_integrations_or_pipes"></a>Running Camel K integrations or pipes</h3> <div class="paragraph"> <p>Camel also supports running Camel K integrations and pipes, which represent Kubernetes custom resources following a specific CRD format (Kubernetes Custom Resource Definitions).</p> </div> <div class="paragraph"> <p>For example, a pipe file named <code>joke.yaml</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">#!/usr/bin/env jbang camel@apache/camel run
apiVersion: camel.apache.org/v1
kind: Pipe
metadata:
  name: joke
spec:
  source:
    ref:
      kind: Kamelet
      apiVersion: camel.apache.org/v1
      name: chuck-norris-source
    properties:
      period: 2000
  sink:
    ref:
      kind: Kamelet
      apiVersion: camel.apache.org/v1
      name: log-sink
    properties:
      show-headers: false</code></pre> </div> </div> <div class="paragraph"> <p>Can be run with camel:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run joke.yaml</code></pre> </div> </div> <div class="sect3"> <h4 id="_binding_kamelets_in_a_pipe"><a class="anchor" href="#_binding_kamelets_in_a_pipe"></a>Binding Kamelets in a pipe</h4> <div class="paragraph"> <p>Camel JBang is able to create the Pipe custom resource for you. You can use the <code>bind</code> command to specify a source and a sink that should be set in the pipe. As a result, Camel JBang will create a proper Pipe custom resource for you.</p> </div> <div class="paragraph"> <p>The command expects a file name as command argument and provides several options to define the source and the sink that should be used in the pipe.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel bind joke.yaml --source chuck-norris-source --sink log-sink</code></pre> </div> </div> <div class="paragraph"> <p>This creates the <code>joke.yaml</code> file that represents the Pipe resource.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: camel.apache.org/v1
kind: Pipe
metadata:
  name: joke
spec:
  source:
    ref:
      kind: Kamelet
      apiVersion: camel.apache.org/v1
      name: chuck-norris-source
    properties:
      period: 5000
  sink:
    ref:
      kind: Kamelet
      apiVersion: camel.apache.org/v1
      name: log-sink</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The bind command is able to inspect the Kamelets being used as a source and sink in order to automatically set all required properties. In case the Kamelet defines a required property, and the user has not specified such, the command will automatically set this property with an example value. Once the pipe resource file is generated, you can review and set the properties as you wish. </td> </tr> </table></div> </div> <div class="paragraph"> <p>The bind command supports the following options:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Option</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--source</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Source (from) such as a Kamelet or Camel endpoint uri that provides data.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--sink</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sink (to) such as a Kamelet or Camel endpoint uri where data should be sent to.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--step</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Add optional 1-n steps to the pipe processing. Each step represents a reference to a Kamelet of type action.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--property</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Add a pipe property in the form of <code>[source,sink,error-handler,step-&lt;n&gt;].&lt;key&gt;=&lt;value&gt;</code> where <code>&lt;n&gt;</code> is the step number starting from 1.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--error-handler</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Add error handler (none,log,sink:&lt;endpoint&gt;). Sink endpoints are expected in the format [[apigroup/]version:]kind:[namespace/]name, plain Camel URIs or Kamelet name.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>--output</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Output format generated by this command (supports: file, YAML or JSON). Default is "file".</p></td> </tr> </tbody> </table></div> </div> <div class="sect3"> <h4 id="_binding_explicit_camel_uris"><a class="anchor" href="#_binding_explicit_camel_uris"></a>Binding explicit Camel URIs</h4> <div class="paragraph"> <p>Usually, the source and sink reference a Kamelet by its name as shown in the previous section. As an alternative, you can also just use an arbitrary Camel endpoint URI that acts as a source or sink in the pipe.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel bind joke.yaml --source chuck-norris-source --sink https://mycompany.com/the-service</code></pre> </div> </div> <div class="paragraph"> <p>As a result, the Pipe resource uses the Camel endpoints as source and sink.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: camel.apache.org/v1
kind: Pipe
metadata:
  name: my-pipe
spec:
  source:
# ...
  sink:
    uri: https://mycompany.com/the-service <i class="conum" data-value="1"></i><b>(1)</b></code></pre> </div> </div> <div class="colist arabic"> <div class="table-wrapper"><table> <tr> <td><i class="conum" data-value="1"></i><b>1</b></td> <td>Pipe with explicit Camel endpoint URI as sink where the data gets pushed to</td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_advanced_binding_options"><a class="anchor" href="#_advanced_binding_options"></a>Advanced binding options</h4> <div class="paragraph"> <p>The Camel K JBang plugin also provides the bind command. It enhances the arbitrary bind command with the option to directly create this resource on the Kubernetes cluster. Please refer to the plugin documentation for more complex examples and a full description on how to use the bind command options.</p> </div> </div> </div> <div class="sect2"> <h3 id="_creating_a_new_kamelet"><a class="anchor" href="#_creating_a_new_kamelet"></a>Creating a new Kamelet</h3> <div class="paragraph"> <p>You can create a new kamelet with the <code>init</code> command by using kamelet naming convention.</p> </div> <div class="paragraph"> <p>For example, to create a new kamelet source, you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init cheese-source.kamelet.yaml</code></pre> </div> </div> <div class="paragraph"> <p>This will create a basic kamelet (based on the timer source).</p> </div> <div class="paragraph"> <p>And to use the kamelet, you could create the following route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- from:
    uri: "kamelet:cheese-source"
    parameters:
      period: "2000"
      message: "Hello World"
    steps:
      - log: "${body}"</code></pre> </div> </div> <div class="paragraph"> <p>If you want to create a sink kamelet, then you just name it with sink as follows (based on log sink):</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init wine-sink.kamelet.yaml</code></pre> </div> </div> <div class="paragraph"> <p>You can then change the route to use the wine kamelet as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- from:
    uri: "kamelet:cheese-source"
    parameters:
      period: "2000"
      message: "Hello World"
    steps:
      - to: "kamelet:wine-sink"</code></pre> </div> </div> <div class="paragraph"> <p>If you want to create a new Kamelet based on an existing Kamelet, for example, to create a new sink based on the existing MySQL:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init orderdb-sink.kamelet.yaml --from-kamelet=mysql-sink</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_run_from_clipboard"><a class="anchor" href="#_run_from_clipboard"></a>Run from clipboard</h3> <div class="paragraph"> <p>You can also run Camel routes directly from the OS clipboard. This allows copying some code, and then quickly run this.</p> </div> <div class="paragraph"> <p>The syntax is</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run clipboard.&lt;extension&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Where <code>&lt;extension&gt;</code> is what kind of file the content of the clipboard is, such as <code>java</code>, <code>xml</code>, or <code>yaml</code> etc.</p> </div> <div class="paragraph"> <p>For example, you can copy this to your clipboard and then run it afterward:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route&gt;
  &lt;from uri="timer:foo"/&gt;
  &lt;log message="Hello World"/&gt;
&lt;/route&gt;</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run clipboard.xml</code></pre> </div> </div> <div class="sect3"> <h4 id="_run_and_reload_from_clipboard"><a class="anchor" href="#_run_and_reload_from_clipboard"></a>Run and reload from clipboard</h4> <div class="paragraph"> <p><strong>Available since Camel 4.2</strong></p> </div> <div class="paragraph"> <p>It is also possible to run from clipboard in <em>reload</em> mode as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run clipboard.xml --dev</code></pre> </div> </div> <div class="paragraph"> <p>Then you can quickly make changes and copy to clipboard, and Camel JBang will update while running.</p> </div> </div> </div> <div class="sect2"> <h3 id="_sending_messages_via_camel"><a class="anchor" href="#_sending_messages_via_camel"></a>Sending messages via Camel</h3> <div class="paragraph"> <p><strong>Available since Camel 4</strong></p> </div> <div class="paragraph"> <p>When building integrations with Camel JBang, you may find yourself in need of being able to send messages into Camel, to test your Camel routes. This can be challenging when the Camel routes are connected to external systems using different protocols.</p> </div> <div class="paragraph"> <p>The best approach is to send messages into these external systems using standard tools provided by these systems, which often can be done using CLI tools. However, in some situations, where you may not be familiar with these tools, you can try to let Camel send the message. Note that this can only be possible in some scenarios, and should only be used as a <em>quick way</em>.</p> </div> <div class="paragraph"> <p>Suppose you have a Camel route that consumes messages from an external MQTT broker:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    from:
      uri: kamelet:mqtt5-source
      parameters:
        topic: temperature
        brokerUrl: tcp://mybroker:1883
      steps:
        - transform:
            expression:
              jq:
                expression: .value
        - log:
            message: The temperature is ${body}</code></pre> </div> </div> <div class="paragraph"> <p>In the example above the MQTT broker is running on hostname <code>mybroker</code> port 1883.</p> </div> <div class="paragraph"> <p>The idea with the <code>camel cmd send</code> command is to <em>tap into</em> an existing running Camel integration, and reuse an existing endpoint (if possible). In this example, we want to use the existing configuration to avoid having to configure this again.</p> </div> <div class="paragraph"> <p>By executing the following from a shell</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd send --body=file:payload.json mqtt</code></pre> </div> </div> <div class="paragraph"> <p>We can send a message where the payload is loaded from a file (<code><em>payload.json</em></code>). You can also specify the payload in the CLI argument, but it&#8217;s cumbersome to specify JSON structure so often it&#8217;s better to refer to a local file.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "value": 21
}</code></pre> </div> </div> <div class="paragraph"> <p>The <code>mqtt</code> argument is the name of the existing running Camel integration. You can also specify the PID instead. So what happens is that Camel will let the existing integration send the message.</p> </div> <div class="paragraph"> <p>Because the existing integration only has one route, then the <code>send</code> command will automatically pick the <code><em>from</em></code> endpoint, i.e. <code>kamelet:mqtt5-source</code> with all its configuration. If there are multiple routes, then you can filter which route/endpoint by the <code>--endpoint</code> option:</p> </div> <div class="paragraph"> <p>For example, to pick the first route by <em>route id</em>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd send --body=file:payload.json --endpoint=route1 mqtt</code></pre> </div> </div> <div class="paragraph"> <p>Or to pick the first route that uses mqtt component:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd send --body=file:payload.json --endpoint=mqtt mqtt</code></pre> </div> </div> <div class="paragraph"> <p>We are fortunate in this situation as the endpoint can be used as both a <em>consumer</em> and <em>producer</em> in Camel, and therefore we are able to send the message to the MQTT broker via <code>tcp://mybroker:1883</code> on topic <em>temperate</em>.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See more options with <code>camel cmd send --help</code>. </td> </tr> </table></div> </div> <div class="paragraph"> <p>The source for this example is provided on GitHub at <a href="https://github.com/apache/camel-kamelets-examples/tree/main/jbang/mqtt)">camel-jbang MQTT example</a>.</p> </div> <div class="sect3"> <h4 id="_poll_messages_via_camel"><a class="anchor" href="#_poll_messages_via_camel"></a>Poll messages via Camel</h4> <div class="paragraph"> <p><strong>Available since Camel 4.8</strong></p> </div> <div class="paragraph"> <p>The <code>camel cmd send</code> command has been improved to also <em>poll</em> messages from Camel. This is needed if you want to poll the latest messages from a Kafka topic, JMS queue, or download a file from FTP etc.</p> </div> <div class="paragraph"> <p>The poll uses Camel consumer to poll the message (timeout if no message received) instead of producer.</p> </div> <div class="paragraph"> <p>For example to poll a message from a ActiveMQ queue named cheese you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd send --poll --endpoint='activemq:cheese'</code></pre> </div> </div> <div class="paragraph"> <p>When you poll then you do not send any payload (body or headers).</p> </div> </div> </div> <div class="sect2"> <h3 id="_receiving_messages_via_camel"><a class="anchor" href="#_receiving_messages_via_camel"></a>Receiving messages via Camel</h3> <div class="paragraph"> <p><strong>Available since Camel 4.9</strong></p> </div> <div class="paragraph"> <p>When building a prototype integration with Camel JBang, you may route messages to external systems. To know whether messages are being routed correctly, you may use system consoles to look inside these systems which messages have arrived, such as SQL prompts, web consoles, CLI tools etc.</p> </div> <div class="paragraph"> <p>The Camel JBang now comes with a new command to receive messages from remote endpoints. This can be used to quickly look or tail in terminal the messages that an external systems has received. Camel does this by consuming the messages (if the component has support for consumer) and then let Camel JBang dump the messages from the CLI.</p> </div> <div class="paragraph"> <p>For example to start dumping all messages from ActiveMQ in one command, you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd receive --endpoint='activemq:cheese'</code></pre> </div> </div> <div class="paragraph"> <p>You can also use pattern syntax for the endpoint, so suppose you have the following route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("ftp:myserver:1234/foo")
  .to("log:order")
  .to("activemq:orders");</code></pre> </div> </div> <div class="paragraph"> <p>Then you can tell Camel to automatic start receiving messages with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd receive --action=start</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can enable and disable this mode with <code>--action=start</code> and <code>--action-stop</code>. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Then Camel will automatically discover from the running integration, all the <em>producers</em> and find the first <em>producer</em> that is remote and also has consumer support. In the example above, that is the <code>activemq</code> component, and thus Camel will start receive from <code>activemq:orders</code>.</p> </div> <div class="paragraph"> <p>You can see the status via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd receive
 PID   NAME   AGE   STATUS    TOTAL  SINCE  ENDPOINT
  4364  foo   1m33s  Enabled     18     2s  activemq://orders</code></pre> </div> </div> <div class="paragraph"> <p>You can then dump all the received messages with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel cmd receive --action=dump</code></pre> </div> </div> <div class="paragraph"> <p>This will dump all the messages, and continue to dump new incoming messages. Use (ctrl + c) to break and exit. You can turn follow off with <code>--follow=false</code>.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Use <code>camel cmd receive --help</code> to see all the various options for this command. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_controlling_local_camel_integrations"><a class="anchor" href="#_controlling_local_camel_integrations"></a>Controlling local Camel integrations</h3> <div class="paragraph"> <p>To list the currently running Camel integrations, you use the <code>ps</code> command:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel ps
  PID   NAME                             READY  STATUS    AGE
 61818  sample.camel.MyCamelApplica...   1/1   Running  26m38s
 62506  dude                             1/1   Running   4m34s</code></pre> </div> </div> <div class="paragraph"> <p>This lists the PID, the name and age of the integration.</p> </div> <div class="paragraph"> <p>You can use the <code>stop</code> command to stop any of these running Camel integrations. For example, to stop dude, you can do</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel stop dude
Stopping running Camel integration (pid: 62506)</code></pre> </div> </div> <div class="paragraph"> <p>You can also stop by the PID:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel stop 62506
Stopping running Camel integration (pid: 62506)</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You do not have to type the full name, as the stop command will match using integrations that start with the input, for example, you can do <code>camel stop d</code> to stop all integrations starting with d. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To stop all integrations, then execute without any pid:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel stop
Stopping running Camel integration (pid: 61818)
Stopping running Camel integration (pid: 62506)</code></pre> </div> </div> <div class="sect3"> <h4 id="_watching_local_camel_integrations"><a class="anchor" href="#_watching_local_camel_integrations"></a>Watching local Camel integrations</h4> <div class="paragraph"> <p>Most of the management commands can run in <em>watch</em> mode, which repetitively output the status in full-screen mode. This is done using the <code>--watch</code> parameter as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel ps --watch
  PID   NAME                             READY  STATUS    AGE
 61818  sample.camel.MyCamelApplica...   1/1   Running  26m38s
 62506  dude                             1/1   Running   4m34s</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_controlling_spring_boot_and_quarkus_integrations"><a class="anchor" href="#_controlling_spring_boot_and_quarkus_integrations"></a>Controlling Spring Boot and Quarkus integrations</h4> <div class="paragraph"> <p>The Camel JBang CLI will by default only control Camel integrations that are running using the CLI, eg <code>camel run foo.java</code>.</p> </div> <div class="paragraph"> <p>For the CLI to be able to control and manage Spring Boot or Quarkus applications, then you need to add a dependency to these projects to integrate with Camel CLI.</p> </div> <div class="paragraph"> <p>In Spring Boot, you add the following dependency:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;
    &lt;artifactId&gt;camel-cli-connector-starter&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>In Quarkus, you need to add the following dependency:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;camel-quarkus-cli-connector&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_getting_status_of_camel_integrations"><a class="anchor" href="#_getting_status_of_camel_integrations"></a>Getting status of Camel integrations</h4> <div class="paragraph"> <p>The <code>get</code> command in Camel JBang is used for getting Camel specific status for one or all of the running Camel integrations.</p> </div> <div class="paragraph"> <p>To display the status of the running Camel integrations:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get
  PID   NAME      CAMEL   PLATFORM            READY  STATUS    AGE    TOTAL  FAILED  INFLIGHT  SINCE-LAST
 61818  MyCamel   3.20.0  Spring Boot v2.7.3   1/1   Running  28m34s    854       0         0     0s/0s/-
 63051  dude      3.20.0  JBang                1/1   Running     18s     14       0         0     0s/0s/-
 63068  mygroovy  3.20.0  JBang                1/1   Running      5s      2       0         0     0s/0s/-</code></pre> </div> </div> <div class="paragraph"> <p>The <code>camel get</code> command will default display Camel application (context), which is equivalent to typing <code>camel get context</code>.</p> </div> <div class="paragraph"> <p>This displays overall information for every Camel integration, where you can see the total number of messages processed. The column <em>Since Last</em> shows how long time ago the last processed message for 3 stages (started/completed/failed).</p> </div> <div class="paragraph"> <p>The value of <code>0s/0s/-</code> means that the last started and completed message just happened (0 seconds ago), and that there has not been any failed message yet. And this example <code>9s/9s/1h3m</code> means that last started and completed message is 9 seconds ago, and last failed were 1 hour and 3 minutes ago.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can run in <em>watch</em> mode using: <code>camel get --watch</code> </td> </tr> </table></div> </div> <div class="sect4"> <h5 id="_total_in_camel_4_7_and_4_8"><a class="anchor" href="#_total_in_camel_4_7_and_4_8"></a>Total in Camel 4.7 and 4.8</h5> <div class="paragraph"> <p>From <strong>Camel 4.7</strong> onwards, two numbers will be displayed for <em>TOTAL</em>, <em>FAILED</em>, and <em>INFLIGHT</em> columns. The first number is messages received from external systems (databases, cloud systems), and the second number is the total number (as in earlier versions).</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get
  PID   NAME    CAMEL  PLATFORM        PROFILE  READY  STATUS   RELOAD  AGE   ROUTE  MSG/S  TOTAL  FAIL  INFLIGHT  LAST  DELTA  SINCE-LAST
 42240  cheese  4.7.0  JBang v0.116.0  dev       1/1   Running       0  1m8s    2/2   1.01   1/65   0/0       0/0     0     -1     1s/1s/-</code></pre> </div> </div> <div class="paragraph"> <p>The <em>TOTAL</em> column above shows <code>1/65</code> which mean that 1 message was from an external source, and 65 in total; which means that 64 are from internal sources (such as timer, seda).</p> </div> </div> <div class="sect4"> <h5 id="_total_in_camel_4_9_onwards"><a class="anchor" href="#_total_in_camel_4_9_onwards"></a>Total in Camel 4.9 onwards</h5> <div class="paragraph"> <p>The TOTAL column is total number of messages processed. This is all messages both started internally (such as from a timer) and received from external systems (databases, cloud systems). In <strong>Camel 4.9</strong> we made the TOTAL column a single digit again to not confuse, and we added a new <code>REMOTE</code> column to show total for remote systems only. So the example above would be:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get
  PID   NAME    CAMEL  PLATFORM        PROFILE  READY  STATUS   RELOAD  AGE   ROUTE  MSG/S  TOTAL  REMOTE  FAIL  INFLIGHT  LAST  DELTA  SINCE-LAST
 42240  cheese  4.9.0  JBang v0.118.0  dev       1/1   Running       0  1m8s    2/2   1.01     65       1   0/0       0/0     0     -1     1s/1s/-</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="_route_status"><a class="anchor" href="#_route_status"></a>Route status</h4> <div class="paragraph"> <p>You can also see the status of every route, from all the local Camel integrations with <code>camel get route</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get route
  PID   NAME      ID      FROM                        STATUS    AGE   TOTAL  FAILED  INFLIGHT  MEAN  MIN  MAX  SINCE-LAST
 61818  MyCamel   hello   timer://hello?period=2000   Running  29m2s    870       0         0     0    0   14     0s/0s/-
 63051  dude      java    timer://java?period=1000    Running    46s     46       0         0     0    0    9     0s/0s/-
 63068  mygroovy  groovy  timer://groovy?period=1000  Running    34s     34       0         0     0    0    5     0s/0s/-</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Use <code>camel get --help</code> to display all the available commands as additional will be added in upcoming releases. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_top_status_of_camel_integrations"><a class="anchor" href="#_top_status_of_camel_integrations"></a>Top status of Camel integrations</h4> <div class="paragraph"> <p>The <code>camel top</code> command is intended for getting top utilization statistics (highest to lowest heap used memory) of the running Camel integrations.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel top
  PID   NAME     JAVA     CAMEL   PLATFORM            STATUS    AGE         HEAP        NON-HEAP     GC     THREADS   CLASSES
 22104  chuck    11.0.13  3.20.0  JBang               Running   2m10s  131/322/4294 MB  70/73 MB  17ms (6)      7/8  7456/7456
 14242  MyCamel  11.0.13  3.20.0  Spring Boot v2.7.3  Running  33m40s  115/332/4294 MB  62/66 MB  37ms (6)    16/16  8428/8428
 22116  bar      11.0.13  3.20.0  JBang               Running    2m7s   33/268/4294 MB  54/58 MB  20ms (4)      7/8  6104/6104</code></pre> </div> </div> <div class="paragraph"> <p>The <em>HEAP</em> column shows the heap memory (used/committed/max) and the non-heap (used/committed). The <em>GC</em> column shows garbage collection information (time and total runs). The <em>CLASSES</em> column shows the number of classes (loaded/total).</p> </div> <div class="paragraph"> <p>You can also see the top performing routes (highest to lowest mean processing time) of every route, from all the local Camel integrations with <code>camel top route</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel top route
  PID   NAME     ID                     FROM                                 STATUS    AGE    TOTAL  FAILED  INFLIGHT  MEAN  MIN  MAX  SINCE-LAST
 22104  chuck    chuck-norris-source-1  timer://chuck?period=10000           Started     10s      1       0         0   163  163  163          9s
 22116  bar      route1                 timer://yaml2?period=1000            Started      7s      7       0         0     1    0   11          0s
 22104  chuck    chuck                  kamelet://chuck-norris-source        Started     10s      1       0         0     0    0    0          9s
 22104  chuck    log-sink-2             kamelet://source?routeId=log-sink-2  Started     10s      1       0         0     0    0    0          9s
 14242  MyCamel  hello                  timer://hello?period=2000            Started  31m41s    948       0         0     0    0    4          0s</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Use <code>camel top --help</code> to display all the available commands as additional will be added in upcoming releases. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_tailing_logs"><a class="anchor" href="#_tailing_logs"></a>Tailing logs</h4> <div class="paragraph"> <p>When you run Camel integrations, then they will by default run in the foreground and output logs.</p> </div> <div class="paragraph"> <p>You can from another terminal access the logs from any Camel integration with the <code>log</code> command, as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel log chuck
chuck     | 2023-01-04 17:59:19.288  INFO 44619 --- [           main] org.apache.camel.main.MainSupport   : Apache Camel (JBang) 3.21.0 is starting
chuck     | 2023-01-04 17:59:19.395  INFO 44619 --- [           main] org.apache.camel.main.MainSupport   : Using Java 17.0.5 with PID 44619. Started by davsclaus in /Users/davsclaus/workspace/
...</code></pre> </div> </div> <div class="paragraph"> <p>You can also watch logs for all Camel integrations by <code>camel log</code>, or you can specify by name/pids (separate by comma) <code>camel log bar,chuck</code>.</p> </div> <div class="paragraph"> <p>It is also possible to find and highlight keywords from the log using <code>--find</code>, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel log chuck --find=invoice</code></pre> </div> </div> <div class="paragraph"> <p>You can find multiple items by repeating the option, i.e.:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel log chuck --find=invoice --find=order</code></pre> </div> </div> <div class="paragraph"> <p>There is also a <em>grep</em> option that will filter the logs to only show lines that matches text (ignore case).</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel log chuck --grep=error</code></pre> </div> </div> <div class="paragraph"> <p>The log command will by default tail the logs for new lines. If you want to exit the command immediately, you can turn off the following as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel log chuck --grep=error --follow=false</code></pre> </div> </div> <div class="paragraph"> <p>This will grep the logs for log lines with matches text <code>error</code> and output only these logs, and exit.</p> </div> </div> <div class="sect3"> <h4 id="_tracing_messages"><a class="anchor" href="#_tracing_messages"></a>Tracing messages</h4> <div class="paragraph"> <p>The <code>trace</code> command is used for showing how messages are routed in Camel. The command has similar output as the <code>log</code> command but only display message tracing information. This allows you to see every <em>step</em> a message is routed in Camel.</p> </div> <div class="paragraph"> <p>The <code>trace</code> command has many options and can be used to <em>filter</em>, <em>grep</em> or output on different detail <em>levels`. The _exchange id</em> is logged (and grouped by colour), so you can use that to correlate the events when traces are interleaved.</p> </div> <div class="paragraph"> <p>The trace command will by default list the status of whether tracing is enabled or not in the integrations:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel trace
 PID   NAME   AGE  STATUS   TOTAL  QUEUE  FILTER  PATTERN
 6911  chuck   5s  Standby      0      0</code></pre> </div> </div> <div class="paragraph"> <p>Here we can see that the tracer is in standby mode, and you need to start the tracer before Camel will capture messages:</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Camel 4.8 onwards has tracing in standby mode (when using dev profile). You can enable tracing on startup by setting the configuration <code>camel.trace.enabled=true</code> in <code>application.properties</code>. </td> </tr> </table></div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel trace --action=start</code></pre> </div> </div> <div class="paragraph"> <p>And if you run <code>camel trace</code> again you can see the tracer is started:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel trace
PID   NAME   AGE   STATUS   TOTAL  QUEUE  FILTER  PATTERN
6911  chuck  1m5s  Started     16      4</code></pre> </div> </div> <div class="paragraph"> <p>And to show the traces you need to use the <code>dump</code> action as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel trace chuck --action=dump</code></pre> </div> </div> <div class="paragraph"> <p>You can also dump traces from all running integrations:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel trace --action=dump</code></pre> </div> </div> <div class="paragraph"> <p>To stop tracing use <code>--action=stop</code>.</p> </div> <div class="paragraph"> <p>And you can also clear the already traced messages with <code>--action=clear</code>.</p> </div> </div> <div class="sect3"> <h4 id="_running_camel_integrations_in_background"><a class="anchor" href="#_running_camel_integrations_in_background"></a>Running Camel integrations in background</h4> <div class="paragraph"> <p>The <code>run</code> command allows running Camel in the background with the <code>--background</code> option. Therefore, to see and understand what happens then the management commands cane be used, such as <code>camel ps</code>, <code>camel get</code>, and <code>camel log</code>.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel run chuck.yaml --background
Running Camel integration: chuck in background with PID: 80093

$ camel ps
  PID   NAME    READY  STATUS   AGE
 80093  chuck    1/1   Running  33s</code></pre> </div> </div> <div class="paragraph"> <p>To see the log use <code>camel log</code></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel log
chuck     | 2023-01-04 17:59:19.288  INFO 44619 --- [           main] org.apache.camel.main.MainSupport   : Apache Camel (JBang) 3.21.0 is starting
chuck     | 2023-01-04 17:59:19.395  INFO 44619 --- [           main] org.apache.camel.main.MainSupport   : Using Java 17.0.5 with PID 44619. Started by davsclaus in /Users/davsclaus/workspace/
...</code></pre> </div> </div> <div class="paragraph"> <p>To stop the integration you can use <code>camel stop</code></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel stop chuck
Shutting down Camel integration (pid: 80093)</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_starting_and_stopping_routes"><a class="anchor" href="#_starting_and_stopping_routes"></a>Starting and Stopping routes</h4> <div class="paragraph"> <p>The <code>camel cmd</code> is intended for executing miscellaneous commands in the running Camel integrations. For example, there are commands to start and stop routes.</p> </div> <div class="paragraph"> <p>To stop all the routes in the chuck integration, you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd stop-route chuck</code></pre> </div> </div> <div class="paragraph"> <p>And the status will then report the status as <em>Stopped</em> for the chuck integration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get route
  PID   NAME     ID                     FROM                                 STATUS    AGE   TOTAL  FAILED  INFLIGHT  MEAN  MIN  MAX  SINCE-LAST
 81663  chuck    chuck                  kamelet://chuck-norris-source        Stopped           600       0         0     0    0    1          4s
 81663  chuck    chuck-norris-source-1  timer://chuck?period=10000           Stopped           600       0         0    65   52  290          4s
 81663  chuck    log-sink-2             kamelet://source?routeId=log-sink-2  Stopped           600       0         0     0    0    1          4s
 83415  bar      route1                 timer://yaml2?period=1000            Started  5m30s    329       0         0     0    0   10          0s
 83695  MyCamel  hello                  timer://hello?period=2000            Started  3m52s    116       0         0     0    0    9          1s</code></pre> </div> </div> <div class="paragraph"> <p>To start the routes, you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd start-route chuck</code></pre> </div> </div> <div class="paragraph"> <p>To stop <em>all</em> routes in every Camel integration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd stop-route</code></pre> </div> </div> <div class="paragraph"> <p>And you can start <em>all</em> routes using:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd start-route</code></pre> </div> </div> <div class="paragraph"> <p>To start a specific route, you need to use <code>--id</code> parameter such as the following, which will start routes named <code>route1</code> in all running integrations:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd start-route --id=route1</code></pre> </div> </div> <div class="paragraph"> <p>If you want to do this in a specific integration, you must include the name or pid:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd start-route bar --id=route1</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can stop one or more route by their ids by separating using comma such as <code>camel cmd start-route --id=route1,hello</code>. Use <code>camel cmd start-route --help</code> for more details. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_running_camel_integrations_on_kubernetes"><a class="anchor" href="#_running_camel_integrations_on_kubernetes"></a>Running Camel integrations on Kubernetes</h4> <div class="paragraph"> <p>After developing the Camel routes locally with JBang, you may want to run these also on the Kubernetes platform at some point.</p> </div> <div class="paragraph"> <p>Camel JBang provides a plugin for managing and easily running Camel applications on Kubernetes. The plugin uses the project export functionality to build and deploy the application on Kubernetes with Quarkus or SpringBoot.</p> </div> <div class="paragraph"> <p>Read about it in the <a href="camel-jbang-kubernetes.html" class="xref page">Camel Kubernetes plugin</a> documentation.</p> </div> <div class="paragraph"> <p>In addition to that, you can also leverage the Camel K plugin commands that interact with the Camel K operator on Kubernetes. Camel K gets you started with the journey of running Camel integrations on Kubernetes in a declarative way. The container image build, push to registry as well as the ownership of deployments is all taken care of by the Camel K operator.</p> </div> <div class="paragraph"> <p>Read about it in <a href="camel-jbang-k.html" class="xref page">Camel K plugin</a>.</p> </div> </div> <div class="sect3"> <h4 id="_configuring_logging_levels"><a class="anchor" href="#_configuring_logging_levels"></a>Configuring logging levels</h4> <div class="paragraph"> <p>You can see the current logging levels of the running Camel integrations by:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd logger
  PID   NAME   AGE   LOGGER  LEVEL
 90857  bar   2m48s  root    INFO
 91103  foo     20s  root    INFO</code></pre> </div> </div> <div class="paragraph"> <p>The logging level can be changed at runtime, for example, to change foo to DEBUG you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel cmd logger --logging-level=DEBUG foo</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can use <code>--all</code> to change logging levels for all running integrations. </td> </tr> </table></div> </div> <div class="sect4"> <h5 id="_configuring_individual_logging_levels"><a class="anchor" href="#_configuring_individual_logging_levels"></a>Configuring individual logging levels</h5> <div class="paragraph"> <p>From <strong>Camel 4.6</strong> onwards you can easily configure different logging levels from CLI and <code>application.properties</code>.</p> </div> <div class="paragraph"> <p>For example from CLI, you can specify using the <code>--logging-category</code> option. For example, to enable DEBUG logging if using Kafka:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel run myapp.yaml --logging-category=org.apache.kafka=DEBUG</code></pre> </div> </div> <div class="paragraph"> <p>You can specify multiple categories by repeating the CLI option as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel run myapp.yaml --logging-category=org.apache.kafka=DEBUG --logging-category=com.foo.something=TRACE</code></pre> </div> </div> <div class="paragraph"> <p>You can also configure logging levels in <code>application.properties</code> using two styles</p> </div> <div class="ulist"> <ul> <li> <p><code>logging.level.</code> it is the default style used by Camel and Spring Boot</p> </li> <li> <p><code>quarkus.log.category.</code> is used by Quarkus</p> </li> </ul> </div> <div class="paragraph"> <p>For example, you can declare as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># make it easy to configure individual logging levels
logging.level.org.apache.kafka = DEBUG
logging.level.com.foo.something = TRACE

# you can also use quarkus style naming
quarkus.log.category."org.apache.kafka".level = DEBUG
quarkus.log.category."com.foo.something".level = TRACE</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="_listing_services"><a class="anchor" href="#_listing_services"></a>Listing services</h4> <div class="paragraph"> <p>Some Camel integrations may host a service which clients can call, such as REST, or SOAP-WS, or socket-level services using TCP protocols.</p> </div> <div class="paragraph"> <p>You can list the available services as shown in the example below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get service
 PID   NAME       COMPONENT      PROTOCOL  SERVICE
 1912  netty      netty          tcp       tcp:localhost:4444
 2023  greetings  platform-http  rest      http://0.0.0.0:7777/camel/greetings/{name} (GET)
 2023  greetings  platform-http  http      http://0.0.0.0:7777/q/dev</code></pre> </div> </div> <div class="paragraph"> <p>Here you can see 2 Camel integrations. The netty integration hosts a TCP service that is available on port 4444. The other Camel integration hosts a REST service that can be called via GET only. And finally the integration comes with embedded web console (started with the <code>--console</code> option).</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> For a service to be listed then Camel components must be able to advertise the services using <a href="camel-console.html" class="xref page">Camel Console</a>. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_observability_with_metrics"><a class="anchor" href="#_observability_with_metrics"></a>Observability with metrics</h4> <div class="paragraph"> <p>Camel JBang comes with support for using Micrometer for metrics that easily can be made available.</p> </div> <div class="paragraph"> <p>You simply either run with <code>--metrics</code> option, or enable and have more control of the configuration in the <code>application.properties</code> file as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># enable HTTP server with metrics
camel.server.enabled=true
camel.server.metricsEnabled=true

# turn on micrometer metrics
camel.metrics.enabled=true
# include more camel details
camel.metrics.enableMessageHistory=true
# include additional out-of-the-box micrometer metrics for cpu, jvm and used file descriptors
camel.metrics.binders=processor,jvm-info,file-descriptor</code></pre> </div> </div> <div class="paragraph"> <p>Then you can access metrics from the web browser at: <a href="http://localhost:8080/q/metrics">http://localhost:8080/q/metrics</a></p> </div> <div class="paragraph"> <p>You can also see metrics from the CLI as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel get metric
  PID   NAME         TYPE   METRIC                         ROUTE                  VALUE  MEAN  MAX  TOTAL
 11562  MyCoolCamel  timer  camel.exchange.event.notifier                             3    12   27     35
 11562  MyCoolCamel  timer  camel.exchange.event.notifier                             3     1    2      3
 11562  MyCoolCamel  gauge  camel.routes.added                                        3
 11562  MyCoolCamel  gauge  camel.routes.running                                      3
 11562  MyCoolCamel  gauge  jvm.info                                                  1
 11562  MyCoolCamel  gauge  process.cpu.usage                     0.0045185067010171795
 11562  MyCoolCamel  gauge  process.files.max                                     10240
 11562  MyCoolCamel  gauge  process.files.open                                      288
 11562  MyCoolCamel  gauge  system.cpu.count                                          8
 11562  MyCoolCamel  gauge  system.cpu.usage                        0.15222772277227722
 11562  MyCoolCamel  gauge  system.load.average.1m                        3.58935546875</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_listing_state_of_circuit_breakers"><a class="anchor" href="#_listing_state_of_circuit_breakers"></a>Listing state of Circuit Breakers</h4> <div class="paragraph"> <p>If your Camel integration uses <a href="../components/4.8.x/eips/circuitBreaker-eip.html" class="xref page">Circuit Breaker</a>, then you can output the status of the breakers with Camel JBang as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get circuit-breaker
  PID   NAME  COMPONENT     ROUTE   ID               STATE      PENDING  SUCCESS  FAIL  REJECT
 56033  mycb  resilience4j  route1  circuitBreaker1  HALF_OPEN        5        2     3       0</code></pre> </div> </div> <div class="paragraph"> <p>Here we can see the circuit breaker is in <em>half-open</em> state, i.e., a state where the breaker is attempting to transition back to closed if the failures start to drop.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can run the command with watch to keep showing the latest state <code>watch camel get circuit-breaker</code>. </td> </tr> </table></div> </div> </div> </div> <div class="sect2"> <h3 id="_using_jolokia_and_hawtio"><a class="anchor" href="#_using_jolokia_and_hawtio"></a>Using Jolokia and Hawtio</h3> <div class="paragraph"> <p>The <a href="https://hawt.io/">Hawtio</a> web console allows inspecting running Camel integrations, such as all the JMX management information, and not but least to visualize the Camel routes with live performance metrics. Hawtio is a handy tool for many years, and we have made it easy to use Hawtio with Camel JBang.</p> </div> <div class="paragraph"> <p>To let Hawtio able to inspect the Camel integrations, then the Jolokia JVM Agent must be installed in the running integration, this can be done, either explicit as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel ps
  PID   NAME                             READY  STATUS    AGE
 61818  sample.camel.MyCamelApplica...   1/1   Running  26m38s
 62506  dude.java                        1/1   Running   4m34s</code></pre> </div> </div> <div class="paragraph"> <p>With the PID you can then attach Jolokia:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel jolokia 62506
Started Jolokia for PID 62506
http://127.0.0.1:8778/jolokia/</code></pre> </div> </div> <div class="paragraph"> <p>Instead of using PID, you can also attach by name pattern. In this example, because the two Camel integrations have unique names (foo and dude), then you can also attach Jolokia without knowing the PID as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel jolokia du
Started Jolokia for PID 62506
http://127.0.0.1:8778/jolokia/</code></pre> </div> </div> <div class="paragraph"> <p>Then you can launch <a href="https://hawt.io/">Hawtio</a> using Camel JBang:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel hawtio</code></pre> </div> </div> <div class="paragraph"> <p>This will automatically download and start Hawtio, and open in web browser.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See <code>camel hawtio --help</code> for options. </td> </tr> </table></div> </div> <div class="paragraph"> <p>And when Hawtio launches in the web browser, click the <em>Discover</em> tab which should list all the local available Jolokia Agents (yes you can use <code>camel jolokia PID</code> to connect to multiple different Camel integrations and from this list select which to load).</p> </div> <div class="paragraph"> <p>Click the green <em>lightning</em> icon to connect to running Camel integration (of choice).</p> </div> <div class="paragraph"> <p>You can uninstall the Jolokia JVM Agent in a running Camel integration when no longer needed:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel jolokia 62506 --stop
Stopped Jolokia for PID 62506</code></pre> </div> </div> <div class="paragraph"> <p>It is also possible to do this with only one command, as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel hawtio dude</code></pre> </div> </div> <div class="paragraph"> <p>Where <em>dude</em> is the name of the running Camel integration. When you stop Hawtio (using <code>ctrl</code> + <code>c</code>) then Camel will attempt to uninstall the Jolokia JVM Agent. However, this may not be able to do this always, because the JVM is being terminated which can prevent camel-jbang from doing JVM process communication to the running Camel integration.</p> </div> </div> <div class="sect2"> <h3 id="_scripting_from_terminal_using_pipes"><a class="anchor" href="#_scripting_from_terminal_using_pipes"></a>Scripting from terminal using pipes</h3> <div class="paragraph"> <p>You can also execute a Camel JBang file as a script that can be used for terminal scripting with pipes and filters.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Every time the script is executed, a JVM is started with Camel. This is not very fast or low on memory usage, so use Camel JBang terminal scripting where using Camel makes sense. For example, to use many Camel components or Kamelets, to more easily send or receive data from disparate IT systems. </td> </tr> </table></div> </div> <div class="paragraph"> <p>This requires adding the following line in top of the file, for example, as in the <code>upper.yaml</code> file below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">///usr/bin/env jbang --quiet camel@apache/camel pipe "$0" "$@" ; exit $?

# Will upper-case the input
- from:
    uri: "stream:in"
    steps:
      - setBody:
          simple: "${body.toUpperCase()}"
      - to: "stream:out"</code></pre> </div> </div> <div class="paragraph"> <p>To be able to execute this as a script, you need to set execute file permission:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">chmod +x upper.yaml</code></pre> </div> </div> <div class="paragraph"> <p>Then you can then execute this as a script:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "Hello\nWorld" | ./upper.yaml</code></pre> </div> </div> <div class="paragraph"> <p>Which should output:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">HELLO
WORLD</code></pre> </div> </div> <div class="paragraph"> <p>Logging can be turned on using <code>--logging=true</code> which then logs to <code>.camel-jbang/camel-pipe.log</code> file. The name of the logging file cannot be configured.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">echo "Hello\nWorld" | ./upper.yaml --logging=true</code></pre> </div> </div> <div class="sect3"> <h4 id="_using_streamin_with_line_vs_raw_mode"><a class="anchor" href="#_using_streamin_with_line_vs_raw_mode"></a>Using stream:in with line vs. raw mode</h4> <div class="paragraph"> <p>When using <code>stream:in</code> to read data from <em>System in</em> then the <a href="../components/4.8.x/stream-component.html" class="xref page">Stream component</a> works in two modes:</p> </div> <div class="ulist"> <ul> <li> <p>line mode (default): reads input as single lines (separated by line breaks). Message body is a <code>String</code>.</p> </li> <li> <p>raw mode: reads the entire stream until the <em>end of stream</em>. Message body is a <code>byte[]</code>.</p> </li> </ul> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> The default mode is due to historically how the stream component was created. Therefore, you may want to set <code>stream:in?readLine=false</code> to use raw mode. </td> </tr> </table></div> </div> </div> </div> <div class="sect2"> <h3 id="_running_local_kamelets"><a class="anchor" href="#_running_local_kamelets"></a>Running local Kamelets</h3> <div class="paragraph"> <p>You can also use Camel JBang to try local Kamelets, without the need to publish them on GitHub or package them in a jar.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --local-kamelet-dir=/path/to/local/kamelets earthquake.yaml</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> When the kamelets are from local file system, then they can be live reloaded if they are updated, when you run Camel JBang in <code>--dev</code> mode. </td> </tr> </table></div> </div> <div class="paragraph"> <p>You can also point to a folder in a GitHub repository. For example, we have provided some custom Kamelets at <a href="https://github.com/apache/camel-kamelets-examples/tree/main/custom-kamelets" class="bare">https://github.com/apache/camel-kamelets-examples/tree/main/custom-kamelets</a>, which can be used easily:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run --local-kamelet-dir=https://github.com/apache/camel-kamelets-examples/tree/main/custom-kamelets user.java</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> If a kamelet is loaded from GitHub, then they cannot be live reloaded. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_using_the_platform_http_component"><a class="anchor" href="#_using_the_platform_http_component"></a>Using the platform-http component</h3> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Camel JBang is only intended for working with <code>platform-http</code> as HTTP server component for rest-dsl, and for HTTP serer in general. It is not intended to work with <code>camel-servlet</code> or <code>camel-jetty</code>. If you find a need for using Jetty, then Camel JBang will not support seamless rest-dsl support and exporting. </td> </tr> </table></div> </div> <div class="paragraph"> <p>When a route is started from <code>platform-http</code> then Camel JBang will automatically include a VertX HTTP server running on port 8080. For example, the following route in a file named <code>server.yaml</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- from:
    uri: "platform-http:/hello"
    steps:
      - set-body:
          constant: "Hello World"</code></pre> </div> </div> <div class="paragraph"> <p>Can be run with</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run server.yaml</code></pre> </div> </div> <div class="paragraph"> <p>And you can call the HTTP service with:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl http://localhost:8080/hello
Hello World%</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_using_java_beans_and_processors"><a class="anchor" href="#_using_java_beans_and_processors"></a>Using Java beans and processors</h3> <div class="paragraph"> <p>There is basic support for including regular Java source files together with Camel routes, and let Camel JBang runtime compile the Java source. This means you can include smaller utility classes, POJOs, Camel Processors and whatnot that the application needs.</p> </div> </div> <div class="sect2"> <h3 id="_dependency_injection_in_java_classes"><a class="anchor" href="#_dependency_injection_in_java_classes"></a>Dependency Injection in Java classes</h3> <div class="paragraph"> <p>When running Camel integrations with camel-jbang, then the runtime is <code>camel-main</code> based. This means there is no Spring Boot or Quarkus available. However, we have added support for using annotation-based dependency injection in Java classes.</p> </div> <div class="sect3"> <h4 id="_using_camel_dependency_injection"><a class="anchor" href="#_using_camel_dependency_injection"></a>Using Camel dependency injection</h4> <div class="paragraph"> <p>You can use the following Camel annotations on Camel standalone:</p> </div> <div class="ulist"> <ul> <li> <p><code>@org.apache.camel.BindToRegistry</code> on class level (for custom beans, processors, etc.) to create an instance of the class and register in the <a href="registry.html" class="xref page">Registry</a>.</p> </li> <li> <p><code>@org.apache.camel.Configuration</code> on class level for <code>CamelConfiguation</code> classes, which is used during Camel startup (only Camel Main runtime) to allow custom setup that requires some coding.</p> </li> </ul> </div> <div class="paragraph"> <p>And these annotations should work on all runtimes (if target runtime is either Quarkus or Spring Boot then favour using their annotations):</p> </div> <div class="ulist"> <ul> <li> <p><code>@org.apache.camel.BeanInject</code> to dependency inject a bean on a class field.</p> </li> <li> <p><code>@org.apache.camel.PropertyInject</code> to inject a <a href="using-propertyplaceholder.html" class="xref page">property placeholder</a>. Such as a property defined in <code>application.properties</code>.</p> </li> <li> <p><code>@org.apache.camel.BindToRegistry</code> on a method to create a bean by invoking the method.</p> </li> <li> <p><code>@org.apache.camel.Converter</code> on class level to auto-register the <a href="type-converter.html" class="xref page">type converters</a> from the class.</p> </li> </ul> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> You can use <code>@BeanInject</code> annotation to refer to existing bean annotated with <code>@BindToRegistry</code>, however, this is possible if the dependency is registered before the dependant. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_using_spring_boot_dependency_injection"><a class="anchor" href="#_using_spring_boot_dependency_injection"></a>Using Spring Boot dependency injection</h4> <div class="paragraph"> <p>You can use the following Spring Boot annotations:</p> </div> <div class="ulist"> <ul> <li> <p><code>@org.springframework.stereotype.Component</code> or <code>@org.springframework.stereotype.Service</code> on class level to create an instance of the class and register in the <a href="registry.html" class="xref page">Registry</a>.</p> </li> <li> <p><code>@org.springframework.beans.factory.annotation.Autowired</code> to dependency inject a bean on a class field. <code>@org.springframework.beans.factory.annotation.Qualifier</code> can be used to specify the bean id.</p> </li> <li> <p><code>@org.springframework.beans.factory.annotation.Value</code> to inject a <a href="using-propertyplaceholder.html" class="xref page">property placeholder</a>. Such as a property defined in <code>application.properties</code>.</p> </li> <li> <p><code>@org.springframework.context.annotation.Bean</code> on a method to create a bean by invoking the method.</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_using_quarkus_injection"><a class="anchor" href="#_using_quarkus_injection"></a>Using Quarkus injection</h4> <div class="paragraph"> <p>You can use the following Quarkus annotations:</p> </div> <div class="ulist"> <ul> <li> <p><code>@javax.enterprise.context.ApplicationScoped</code> or <code>@javax.inject.Singleton</code> on class level to create an instance of the class and register in the <a href="registry.html" class="xref page">Registry</a>. <code>@javax.inject.Named</code> can be used to specify the bean id.</p> </li> <li> <p><code>@javax.inject.Inject</code> to dependency inject a bean on a class field. <code>@javax.inject.Named</code> can be used to specify the bean id.</p> </li> <li> <p><code>@org.eclipse.microprofile.config.inject.ConfigProperty</code> to inject a <a href="using-propertyplaceholder.html" class="xref page">property placeholder</a>. Such as a property defined in <code>application.properties</code>.</p> </li> <li> <p><code>@javax.enterprise.inject.Produces</code> on a method to create a bean by invoking the method. <code>@javax.inject.Named</code> can be used to specify the bean id.</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="_using_beans_in_camel_xml_dsl"><a class="anchor" href="#_using_beans_in_camel_xml_dsl"></a>Using beans in Camel XML DSL</h4> <div class="paragraph"> <p>Since Camel <strong>4.0.0</strong>, when using <a href="../components/4.8.x/others/java-xml-io-dsl.html" class="xref page">XML DSL</a>, we can declare additional beans in a similar way as in <a href="../components/4.8.x/others/yaml-dsl.html" class="xref page">YAML DSL</a>. Such beans will be added to the <a href="registry.html" class="xref page">Registry</a> and can be referred to, for example, from routes.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camel&gt;

	&lt;bean name="beanFromMap" type="com.acme.MyBean"&gt;
		&lt;properties&gt;
			&lt;property key="foo" value="bar" /&gt;
		&lt;/properties&gt;
	&lt;/bean&gt;

&lt;/camel&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The properties of the bean can be defined using either nested <code>&lt;property&gt;</code> and <code>&lt;properties&gt;</code> elements or using dotted properties style, as shown in the example below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camel&gt;

    &lt;!-- nested properties style --&gt;
	&lt;bean name="beanFromMap" type="com.acme.MyBean"&gt;
		&lt;properties&gt;
			&lt;property key="field1" value="f1_p" /&gt;
			&lt;property key="field2" value="f2_p" /&gt;
			&lt;property key="nested"&gt;
				&lt;properties&gt;
					&lt;property key="field1" value="nf1_p" /&gt;
					&lt;property key="field2" value="nf2_p" /&gt;
				&lt;/properties&gt;
			&lt;/property&gt;
		&lt;/properties&gt;
	&lt;/bean&gt;

    &lt;!-- dotted properties style --&gt;
	&lt;bean name="beanFromProps" type="com.acme.MyBean"&gt;
		&lt;properties&gt;
			&lt;property key="field1" value="f1_p" /&gt;
			&lt;property key="field2" value="f2_p" /&gt;
			&lt;property key="nested.field1" value="nf1_p" /&gt;
			&lt;property key="nested.field2" value="nf2_p" /&gt;
		&lt;/properties&gt;
	&lt;/bean&gt;

&lt;/camel&gt;</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_using_spring_beans_in_camel_xml_dsl"><a class="anchor" href="#_using_spring_beans_in_camel_xml_dsl"></a>Using Spring beans in Camel XML DSL</h4> <div class="paragraph"> <p>Since Camel <strong>4.0.0</strong>, when using <a href="../components/4.8.x/others/java-xml-io-dsl.html" class="xref page">XML DSL</a>, we can also declare <em>beans</em> using Spring Beans XML namespace. All these beans will be added to the <a href="registry.html" class="xref page">Registry</a>.</p> </div> <div class="paragraph"> <p>This will not make the application managed by Spring Framework / Spring Boot. Simply Camel will leverage existing support for generic bean definition including:</p> </div> <div class="ulist"> <ul> <li> <p>dependency injection</p> </li> <li> <p>constructor injection</p> </li> <li> <p>dependency cycles</p> </li> <li> <p>wiring existing Camel objects (like <code>org.apache.camel.CamelContext</code>)</p> </li> </ul> </div> <div class="paragraph"> <p><a href="../components/4.8.x/others/java-xml-io-dsl.html" class="xref page">XML DSL</a> allows using XML documents that define routes, rests and route templates. Since Camel <strong>4.0.0</strong> these documents may use a new root XML element (either <code>&lt;camel&gt;</code> or <code>&lt;beans&gt;</code> to resemble Spring XML DSL), where other Camel elements (like <code>&lt;routes&gt;</code>) are contained.</p> </div> <div class="paragraph"> <p>Here&#8217;s an example <code>camel.xml</code> file, which defines both the routes and beans used (referred to) by the route definition:</p> </div> <div class="listingblock"> <div class="title">camel.xml</div> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camel&gt;

    &lt;beans xmlns="http://www.springframework.org/schema/beans"&gt;
        &lt;bean id="messageString" class="java.lang.String"&gt;
            &lt;constructor-arg index="0" value="Hello"/&gt;
        &lt;/bean&gt;

        &lt;bean id="greeter" class="org.apache.camel.main.app.Greeter"&gt;
            &lt;description&gt;Spring Bean&lt;/description&gt;
            &lt;property name="message"&gt;
                &lt;bean class="org.apache.camel.main.app.GreeterMessage"&gt;
                    &lt;property name="msg" ref="messageString"/&gt;
                &lt;/bean&gt;
            &lt;/property&gt;
        &lt;/bean&gt;
    &lt;/beans&gt;

    &lt;route id="my-route"&gt;
        &lt;from uri="direct:start"/&gt;
        &lt;bean ref="greeter"/&gt;
        &lt;to uri="mock:finish"/&gt;
    &lt;/route&gt;

&lt;/camel&gt;</code></pre> </div> </div> <div class="paragraph"> <p>This document contains embedded <code>&lt;beans&gt;</code> element using Spring Beans XML namespace (<code><a href="http://www.springframework.org/schema/beans" class="bare">http://www.springframework.org/schema/beans</a></code>) - Camel passes this element directly to Spring <code>org.springframework.beans.factory.xml.XmlBeanDefinitionReader</code> and all read beans are used to populate <a href="registry.html" class="xref page">Camel Registry</a>.</p> </div> <div class="paragraph"> <p>The beans declared this way may use references to some predefined Camel beans. Currently, these are handled:</p> </div> <div class="ulist"> <ul> <li> <p><code><em>CamelContext</em></code>: an instance of current <code>org.apache.camel.CamelContext</code></p> </li> <li> <p><code><em>MainConfiguration</em></code>: an instance of <code>org.apache.camel.main.MainConfigurationProperties</code> used for <code>org.apache.camel.main.KameletMain</code></p> </li> </ul> </div> <div class="paragraph"> <p>So we can use this XML fragment without actually defining what <code>CamelContext</code> is.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camel&gt;

    &lt;beans xmlns="http://www.springframework.org/schema/beans"&gt;
        &lt;bean id="greeter" class="org.apache.camel.main.app.Greeter"&gt;
            &lt;property name="camelContext" ref="CamelContext"/&gt;
            &lt;!-- ... --&gt;
        &lt;/bean&gt;
    &lt;/beans&gt;

    &lt;route id="my-route"&gt;
        &lt;from uri="direct:start"/&gt;
        &lt;bean ref="greeter"/&gt;
        &lt;to uri="mock:finish"/&gt;
    &lt;/route&gt;

&lt;/camel&gt;</code></pre> </div> </div> <div class="paragraph"> <p>What&#8217;s more, we can declare some additional beans that can affect internal mechanics of <code>CamelContext</code> being run. <code>org.apache.camel.main.DefaultConfigurationConfigurer</code> is used by <a href="../components/4.8.x/others/main.html" class="xref page">Camel Main</a> to configure <code>CamelContext</code> using beans found in <a href="registry.html" class="xref page">Camel Registry</a>.</p> </div> <div class="paragraph"> <p>For example, we can customize used <code>org.apache.camel.spi.UuidGenerator</code> with this XML fragment to replace UUID generator used by Camel (which defaults to <code>org.apache.camel.support.DefaultUuidGenerator</code>):</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camel&gt;

    &lt;beans xmlns="http://www.springframework.org/schema/beans"&gt;
        &lt;bean id="customUUIDGenerator" class="org.apache.camel.support.ShortUuidGenerator" /&gt;
    &lt;/beans&gt;

&lt;/camel&gt;</code></pre> </div> </div> <div class="paragraph"> <p>That&#8217;s it - Camel context will then look up for the instances of <code>org.apache.camel.spi.UuidGenerator</code> and if one is found, it&#8217;ll be used by Camel.</p> </div> </div> </div> <div class="sect2"> <h3 id="_configuring_jdbc_datasources"><a class="anchor" href="#_configuring_jdbc_datasources"></a>Configuring JDBC DataSources</h3> <div class="paragraph"> <p>When using SQL databases, then you would often need to configure a JDBC connection pool. You can do this:</p> </div> <div class="ulist"> <ul> <li> <p>Manually by adding 3rd party JAR dependency for the data source (and connection pool), and configure this from Java or XML/YAML DSL.</p> </li> <li> <p><strong>Camel 4.6</strong> Spring Boot style with <code>spring.datasource.</code> configuration in <code>application.properties</code> (uses Hikari connection-pool)</p> </li> </ul> </div> <div class="sect3"> <h4 id="_defining_datasource_in_yaml_dsl_as_a_bean"><a class="anchor" href="#_defining_datasource_in_yaml_dsl_as_a_bean"></a>Defining datasource in YAML DSL as a bean</h4> <div class="paragraph"> <p>Here is a snippet how you can declare a bean as the <code>DataSource</code> for a Postgres database in YAML DSL:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- beans:
    - name: PostgresqlDataSource
      properties:
        databaseName: "postgres"
        password: "postgres"
        portNumber: "5432"
        serverName: localhost
        user: postgres
      type: org.postgresql.ds.PGSimpleDataSource</code></pre> </div> </div> <div class="paragraph"> <p>You would then also need to add the JAR dependency with Maven coordinates: <code>org.postgresql:postgresql:42.7.3</code>.</p> </div> </div> <div class="sect3"> <h4 id="_using_a_spring_boot_jdbc_data_source"><a class="anchor" href="#_using_a_spring_boot_jdbc_data_source"></a>Using a Spring Boot JDBC data source</h4> <div class="paragraph"> <p>In <code>application.properties</code> you can set up the datasource such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.datasource.url= jdbc:sqlserver://db.example.net:1433;databaseName=test_db
spring.datasource.username=user
spring.datasource.password=password
spring.datasource.driverClassName=com.microsoft.sqlserver.jdbc.SQLServerDriver</code></pre> </div> </div> <div class="paragraph"> <p>The name of the <code>DataSource</code> will be registered with <code>springDataSource</code>, however you can configure the name via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.datasource.name=myDataSourceNameHere</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Some JDBC drivers are automatic detected by camel-jbang. If not, then you need to add the JAR dependency manually. </td> </tr> </table></div> </div> <div class="paragraph"> <p>And you can configure the Hikari connection-pool (if needed), such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.pool-name=collection-pool</code></pre> </div> </div> <div class="paragraph"> <p>And you can set logging to DEBUG on hikari to see the actual configuration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">logging.level.com.zaxxer.hikari = DEBUG</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="_debugging"><a class="anchor" href="#_debugging"></a>Debugging</h3> <div class="paragraph"> <p>There are two kinds of debugging:</p> </div> <div class="ulist"> <ul> <li> <p><em>Java debugging</em>: Java code debugging (Standard Java)</p> </li> <li> <p><em>Camel route debugging</em>: Debugging Camel routes (requires Camel tooling plugins)</p> </li> </ul> </div> <div class="sect3"> <h4 id="_java_debugging"><a class="anchor" href="#_java_debugging"></a>Java debugging</h4> <div class="paragraph"> <p>Camel JBang makes it easy to do <em>Java debugging</em> when you run your integration with the <code>--jvm-debug</code> option as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run hello.yaml --jmv-debug
Listening for transport dt_socket at address: 4004</code></pre> </div> </div> <div class="paragraph"> <p>As you can see the default listening port is 4004 but can be configured as described in <a href="https://www.jbang.dev/documentation/guide/latest/debugging.html">JBang Debugging</a>.</p> </div> <div class="paragraph"> <p>This is a standard Java debug socket. You can then use the IDE of your choice. For instance, see the generic documentation for <a href="https://www.jetbrains.com/help/idea/attaching-to-local-process.html#create-rc">IntelliJ</a>, <a href="https://code.visualstudio.com/docs/java/java-debugging#_attach">VS Code</a> and <a href="https://www.vogella.com/tutorials/EclipseDebugging/article.html#remote-debugging">Eclipse Desktop</a>. You will surely want to add <code>Processor</code> to be able to put breakpoints hit during route execution (as opposed to route definition creation).</p> </div> <div class="sect4"> <h5 id="_standard_jbang_debugging"><a class="anchor" href="#_standard_jbang_debugging"></a>Standard JBang debugging</h5> <div class="paragraph"> <p>You can debug your integration scripts by making use of the <code>--debug</code> flag provided by JBang.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">jbang --debug  camel@apache/camel run hello.yaml
Listening for transport dt_socket at address: 4004</code></pre> </div> </div> <div class="paragraph"> <p>This makes it possible to debug any of the Camel JBang commands, not only the <code>run</code> command as shown above.</p> </div> </div> </div> <div class="sect3"> <h4 id="_camel_route_debugging"><a class="anchor" href="#_camel_route_debugging"></a>Camel route debugging</h4> <div class="paragraph"> <p>With <strong>Camel 4.2</strong> onwards you can now easily debug Camel routes from the command shell with the <code>debug</code> command as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel debug hello.yaml</code></pre> </div> </div> <div class="paragraph"> <p>This will run the integration (in background), and the current shell running in foreground will act as a CLI based debugger. You can see snippets from the log (in the top), the middle section shown the current breakpoint. And in the bottom you can see content of the message (similar to the <code>camel trace</code> command)</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">2023-11-03 18:15:06.715  INFO 33384 --- [           main] g.apache.camel.main.BaseMainSupport :     [Command Line]                 camel.debug.loggingLevel=DEBUG
2023-11-03 18:15:06.715  INFO 33384 --- [           main] g.apache.camel.main.BaseMainSupport :     [Command Line]                 camel.debug.singleStepIncludeStartEnd=true
2023-11-03 18:15:06.787  INFO 33384 --- [           main] mel.cli.connector.LocalCliConnector : Camel CLI enabled (local)
2023-11-03 18:15:06.833  INFO 33384 --- [           main] el.impl.engine.AbstractCamelContext : Apache Camel 4.7.0 (foo) is starting
2023-11-03 18:15:06.906  INFO 33384 --- [           main] g.apache.camel.main.BaseMainSupport : Property-placeholders summary
2023-11-03 18:15:06.906  INFO 33384 --- [           main] g.apache.camel.main.BaseMainSupport :     [application.properties]       my-name=Donald Duck
2023-11-03 18:15:06.924  INFO 33384 --- [           main] el.impl.engine.AbstractCamelContext : Routes startup (started:1)
2023-11-03 18:15:06.924  INFO 33384 --- [           main] el.impl.engine.AbstractCamelContext :     Started route-07a6 (timer://yaml)
2023-11-03 18:15:06.924  INFO 33384 --- [           main] el.impl.engine.AbstractCamelContext : Apache Camel 4.7.0 (foo) started in 91ms (build:0ms init:0ms start:91ms)
2023-11-03 18:15:11.951  INFO 33384 --- [ - timer://yaml] foo.camel.yaml:10                   : Before:

Source: foo.camel.yaml:13                                                         History
--------------------------------------------------------------------------------  ------------------------------------------------------------------------------------------
  10:              - log:                                                         route-07a6/from-c041           (0ms)    4:       uri: timer
  11:                  message: 'Before: ${body}'                                 route-07a6/log1                (1ms)   10:         - log:
  12:                  id: log1
  13: ---&gt;         - setProperty:
  14:                  name: myProp
  15:                  expression:
  16:                    constant:
  17:                      expression: '123'
  18:                      id: constant-4004


2023-11-03 18:15:11.951  33384 --- [ thread #4 - timer://yaml]              route-07a6/setProperty-321c :     3 - Breakpoint (4ms)
 Exchange  (DefaultExchange)  InOnly  D48642E54410AF9-0000000000000000
 Message   (DefaultMessage)
 Body      (null)


    Breakpoint suspended. Press ENTER to continue.</code></pre> </div> </div> <div class="paragraph"> <p>This is <em>basic</em> but yet powerful, as you have this debugger always readily available, without having to start up VSCode or IDEA tooling.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> The <code>camel debug</code> can debug almost all the DSLs (there is a problem with groovy). </td> </tr> </table></div> </div> <div class="sect4"> <h5 id="_configuring_breakpoints"><a class="anchor" href="#_configuring_breakpoints"></a>Configuring breakpoints</h5> <div class="paragraph"> <p>When using <code>camel debug</code> then breakpoints are by default added to every route. However, you can specify which breakpoints to use instead with the <code>--breakpoint</code> option. This parameter is able to match the Camel routes using a pattern style:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Exact match by node ids</p> </li> <li> <p>Match node ids by pattern (wildcard and regular expression)</p> </li> <li> <p>Match by EIP kind (setHeader, setBody, choice, split, etc.)</p> </li> <li> <p>Match by source and line number</p> </li> <li> <p>Match by line number</p> </li> </ol> </div> <div class="paragraph"> <p>Multiple breakpoints can be separated by comma.</p> </div> <div class="paragraph"> <p>For example, to set a breakpoint at the setHeader EIP, you do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel debug hello.yaml --breakpoint=setHeader</code></pre> </div> </div> <div class="paragraph"> <p>To set a breakpoint at line 18:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel debug hello.yaml --breakpoint=18</code></pre> </div> </div> <div class="paragraph"> <p>To set a breakpoint at line 18 and 34</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel debug hello.yaml --breakpoint=18,34</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="_editing_code_using_vscode_or_idea_editors"><a class="anchor" href="#_editing_code_using_vscode_or_idea_editors"></a>Editing code using VSCode or IDEA editors</h4> <div class="paragraph"> <p>You can use JBang to edit the source code by using the <code>jbang</code> CLI to download dependencies, and set up a project for being ready to load into an IDE of choice, such as IDEA, VSCode, or Eclipse.</p> </div> <div class="paragraph"> <p>This is typically in use when you use Java DSL and have Camel routes in .java source code. To let JBang understand which dependencies are in use, then you need to use JBang style for specifying dependencies by using <code>//DEPS</code> code comments in Java code.</p> </div> <div class="paragraph"> <p>Given the following source file in <code>foo.java</code> file:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//DEPS org.apache.camel:camel-bom:4.3.0@pom
//DEPS org.apache.camel:camel-endpointdsl
//DEPS org.apache.camel:camel-netty-http
//DEPS org.apache.camel:camel-stream

// add more dependencies here

import org.apache.camel.builder.endpoint.EndpointRouteBuilder;
import org.apache.camel.component.netty.http.NettyHttpMessage;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class foo extends EndpointRouteBuilder {

    private static final Logger LOG = LoggerFactory.getLogger(foo.class);

    @Override
    public void configure() {
        from(timer("trigger").period(5000).repeatCount(3))
                .to(nettyHttp("https://random-data-api.com/api/v2/banks").keepAlive(true))
                .process(e -&gt; {
                    // use classes from camel-netty-http dependency in the source code
                    // and have jbang able to generate project with the dependencies ready
                    // to use in your IDE of choice
                    NettyHttpMessage msg = e.getMessage(NettyHttpMessage.class);
                    LOG.info("Netty HTTP response:\n\n\n{}\n\n\n", msg.getHttpResponse());
                })
                .log("Found bank:")
          .to(stream("out"));
    }
}</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can use <code>camel dependency update --source=foo.java</code> to update the dependencies. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Notice how we specify <a href="https://www.jbang.dev/documentation/guide/latest/dependencies.html">JBang dependencies</a> at the top of the file. We want JBang to know and prepare for the IDE of choice. The first <code>//DEPS</code> is the <code>@pom</code> which set up the Camel version to use. The following <code>//DEPS</code> declares the Camel component we use.</p> </div> <div class="paragraph"> <p>You can now open this source file for editing in your IDE of choice by using jbang CLI as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ jbang edit -b foo.java</code></pre> </div> </div> <div class="paragraph"> <p>You can find this example at: <a href="https://github.com/apache/camel-kamelets-examples/tree/main/jbang/jbang-edit" class="bare">https://github.com/apache/camel-kamelets-examples/tree/main/jbang/jbang-edit</a></p> </div> </div> <div class="sect3"> <h4 id="_updating_dependencies_in_source_code"><a class="anchor" href="#_updating_dependencies_in_source_code"></a>Updating dependencies in source code</h4> <div class="paragraph"> <p>When working with Java source code, then you can keep the JBang dependencies up to date using the following command:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel dependency update --source=foo.java</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can use <code>--clean</code> to not keep any existing dependencies and generate a clean fresh list. </td> </tr> </table></div> </div> <div class="paragraph"> <p>This will then automatic insert or update the JBang dependencies (<code>//DEPS</code>) in the top of the source file.</p> </div> <div class="paragraph"> <p>You may want to use this for making it easier to load the source into an IDE editor to do coding. See the previous section for more details.</p> </div> </div> <div class="sect3"> <h4 id="_camel_route_debugging_using_vscode_or_idea_editors"><a class="anchor" href="#_camel_route_debugging_using_vscode_or_idea_editors"></a>Camel route debugging using VSCode or IDEA editors</h4> <div class="paragraph"> <p>The Camel route debugger is available by default (the <code>camel-debug</code> component is automatically added to the classpath). By default, it can be reached through JMX at the URL <code>service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi/camel</code>.</p> </div> <div class="paragraph"> <p>You can then use the Integrated Development Environment (IDE) of your choice. For instance, <a href="https://plugins.jetbrains.com/plugin/9371-apache-camel">IntelliJ</a>, <a href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-debug-adapter-apache-camel">VS Code</a> or <a href="https://marketplace.eclipse.org/content/textual-debugging-apache-camel">Eclipse Desktop</a>.</p> </div> <div class="paragraph"> <p>A specific how-to is available for VS Code, see this <a href="https://youtu.be/owNhWxf42qk">video</a>.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> When exporting to Maven projects, then you can use the maven profile <code>camel.debug</code> that will include the <code>camel-debug</code> JAR to make it possible for Camel IDE tools to do Camel route debugging. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_health_checks"><a class="anchor" href="#_health_checks"></a>Health Checks</h4> <div class="paragraph"> <p>The status of health checks can be accessed via Camel JBang from the CLI as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get health
  PID   NAME    AGE  ID             RL  STATE  RATE    SINCE   MESSAGE
 61005  mybind   8s  camel/context   R   UP    2/2/-  1s/3s/-</code></pre> </div> </div> <div class="paragraph"> <p>Here we can see the Camel is <em>UP</em>. The application has just been running for 8 seconds, and there have been two health checks invoked.</p> </div> <div class="paragraph"> <p>The output is showing the <em>default</em> level of checks as:</p> </div> <div class="ulist"> <ul> <li> <p><code>CamelContext</code> health check</p> </li> <li> <p>Component-specific health checks (such as from <code>camel-kafka</code> or <code>camel-aws</code>, &#8230;&#8203;)</p> </li> <li> <p>Custom health checks</p> </li> <li> <p>Any check that are not UP</p> </li> </ul> </div> <div class="paragraph"> <p>The <em>RATE</em> column shows 3 numbers separated by <code>/</code>. So <code>2/2/-</code> means two checks in total, two successes, and no failures. The two last columns will reset when a health check changes state as this number is the number of consecutive checks that was successful or failure. So if the health check starts to fail, then the numbers could be:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get health
  PID   NAME     AGE   ID             RL  STATE   RATE    SINCE    MESSAGE
 61005  mybind   3m2s  camel/context   R   UP    77/-/3  1s/-/17s  some kind of error</code></pre> </div> </div> <div class="paragraph"> <p>Here we can see the numbers are changed to <code>77/-/3</code>. This means the total is 77. There is no success, but the check has been failing three times in a row. The <em>SINCE</em> column corresponds to the <em>RATE</em>. So in this case, we can see the last check was 1 second ago, and that the check has been failing for 17 seconds in a row.</p> </div> <div class="paragraph"> <p>You can use <code>--level=full</code> to output every health check, that will include consumer and route level checks as well.</p> </div> <div class="paragraph"> <p>A health check may often be failed due to an exception was thrown which can be shown via <code>--trace</code> flag:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel get health --trace
  PID   NAME      AGE   ID                                        RL  STATE    RATE       SINCE     MESSAGE
 61038  mykafka  6m19s  camel/context                             R   UP    187/187/-  1s/6m16s/-
 61038  mykafka  6m19s  camel/kafka-consumer-kafka-not-secure...  R  DOWN   187/-/187  1s/-/6m16s  KafkaConsumer is not ready - Error: Invalid url in bootstrap.servers: value


------------------------------------------------------------------------------------------------------------------------
                                                       STACK-TRACE
------------------------------------------------------------------------------------------------------------------------
	PID: 61038
	NAME: mykafka
	AGE: 6m19s
	CHECK-ID: camel/kafka-consumer-kafka-not-secured-source-1
	STATE: DOWN
	RATE: 187
	SINCE: 6m16s
	METADATA:
		bootstrap.servers = value
		group.id = 7d8117be-41b4-4c81-b4df-cf26b928d38a
		route.id = kafka-not-secured-source-1
		topic = value
	MESSAGE: KafkaConsumer is not ready - Error: Invalid url in bootstrap.servers: value
	org.apache.kafka.common.KafkaException: Failed to construct kafka consumer
		at org.apache.kafka.clients.consumer.KafkaConsumer.&lt;init&gt;(KafkaConsumer.java:823)
		at org.apache.kafka.clients.consumer.KafkaConsumer.&lt;init&gt;(KafkaConsumer.java:664)
		at org.apache.kafka.clients.consumer.KafkaConsumer.&lt;init&gt;(KafkaConsumer.java:645)
		at org.apache.kafka.clients.consumer.KafkaConsumer.&lt;init&gt;(KafkaConsumer.java:625)
		at org.apache.camel.component.kafka.DefaultKafkaClientFactory.getConsumer(DefaultKafkaClientFactory.java:34)
		at org.apache.camel.component.kafka.KafkaFetchRecords.createConsumer(KafkaFetchRecords.java:241)
		at org.apache.camel.component.kafka.KafkaFetchRecords.createConsumerTask(KafkaFetchRecords.java:201)
		at org.apache.camel.support.task.ForegroundTask.run(ForegroundTask.java:123)
		at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:125)
		at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
		at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
		at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
		at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
		at java.base/java.lang.Thread.run(Thread.java:829)
	Caused by: org.apache.kafka.common.config.ConfigException: Invalid url in bootstrap.servers: value
		at org.apache.kafka.clients.ClientUtils.parseAndValidateAddresses(ClientUtils.java:59)
		at org.apache.kafka.clients.ClientUtils.parseAndValidateAddresses(ClientUtils.java:48)
		at org.apache.kafka.clients.consumer.KafkaConsumer.&lt;init&gt;(KafkaConsumer.java:730)
		... 13 more</code></pre> </div> </div> <div class="paragraph"> <p>Here we can easily see that the health check is failing because of the <code>org.apache.kafka.common.config.ConfigException</code> which is due to invalid configuration: <code>Invalid url in bootstrap.servers: value</code>.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Use <code>camel get health --help</code> to see all the various options. </td> </tr> </table></div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_running_with_spring_boot_or_quarkus"><a class="anchor" href="#_running_with_spring_boot_or_quarkus"></a>Running with Spring Boot or Quarkus</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel JBang is <em>primary</em> intended to be Camel standalone only. In <strong>Camel 4.6</strong> onwards, we added limited support for running with Spring Boot or Quarkus, but there are some limitations.</p> </div> <div class="paragraph"> <p>You use the <code>--runtime</code> option to specify which platform to use, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.camel.yaml --runtime=spring-boot</code></pre> </div> </div> <div class="paragraph"> <p>And for Quarkus:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.camel.yaml --runtime=quarkus</code></pre> </div> </div> <div class="paragraph"> <p>When running this way, then Camel JBang is <em>essentially</em> doing an <em>export</em> to a temporary folder, and then running Spring Boot or Quarkus using Maven.</p> </div> <div class="paragraph"> <p>You can do changes to the source file and have Quarkus and Spring Boot reload the routes, just as <code>camel run --dev</code> can do, but uses the natural Spring Boot <em>dev-tools</em> and Quarkus <em>dev mode</em> functionality.</p> </div> <div class="paragraph"> <p>There are several limitations, one would be that Spring Boot and Quarkus cannot automatically detect new components and download JARs. (you can stop and run again to update dependencies).</p> </div> <div class="paragraph"> <p>When using Quarkus, then you can only select the Quarkus version to run. That is locked to a specific Camel version. You can see the versions by <code>camel version list --runtime=quarkus</code>. On the other hand Spring Boot is more flexible where you can choose different Spring Boot and Camel versions (within reasonable range).</p> </div> <div class="paragraph"> <p>For example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.camel.yaml --runtime=spring-boot --spring-boot-version=3.2.3 --camel-version=4.4.1</code></pre> </div> </div> <div class="paragraph"> <p>And for Quarkus:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run foo.camel.yaml --runtime=quarkus --quarkus-version=3.9.4</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_transforming_message_data_mapping"><a class="anchor" href="#_transforming_message_data_mapping"></a>Transforming message (data mapping)</h2> <div class="sectionbody"> <div class="paragraph"> <p>When integrating a system, you often need to transform messages from one system to another. Camel has a rich set of capabilities for this such as various data formats, templating languages, and much more. However, for basic data mapping such as taking an existing incoming JSON document and transforming this to a smaller JSON document, you may want to do this quickly with Camel.</p> </div> <div class="paragraph"> <p>The <code>camel transform message</code> command can be used for such tasks, where it can take an existing source file as input, and then a template that defines how to transform the data, and then show the output (in real time).</p> </div> <div class="paragraph"> <p>For example, given this JSon document (in a file named <code>random.json</code>), we want to combine the name, and select a few fields:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "id": 9914,
  "uid": "eb5fa603-1db6-45f9-912a-431a6ed59b18",
  "password": "ei7gvYKdnN",
  "first_name": "Khalilah",
  "last_name": "Monahan",
  "username": "khalilah.monahan",
  "email": "khalilah.monahan@email.com",
  "avatar": "https://robohash.org/utnumquamexcepturi.png?size=300x300&amp;set=set1",
  "gender": "Agender",
  "phone_number": "+54 (421) 591-5640 x333",
  "social_insurance_number": "268418308",
  "date_of_birth": "1975-03-11",
  "employment": {
    "title": "Product Design Director",
    "key_skill": "Work under pressure"
  },
  "address": {
    "city": "New Fritzchester",
    "street_name": "Patrick Common",
    "street_address": "4538 Reggie Inlet",
    "zip_code": "16282-7045",
    "state": "New York",
    "country": "United States",
    "coordinates": {
      "lat": -1.9868753435474673,
      "lng": 39.09763956726292
    }
  },
  "credit_card": {
    "cc_number": "4493983042212"
  },
  "subscription": {
    "plan": "Student",
    "status": "Active",
    "payment_method": "Debit card",
    "term": "Monthly"
  }
}</code></pre> </div> </div> <div class="paragraph"> <p>Then we can have a <code>transform.json</code> file as the beginning of the template, with the structure of the desired output:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "sid": 123,
	"name": "TODO",
	"country": "TODO",
	"phone": "TODO",
	"student": false
}</code></pre> </div> </div> <div class="paragraph"> <p>We can then run <code>camel transform message</code> and have it update (in real time) the output every time we change the template.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:random.json --language=simple --template=file:transform.json --pretty --watch</code></pre> </div> </div> <div class="paragraph"> <p>What happens is then Camel will output on the console as you go:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> Exchange  (DefaultExchange)  InOut   23F5DD4CE6C260B-0000000000000002
 Message   (DefaultMessage)
 Body      (String) (bytes: 118)
 {
   "sid": 123,
   "name": "TODO",
   "country": "TODO",
   "phone": "TODO",
   "student": false
 }</code></pre> </div> </div> <div class="paragraph"> <p>Then you can update the <code>transform.json</code> file and save it and see the generated output:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "sid": ${jq(.id)},
   "name": "${jq(.first_name)} ${jq(.last_name)}",
   "country": "TODO",
   "phone": "TODO",
   "student": false
}</code></pre> </div> </div> <div class="paragraph"> <p>And the output:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"> Exchange  (DefaultExchange)  InOut   23F5DD4CE6C260B-0000000000000018
 Message   (DefaultMessage)
 Body      (String) (bytes: 158)
 {
   "sid": 9914,
   "name": "Khalilah Monahan",
   "country": "TODO",
   "phone": "TODO",
   "student": false
 }</code></pre> </div> </div> <div class="paragraph"> <p>Then you can continue to update the <code>transform.json</code> until you have the desired result. And if you make a mistake, then you see an error (in red) with stacktrace that hopefully can help you out how to fix this.</p> </div> <div class="sect2"> <h3 id="_transforming_directly_from_the_camel_dsl_source"><a class="anchor" href="#_transforming_directly_from_the_camel_dsl_source"></a>Transforming directly from the Camel DSL source</h3> <div class="paragraph"> <p>In the example above we externalize the transformation into a template file named <code>transform.json</code>. However, it&#8217;s possible to transform directly in the Camel DSL route.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Currently Java DSL is not working in --watch mode (reload on change) </td> </tr> </table></div> </div> <div class="paragraph"> <p>In the following, we cover the json-transform example from: <a href="https://github.com/apache/camel-kamelets-examples/tree/main/jbang/json-transform" class="bare">https://github.com/apache/camel-kamelets-examples/tree/main/jbang/json-transform</a></p> </div> <div class="paragraph"> <p>In this example, a random beer is fetched via the beer-source kamelet. The beer data is as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> {
   "id": 2104,
   "uid": "cefb36e1-e42f-4083-8f97-fc4ff85e56fb",
   "brand": "Pabst Blue Ribbon",
   "name": "St. Bernardus Abt 12",
   "style": "Belgian Strong Ale",
   "hop": "Amarillo",
   "yeast": "1388 - Belgian Strong Ale",
   "malts": "Caramel",
   "ibu": "43 IBU",
   "alcohol": "3.8%",
   "blg": "16.0°Blg"
 }</code></pre> </div> </div> <div class="paragraph"> <p>We save this beer into a file named <code>sample.json</code> as we want to use this as source for message transformation.</p> </div> <div class="paragraph"> <p>Now suppose we want to transform this to a smaller JSON document with only a few elements, then we can do this directly in the route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- route:
    nodePrefixId: route-c38
    id: route-66b0
    from:
      uri: kamelet:beer-source
      id: from-3996
      steps:
        - setBody:
            expression:
              simple:
                expression: &gt;-
                  TODO
                id: simple-b320
            id: setBody-fa01
        - log:
            message: ${body}
            id: log-0c79</code></pre> </div> </div> <div class="paragraph"> <p>As we can see the route has a <code>setBody</code> where we want to transform the message, which we can do with the simple language combined with JQ (or JSonPath). At first, we just write TODO to get started:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel transform message --body=file:sample.json --source=beer-jq.yaml  --watch --pretty</code></pre> </div> </div> <div class="paragraph"> <p>And the output from the transformation is:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> Exchange  (DefaultExchange)  InOut   D9F909701338607-0000000000000004
 Message   (DefaultMessage)
 Body      (String) (bytes: 4)
 TODO</code></pre> </div> </div> <div class="paragraph"> <p>We can now do live updates in the Camel route, and when we save the file, the transform command will output the changes in the terminal. So we modify the DSL to grab the details we want, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">    expression: &gt;-
      {
        "kind": "${jq(.brand)}",
        "beer": "${jq(.name)}"
      }
    id: simple-b320</code></pre> </div> </div> <div class="paragraph"> <p>Notice how we use inlined JQ expressions to grab the desired data from the sample, and when saving the file, we have the result shown in the terminal:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> Exchange  (DefaultExchange)  InOut   D9F909701338607-000000000000003E
 Message   (DefaultMessage)
 Body      (String) (bytes: 78)
 {
   "kind": "Pabst Blue Ribbon",
   "beer": "St. Bernardus Abt 12"
 }</code></pre> </div> </div> <div class="paragraph"> <p>And when we are done with the transformation we can stop by <code>ctrl + c</code> to exit the command.</p> </div> <div class="paragraph"> <p>When transforming messages directly from the DSL (using the <code>--source</code> option), then by default Camel will pick the last expression in the route. If you only have one expression like in this example, then that is easy. But when you have many, then you need to tell which one to use.</p> </div> <div class="paragraph"> <p>You can do this either by referring to the line number in the source code of the EIP / expression, or by its id (if specified).</p> </div> <div class="paragraph"> <p>So suppose the example had many expressions, and the one we want to use is on line 11, then we can do as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel transform message --body=file:sample.json --source=beer-jq.yaml:11  --watch --pretty</code></pre> </div> </div> <div class="paragraph"> <p>Notice how we specify the line number in the source file name, by prefixing with <code>:line-number</code>. The line number does not have to be 100% accurate, as long the number is within range of the EIP, until the next EIP in the route. In the example, this means you can pick number in range 8-17.</p> </div> <div class="paragraph"> <p>If we want to use the id of the expression/EIP, we can do the same as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel transform message --body=file:sample.json --source=beer-jq.yaml:setBody-fa01  --watch --pretty</code></pre> </div> </div> <div class="paragraph"> <p>You can also transform the message from JSON to XML as shown (or any other kind of fixed structure):</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- setBody:
    expression:
      simple:
        expression: &gt;-
          &lt;beer id="${jq(.id)}"&gt;
            &lt;name&gt;${jq(.name)}&lt;/name&gt;
            &lt;kind&gt;${jq(.brand)}&lt;/kind&gt;
          &lt;/beer&gt;
        id: simple-b320
    id: setBody-fa01</code></pre> </div> </div> <div class="paragraph"> <p>You can configure options that the language format should use, such as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:sample.json --language=jsonpath --template="beer.unknown" --option=suppressExceptions=true</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can specify multiple options by repeating the <code>--option</code> argument. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Pay attention that we now use JSONPath as the language, and the template is a tiny JSON path expression. Because the sample does not have a <code>beer.unknown</code> path, then JSonPath would normally throw an exception. This can be suppressed by setting the option <code>suppressExceptions</code> to <code>true</code> as shown above. Then the output is as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">2023-12-04 13:02:50.923  66291 --- Message transformed (success) (239ms)
 Exchange  (DefaultExchange)  InOut   6118686CA3995FF-0000000000000000
 Message   (DefaultMessage)
 Body      (null) (bytes: 14)
 [Body is null]</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_transforming_the_message_using_components"><a class="anchor" href="#_transforming_the_message_using_components"></a>Transforming the message using Components</h3> <div class="paragraph"> <p>Some components can also be used for message transformation such as FlatPack, Velocity, FreeMarker, Thymeleaf, and good old XSLT.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can use <code>camel catalog component --filter=transform</code> to see which components can be transformation. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Given the below XML in the <code>sample.xml</code> file:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hash&gt;
  &lt;id type="integer"&gt;1369&lt;/id&gt;
  &lt;uid&gt;8c946e1a-fdc5-40d3-9098-44271bdfad65&lt;/uid&gt;
  &lt;account-number&gt;8673088731&lt;/account-number&gt;
  &lt;iban&gt;GB38EFUA27474531363797&lt;/iban&gt;
  &lt;bank-name&gt;ABN AMRO MEZZANINE (UK) LIMITED&lt;/bank-name&gt;
  &lt;routing-number&gt;053228004&lt;/routing-number&gt;
  &lt;swift-bic&gt;AACCGB21&lt;/swift-bic&gt;
&lt;/hash&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Then you can transform this using an XSLT named <code>mystyle.xsl</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version = "1.0"?&gt;
&lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"&gt;

  &lt;xsl:template match="/"&gt;
    &lt;bank&gt;
    	&lt;name&gt;&lt;xsl:value-of select="/hash/bank-name/text()"/&gt;&lt;/name&gt;
    	&lt;bic&gt;&lt;xsl:value-of select="/hash/swift-bic/text()"/&gt;&lt;/bic&gt;
    &lt;/bank&gt;
  &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Then you can do live changes to the stylesheet and see the output in real-time with Camel JBang by running:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:sample.xml --component=xslt --template=file:mystyle.xsl --pretty --watch</code></pre> </div> </div> <div class="paragraph"> <p>You can then edit the <code>mystyle.xsl</code> file, and save the file, and watch the terminal for the updated result.</p> </div> <div class="paragraph"> <p>You can find this example at: <a href="https://github.com/apache/camel-kamelets-examples/tree/main/jbang/xslt-transform" class="bare">https://github.com/apache/camel-kamelets-examples/tree/main/jbang/xslt-transform</a></p> </div> <div class="paragraph"> <p>You can configure options that the XSLT component format should use, such as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:sample.xml --component=xslt --template=file:mystyle.xsl --option=output=bytes --pretty --watch</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can specify multiple options by repeating the <code>--option</code> argument. </td> </tr> </table></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The transform message with the component is limited as some components require configuring complex options that cannot be set from command line. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_transforming_a_message_using_data_formats"><a class="anchor" href="#_transforming_a_message_using_data_formats"></a>Transforming a message using Data Formats</h3> <div class="paragraph"> <p>Some data formats can also be used for message transformation such as Base64, Csv, FlatPack.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can use <code>camel catalog dataformat --filter=transform</code> to see which components can be transformation. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Given the below CSV file in the <code>daltons.csv</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Jack Dalton, 115, mad at Averell
Joe Dalton, 105, calming Joe
William Dalton, 105, keeping Joe from killing Averell
Averell Dalton, 80, playing with Rantanplan
Lucky Luke, 120, capturing the Daltons</code></pre> </div> </div> <div class="paragraph"> <p>Then you can transform this via Camel CSV dataformat from its form into Java objects (unmarshal). This will NOT transform the CSV into another format such as XML, but allows you to quickly try out the dataformat, and be able to inspect the Java object inside Camel.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:daltons.csv --dataformat=csv</code></pre> </div> </div> <div class="paragraph"> <p>This will then output:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">2023-12-04 10:53:45.578  55793 --- Message transformed (success) (176ms)
 Exchange  (DefaultExchange)  InOut   6673987D34F3B54-0000000000000000
 Message   (DefaultMessage)
 Body      (ArrayList) (size: 5 bytes: 224)
 [[Jack Dalton,  115,  mad at Averell], [Joe Dalton,  105,  calming Joe], [William Dalton,  105,  keeping Joe from killing Averell], [Averell Dalton,  80,
 playing with Rantanplan], [Lucky Luke,  120,  capturing the Daltons]]</code></pre> </div> </div> <div class="paragraph"> <p>As you can see Camel CSV dataformat will then unmarshal the input (from CSV file) to a <code>java.util.ArrayList</code> object with 5 elements (one per row), and each row is another List of the columns.</p> </div> <div class="paragraph"> <p>You can configure options that the CSV data format should use, such as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ camel transform message --body=file:daltons.csv --dataformat=csv --option=captureHeaderRecord=true</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> You can specify multiple options by repeating the <code>--option</code> argument. </td> </tr> </table></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The transform message with dataformat is limited as some dataformat requires configuring complex options that cannot be set from the command line. </td> </tr> </table></div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_transforming_routes_dsl"><a class="anchor" href="#_transforming_routes_dsl"></a>Transforming routes DSL</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel offers different DSLs, such as Java, XML, YAML, and more. Many graphical editors and code generators use XML and YAML Camel DSL, therefore, for some use cases it may be required to use one DSL or the other. The <code>camel transform route</code> command can be used to transform a YAML route into an XML and vice versa, the command takes a list of files as input and transforms the DSL.</p> </div> <div class="paragraph"> <p>For example, given the following YAML content, in a file named route.yaml</p> </div> <div class="listingblock"> <div class="content"> <pre>- route:
    id: route-b785
    nodePrefixId: route-14b
    from:
      id: from-959e
      uri: direct
      parameters:
        name: start
      steps:
        - choice:
            id: choice-52fe
            when:
              - id: when-b126
                expression:
                  simple:
                    id: simple-576d
                    expression: ${header.foo} == 'bar'
                steps:
                  - to:
                      id: to-65f9
                      uri: jms
                      parameters:
                        destinationName: queue
            otherwise:
              id: otherwise-c07f
              steps:
                - to:
                    id: to-dc76
                    uri: log
                    parameters:
                      loggerName: default</pre> </div> </div> <div class="paragraph"> <p>The following command</p> </div> <div class="listingblock"> <div class="content"> <pre>camel transform route --format=xml /path/to/route.yaml</pre> </div> </div> <div class="paragraph"> <p>Automatically transform the route in XML DSL (Camel XML IO DSL)</p> </div> <div class="listingblock"> <div class="content"> <pre>&lt;camel&gt;
    &lt;route id="route-b785" nodePrefixId="route-14b"&gt;
        &lt;from id="from-959e" uri="direct:start"/&gt;
        &lt;choice id="choice-52fe"&gt;
            &lt;when id="when-b126"&gt;
                &lt;simple&gt;${header.foo} == 'bar'&lt;/simple&gt;
                &lt;to id="to-65f9" uri="jms:queue"/&gt;
            &lt;/when&gt;
            &lt;otherwise id="otherwise-c07f"&gt;
                &lt;to id="to-dc76" uri="log:default"/&gt;
            &lt;/otherwise&gt;
        &lt;/choice&gt;
    &lt;/route&gt;
&lt;/camel&gt;</pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> If all the input files have the same extension and are written with the same DSL, for example, <code>.yaml</code>, the transformation will default to the XML DSL and vice versa. </td> </tr> </table></div> </div> </div> </div> <div class="sect1"> <h2 id="_listing_what_camel_components_are_available"><a class="anchor" href="#_listing_what_camel_components_are_available"></a>Listing what Camel components are available</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel comes with a lot of artifacts out of the box which comes as:</p> </div> <div class="ulist"> <ul> <li> <p>components</p> </li> <li> <p>data formats</p> </li> <li> <p>expression languages</p> </li> <li> <p>miscellaneous components</p> </li> <li> <p>kamelets</p> </li> </ul> </div> <div class="paragraph"> <p>You can use the Camel CLI to list what Camel provides via the <code>camel catalog</code> command. For example, to list all the components</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel catalog component</code></pre> </div> </div> <div class="paragraph"> <p>And to see which Kamelets are available:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel catalog kamelet</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> Use <code>camel catalog --help</code> to see all possible commands. </td> </tr> </table></div> </div> <div class="sect2"> <h3 id="_displaying_component_documentation"><a class="anchor" href="#_displaying_component_documentation"></a>Displaying component documentation</h3> <div class="paragraph"> <p>The <code>doc</code> goal can show quick documentation for every component, dataformat, kamelets etc. For example, to see the kafka component you run:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc kafka</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The documentation is not the full documentation as shown on the website, as the Camel CLI does not have direct access to this information and can only show a basic description of the component, but include tables for every configuration option. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To see the documentation for jackson dataformat:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc jackson</code></pre> </div> </div> <div class="paragraph"> <p>In some rare cases then there may be a component and dataformat with the same name, and the <code>doc</code> goal prioritizes components. In such a situation you can prefix the name with dataformat, i.e.:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc dataformat:thrift</code></pre> </div> </div> <div class="paragraph"> <p>You can also see the kamelet documentation such as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc aws-kinesis-sink</code></pre> </div> </div> <div class="sect3"> <h4 id="_browsing_online_documentation_from_the_camel_website"><a class="anchor" href="#_browsing_online_documentation_from_the_camel_website"></a>Browsing online documentation from the Camel website</h4> <div class="paragraph"> <p>You can use the <code>doc</code> command to quickly open the url in the web browser for the online documentation. For example, to browse the kafka component, you use <code>--open-url</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc kafka --open-url</code></pre> </div> </div> <div class="paragraph"> <p>This also works for data formats, languages, kamelets etc.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc aws-kinesis-sink --open-url</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> To just get the link to the online documentation, then use <code>camel doc kafka --url</code>. </td> </tr> </table></div> </div> </div> <div class="sect3"> <h4 id="_filtering_options_listed_in_the_tables"><a class="anchor" href="#_filtering_options_listed_in_the_tables"></a>Filtering options listed in the tables</h4> <div class="paragraph"> <p>Some components may have many options, and in such cases you may use <code>--filter</code> to only list options that match the filter in either name, description, or the group (producer, security, advanced, etc).</p> </div> <div class="paragraph"> <p>For example, to list only security related options:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc kafka --filter=security</code></pre> </div> </div> <div class="paragraph"> <p>And to list only something about <em>timeout</em>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel doc kafka --filter=timeout</code></pre> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_open_api"><a class="anchor" href="#_open_api"></a>Open API</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel JBang allows quickly exposing an Open API service using <em>contract-first</em> approach, where you have an existing OpenAPI specification file.</p> </div> <div class="paragraph"> <p>Then Camel JBang is able to bridge each API endpoint from the OpenAPI specification to a Camel route with the naming convention <code>direct:&lt;operationId&gt;</code>.</p> </div> <div class="paragraph"> <p>This make it quick to implement a Camel route for a given operation.</p> </div> <div class="paragraph"> <p>See the <a href="https://github.com/apache/camel-kamelets-examples/tree/main/jbang/open-api">open-api example</a> for more details.</p> </div> </div> </div> <div class="sect1"> <h2 id="_gathering_list_of_dependencies"><a class="anchor" href="#_gathering_list_of_dependencies"></a>Gathering list of dependencies</h2> <div class="sectionbody"> <div class="paragraph"> <p>When working with Camel JBang, then dependencies are automatically resolved. This means that you do not have to use a build system like Maven or Gradle to add every Camel component as a dependency.</p> </div> <div class="paragraph"> <p>However, you may want to know what dependencies are required to run the Camel integration. To see this, you can use the <code>dependency</code> command. The command output does not output a detailed tree, such as <code>mvn dependencies:tree</code>, as the output is intended to list which Camel components, and other JARs needed (when using Kamelets).</p> </div> <div class="paragraph"> <p>The dependency output by default is <em>vanilla</em> Apache Camel with the camel-main as runtime, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel dependency list
org.apache.camel:camel-dsl-modeline:3.20.0
org.apache.camel:camel-health:3.20.0
org.apache.camel:camel-kamelet:3.20.0
org.apache.camel:camel-log:3.20.0
org.apache.camel:camel-rest:3.20.0
org.apache.camel:camel-stream:3.20.0
org.apache.camel:camel-timer:3.20.0
org.apache.camel:camel-yaml-dsl:3.20.0
org.apache.camel.kamelets:camel-kamelets-utils:0.9.3
org.apache.camel.kamelets:camel-kamelets:0.9.3</code></pre> </div> </div> <div class="paragraph"> <p>The output is by default a line per maven dependency in GAV format (<em>groupId:artifactId:version</em>).</p> </div> <div class="paragraph"> <p>You can also specify the output should be in <em>Maven format</em> as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel dependency list --output=maven
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-main&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-dsl-modeline&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-health&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-kamelet&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-log&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-rest&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-stream&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-timer&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-yaml-dsl&lt;/artifactId&gt;
    &lt;version&gt;3.20.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel.kamelets&lt;/groupId&gt;
    &lt;artifactId&gt;camel-kamelets-utils&lt;/artifactId&gt;
    &lt;version&gt;0.9.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel.kamelets&lt;/groupId&gt;
    &lt;artifactId&gt;camel-kamelets&lt;/artifactId&gt;
    &lt;version&gt;0.9.3&lt;/version&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>You can also choose the target runtime as either <em>quarkus</em> or <em>spring-boot</em> as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel dependency --runtime=spring-boot
org.springframework.boot:spring-boot-starter-actuator:2.7.5
org.springframework.boot:spring-boot-starter-web:2.7.5
org.apache.camel.springboot:camel-spring-boot-engine-starter:3.20.0
org.apache.camel.springboot:camel-dsl-modeline-starter:3.20.0
org.apache.camel.springboot:camel-kamelet-starter:3.20.0
org.apache.camel.springboot:camel-log-starter:3.20.0
org.apache.camel.springboot:camel-rest-starter:3.20.0
org.apache.camel.springboot:camel-stream-starter:3.20.0
org.apache.camel.springboot:camel-timer-starter:3.20.0
org.apache.camel.springboot:camel-yaml-dsl-starter:3.20
org.apache.camel.kamelets:camel-kamelets-utils:0.9.3
org.apache.camel.kamelets:camel-kamelets:0.9.3</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_generating_sbom_report"><a class="anchor" href="#_generating_sbom_report"></a>Generating SBOM report</h2> <div class="sectionbody"> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">You can generate a SBOM report of your integration by running the following command</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre>camel sbom</pre> </div> </div> <div class="paragraph"> <p>By default, it will generate a file named <code>sbom.json</code> in <code>cyclonedx</code> format.</p> </div> <div class="paragraph"> <p>You can also choose to use an <code>spdx</code> format with the following command</p> </div> <div class="listingblock"> <div class="content"> <pre>camel sbom --sbom-format=spdx</pre> </div> </div> <div class="paragraph"> <p>You can also choose the target runtime as either <em>quarkus</em> or <em>spring-boot</em> as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre>camel sbom --runtime=quarkus</pre> </div> </div> <div class="paragraph"> <p>or</p> </div> <div class="listingblock"> <div class="content"> <pre>camel sbom --runtime=spring-boot</pre> </div> </div> <div class="paragraph"> <p>by default <code>camel-main</code> will be used</p> </div> <div class="sect2"> <h3 id="_copying_dependency_jars_to_a_specific_directory"><a class="anchor" href="#_copying_dependency_jars_to_a_specific_directory"></a>Copying dependency JARs to a specific directory</h3> <div class="paragraph"> <p>You can use the <code>camel dependency copy</code> command to copy the required JARs to a specific folder.</p> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> The <code>camel dependency copy</code> and <code>camel dependency list</code> uses Apache Maven, This requires having Apache Maven installed, and <code>mvn</code> command in PATH environment, so Camel JBang can invoke <code>mvn</code> command. </td> </tr> </table></div> </div> <div class="paragraph"> <p>By default, the JARs are copied to <code>lib</code> folder:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel dependency copy
ls lib
camel-api-3.21.0.jar                    camel-health-3.21.0.jar                 camel-yaml-dsl-3.21.0.jar
camel-base-3.21.0.jar                   camel-main-3.21.0.jar                   camel-yaml-dsl-common-3.21.0.jar
camel-base-engine-3.21.0.jar            camel-management-api-3.21.0.jar         camel-yaml-dsl-deserializers-3.21.0.jar
camel-core-engine-3.21.0.jar            camel-rest-3.21.0.jar                   jakarta.activation-api-1.2.2.jar
camel-core-languages-3.21.0.jar         camel-support-3.21.0.jar                jakarta.xml.bind-api-2.3.3.jar
camel-core-model-3.21.0.jar             camel-timer-3.21.0.jar                  slf4j-api-1.7.36.jar
camel-core-processor-3.21.0.jar         camel-tooling-model-3.21.0.jar          snakeyaml-engine-2.3.jar
camel-core-reifier-3.21.0.jar           camel-util-3.21.0.jar
camel-dsl-support-3.21.0.jar            camel-util-json-3.21.0.jar</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_creating_projects"><a class="anchor" href="#_creating_projects"></a>Creating Projects</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can <em>export</em> your Camel JBang integration to a traditional Java-based project such as Spring Boot or Quarkus.</p> </div> <div class="paragraph"> <p>You may want to do this after you have built a prototype using Camel JBang, and are in need of a traditional Java-based project with more need for Java coding, or wanting to use the powerful runtimes of Spring Boot, Quarkus or vanilla Camel Main.</p> </div> <div class="sect2"> <h3 id="_exporting_to_camel_spring_boot"><a class="anchor" href="#_exporting_to_camel_spring_boot"></a>Exporting to Camel Spring Boot</h3> <div class="paragraph"> <p>The command <code>export --runtime=spring-boot</code> will export your current Camel JBang file(s) to a Maven-based Spring Boot project with files organized in <code>src/main/</code> folder structure.</p> </div> <div class="paragraph"> <p>For example, to export to Spring Boot using the Maven groupId <code><em>com.foo</em></code> and the artifactId <em>acme</em> and with version <em>1.0-SNAPSHOT</em> you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=spring-boot --gav=com.foo:acme:1.0-SNAPSHOT</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> This will export to the <em>current</em> directory, meaning that files are moved into the needed folder structure. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To export to another directly (copies the files), you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=spring-boot --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject</code></pre> </div> </div> <div class="paragraph"> <p>When exporting to Spring Boot then the Camel version defined in the <code>pom.xml</code> or <code>build.gradle</code> is the same version as Camel JBang uses. However, you can specify the Camel version as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=spring-boot --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject --camel-spring-boot-version=3.18.3</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See the possible options by running: <code>camel export --help</code> for more details. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_exporting_to_camel_quarkus"><a class="anchor" href="#_exporting_to_camel_quarkus"></a>Exporting to Camel Quarkus</h3> <div class="paragraph"> <p>The command <code>export --runtime=quarkus</code> will export your current Camel JBang file(s) to a Maven-based Quarkus project with files organized in <code>src/main/</code> folder structure.</p> </div> <div class="paragraph"> <p>For example, to export to Quarkus using the Maven groupId <code><em>com.foo</em></code> and the artifactId <em>acme</em> and with version <em>1.0-SNAPSHOT</em> you simply execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=quarkus --gav=com.foo:acme:1.0-SNAPSHOT</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> This will export to the <em>current</em> directory, meaning that files are moved into the necessary folder structure. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To export to another directly (copies the files) you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=quarkus --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See the possible options by running: <code>camel export --help</code> for more details. </td> </tr> </table></div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> You cannot use <code>--profile</code> option when exporting to Camel Quarkus. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_exporting_to_camel_main"><a class="anchor" href="#_exporting_to_camel_main"></a>Exporting to Camel Main</h3> <div class="paragraph"> <p>The command <code>export --runtime=camel-main</code> will export your current Camel JBang file(s) to a Maven-based vanilla Camel Main project with files organized in <code>src/main/</code> folder structure.</p> </div> <div class="paragraph"> <p>For example, to export to Camel Main using the Maven groupId <em>com.foo</em> and the artifactId <em>acme</em> and with version <em>1.0-SNAPSHOT</em> you simply execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=camel-main --gav=com.foo:acme:1.0-SNAPSHOT</code></pre> </div> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> This will export to the <em>current</em> directory, meaning that files are moved into the needed folder structure. </td> </tr> </table></div> </div> <div class="paragraph"> <p>To export to another directly (copies the files), you execute:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=camel-main --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject</code></pre> </div> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> See the possible options by running: <code>camel export --help</code> for more details. </td> </tr> </table></div> </div> <div class="sect3"> <h4 id="_exporting_with_java_agent_included"><a class="anchor" href="#_exporting_with_java_agent_included"></a>Exporting with Java Agent included</h4> <div class="paragraph"> <p>The Camel Main runtime allows exporting with Java Agents that makes it easier to run your Camel integration with Java Agents such as OpenTelemetry Agent.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> Only <code>camel-main</code> as runtime supports exporting with Java Agents included. </td> </tr> </table></div> </div> <div class="paragraph"> <p>This requires specifying the agent as a dependency with <code>agent:</code> as prefix as shown below in <code>application.properties</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">camel.jbang.dependencies=camel:opentelemetry,agent:io.opentelemetry.javaagent:opentelemetry-javaagent:1.31.0
camel.opentelemetry.enabled=true</code></pre> </div> </div> <div class="paragraph"> <p>Then you can export to <code>--runtime=camel-main</code> as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=camel-main --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject</code></pre> </div> </div> <div class="paragraph"> <p>Then Camel JBang will detect the <code>agent:</code> dependency and download this from Maven and save to a <code>../myproject/agent</code> folder. You can then start the Camel integration from Java via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ../myproject
mvn clean package
java -javaagent:agent/opentelemetry-javaagent-1.31.0.jar -jar target/acme-1.0-SNAPSHOT.jar</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="_exporting_with_selected_files"><a class="anchor" href="#_exporting_with_selected_files"></a>Exporting with selected files</h3> <div class="paragraph"> <p>By default, Camel will export what was last run, or all files from the current directory. You can also explicitly specify which files should be exported.</p> </div> <div class="paragraph"> <p>For example, you may have 3 files in a folder:</p> </div> <div class="ulist"> <ul> <li> <p>Foo.java</p> </li> <li> <p>bar.xml</p> </li> <li> <p>cheese.yaml</p> </li> </ul> </div> <div class="paragraph"> <p>These are 3 Camel routes, and you want to export them into 2 different applications:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export Foo.java --runtime=quarkus --gav=com.foo:acme:1.0-SNAPSHOT --directory=../export1
camel export bar.xml cheese.yaml --runtime=spring-boot --gav=com.foo:cheese:1.0-SNAPSHOT --directory=../export2</code></pre> </div> </div> <div class="paragraph"> <p>As you can see the first export command will only include <code>Foo.java</code>, and then 2nd export includes both <code>bar.xml</code> and <code>cheese.yaml</code>.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> If you have <code>application.properties</code> in the folder as well, then this will be included in both exports. </td> </tr> </table></div> </div> </div> <div class="sect2"> <h3 id="_exporting_as_gradle_project"><a class="anchor" href="#_exporting_as_gradle_project"></a>Exporting as Gradle Project</h3> <div class="paragraph"> <p>Camel JBang exports by default as a Maven-based project. To use Gradle instead, you can specify the <code>--build-tool=gradle</code> when exporting, such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --build-tool=gradle --runtime=spring-boot --gav=com.foo:acme:1.0-SNAPSHOT --directory=../myproject</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_exporting_with_jmx_management_included"><a class="anchor" href="#_exporting_with_jmx_management_included"></a>Exporting with JMX management included</h3> <div class="paragraph"> <p>Usually when exporting to Spring Boot, Quarkus or Camel Main, then JMX management is not included out of the box. To include JMX, you need to add <code>camel:management</code> in the <code>--deps</code> option, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=quarkus --gav=com.foo:acme:1.0-SNAPSHOT --deps=camel:management --directory=../myproject</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_exporting_with_camel_cli_included"><a class="anchor" href="#_exporting_with_camel_cli_included"></a>Exporting with Camel CLI included</h3> <div class="paragraph"> <p>Usually when exporting to Spring Boot, Quarkus or Camel Main, then Camel JBang CLI is not included out of the box. To be able to continue to use Camel CLI (i.e. <code>camel</code>), you need to add <code>camel:cli-connector</code> in the <code>--deps</code> option, as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel export --runtime=quarkus --gav=com.foo:acme:1.0-SNAPSHOT --deps=camel:cli-connector --directory=../myproject</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_configuring_exporting"><a class="anchor" href="#_configuring_exporting"></a>Configuring exporting</h3> <div class="paragraph"> <p>The export command will by default load configuration from <code>application.properties</code> which also can be used to specific parameters for export such as selecting the runtime and java version.</p> </div> <div class="paragraph"> <p>The follow options related to <em>exporting</em>, can be configured in <code>application.properties</code>:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Option</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.runtime</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Runtime (spring-boot, quarkus, or camel-main)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.gav</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The Maven group:artifact:version</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.dependencies</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Additional dependencies (Use commas to separate multiple dependencies). See more details at <a href="#_adding_custom_jars">Adding custom JARs</a>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.excludes</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exclude files by name or pattern. Multiple names can be separated by comma.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.classpathFiles</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Additional files to add to classpath (Use commas to separate multiple files). See more details at <a href="#_adding_custom_jars">Adding custom JARs</a>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.jkubeFiles</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Resource fragments for Kubernetes (Use commas to separate multiple files).</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.javaVersion</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Java version (17 or 21). Java 17 is default.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.kameletsVersion</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Apache Camel Kamelets version</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.localKameletDir</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Local directory for loading Kamelets</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.camelSpringBootVersion</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Camel version to use with Spring Boot</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.springBootVersion</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Spring Boot version</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.quarkusGroupId</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Platform Maven groupId</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.quarkusArtifactId</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Platform Maven artifactId</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.quarkusVersion</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Platform version</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.mavenWrapper</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Include Maven Wrapper files in the exported project</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.gradleWrapper</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Include Gradle Wrapper files in the exported project</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.buildTool</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Build tool to use (Maven or Gradle)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.repos</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Additional maven repositories for download on-demand (Use commas to separate multiple repositories)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.mavenSettings</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Optional location of Maven settings.xml file to configure servers, repositories, mirrors, and proxies. If set to false, not even the default ~/.m2/settings.xml will be used.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.mavenSettingsSecurity</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Optional location of Maven settings-security.xml file to decrypt settings.xml</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.mavenCentralEnabled</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether downloading JARs from Maven Central repository is enabled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.mavenApacheSnapshotEnabled</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether downloading JARs from ASF Maven Snapshot repository is enabled</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.exportDir</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Directory where the project will be exported</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.platform-http.port</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">HTTP server port to use when running standalone Camel, such as when <code>--console</code> is enabled (port 8080 by default).</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.console</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Developer console at /q/dev on local HTTP server (port 8080 by default) when running standalone Camel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.info</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Info console at /q/info on local HTTP server (port 8080 by default) when running standalone Camel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.health</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Health check at /q/health on local HTTP server (port 8080 by default) when running standalone Camel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.metrics</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Metrics (Micrometer and Prometheus) at /q/metrics on local HTTP server (port 8080 by default) when running standalone Camel</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.open-api</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">File name of open-api spec file (JSON or YAML) that are used when using <code>--open-api</code> to generate routes from the swagger/openapi API spec file.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.ignoreLoadingError</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to ignore route loading and compilation errors (use this with care!)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>camel.jbang.jib-maven-plugin-version</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Version to use for jib-maven-plugin if exporting to camel-main and have Kubernetes enabled (jkube.xxx options).</p></td> </tr> </tbody> </table></div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> These are options from the export command, so you can see more details and default values using <code>camel export --help</code>. </td> </tr> </table></div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel JBang <code>config</code> command is used to store and use the user configuration. This eliminates the need to specify CLI options each time. For example, to run a different Camel version, instead of executing</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run * --camel-version=3.18.4</code></pre> </div> </div> <div class="paragraph"> <p>the camel-version can be added to the user configuration such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config set camel-version=3.18.4</code></pre> </div> </div> <div class="paragraph"> <p>Now, the run command picks the user configuration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel run *</code></pre> </div> </div> <div class="paragraph"> <p>The user configuration file is stored in <code>~/.camel-jbang-user.properties</code></p> </div> <div class="admonitionblock important"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> <td class="content"> You cannot use both a set version via <code>camel config set</code> and also a version specified via <code>--camel-version</code> option, i.e., the following is not possible: </td> </tr> </table></div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config set camel-version=4.0.1
camel run * --camel-version=4.3.0</code></pre> </div> </div> <div class="sect2"> <h3 id="_set_and_unset_configuration"><a class="anchor" href="#_set_and_unset_configuration"></a>Set and unset configuration</h3> <div class="paragraph"> <p>Every Camel JBang option is added to the user configuration. For example, to export a simple project such as</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel init foo.yaml
camel config set gav=com.foo:acme:1.0-SNAPSHOT
camel config set runtime=spring-boot
camel config set deps=org.apache.camel.springboot:camel-timer-starter
camel config set camel-spring-boot-version=3.20.1

camel export</code></pre> </div> </div> <div class="paragraph"> <p>User configuration keys are unset using the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config unset camel-spring-boot-version</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_list_and_get_configurations"><a class="anchor" href="#_list_and_get_configurations"></a>List and get configurations</h3> <div class="paragraph"> <p>User configuration keys are listed using the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config list</code></pre> </div> </div> <div class="paragraph"> <p>Following is the output for the above-mentioned configuration.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">runtime = spring-boot
deps = org.apache.camel.springboot:camel-timer-starter
gav = com.foo:acme:1.0-SNAPSHOT</code></pre> </div> </div> <div class="paragraph"> <p>To obtain a value for the given key, use the <code>get</code> command.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config get gav

com.foo:acme:1.0-SNAPSHOT</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_placeholders_substitutes"><a class="anchor" href="#_placeholders_substitutes"></a>Placeholders' substitutes</h3> <div class="paragraph"> <p>User configuration values can be used as placeholder substitutes with command line properties, for example:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">camel config set repos=https://maven.repository.my.repo.com/ga

camel run 'Test.java' --logging-level=info --repos=#repos,https://packages.atlassian.com/maven-external</code></pre> </div> </div> <div class="paragraph"> <p>In this example, since <code>repos</code> is set in the user configuration (<code>config set</code>) and the <code>camel run</code> command declares the placeholder <code>#repos</code>, <code>camel run</code> will replace the placeholder so that both repositories will be used during the execution. Notice, that to refer to the configuration value the syntax is <code>#optionName</code> eg <code>#repos</code>.</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> The placeholder substitution only works for every option that a given Camel command has. You can see all the options a command has via the help, eg <code>camel run --help</code>. </td> </tr> </table></div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h2> <div class="sectionbody"> <div class="paragraph"> <p>When using <a href="https://www.jbang.dev/">JBang</a> then JBang stores state in <code>~/.jbang</code> directory. This is also the location where JBang stores downloaded JARs.</p> </div> <div class="paragraph"> <p>Camel JBang also downloads needed dependencies while running. However, these dependencies are downloaded to your local Maven repository <code>~/.m2</code>.</p> </div> <div class="paragraph"> <p>So if you find problems with running Camel JBang using what is seems like an outdated JAR, then you can try to delete these directories or parts of it.</p> </div> </div> </div> </article> <aside class="toc sidebar" aria-label="Table of contents" data-title="Contents" data-levels="2"> <div class="toc-menu"></div> </aside> </div> </main> </div> <div class="footer-tools"> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../_/img/logo-d-a567cee6fa.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../blog/">Blog</a></dd> <dd><a href="../docs/">Documentation</a></dd> <dd><a href="../community/support/">Community</a></dd> <dd><a href="../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../manual/">User Manual</a></dd> <dd><a href="../components/next/index.html">Components</a></dd> <dd><a href="../camel-k/next/">Camel-K</a></dd> <dd><a href="../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../community/support/">Support</a></dd> <dd><a href="../community/contributing/">Contributing</a></dd> <dd><a href="../community/mailing-list/">Mailing Lists</a></dd> <dd><a href="../community/user-stories/">User stories</a></dd> <dd><a href="../community/articles/">Articles</a></dd> <dd><a href="../community/books/">Books</a></dd> <dd><a href="../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../_/js/site-c215fb6972.js"></script> <script async src="../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script async src="../_/js/vendor/tabs-5aea11bcf5.js" data-sync-storage-key="preferred-tab"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https://camel.apache.org", "sameAs": [ "https://twitter.com/ApacheCamel" ], "logo": "../_/img/logo-d-a567cee6fa.svg", "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Apache Camel", "item": "https://camel.apache.org/" }, { "@type": "ListItem", "position": 2, "name": "User manual", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 3, "name": "default", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 4, "name": "Resources &amp; Guides", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 5, "name": "Camel JBang", "item": "https://camel.apache.org/manual/camel-jbang.html" }] } </script> </body> </html> 