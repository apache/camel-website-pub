<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Apache Camel 4.x Upgrade Guide :: Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/manual/camel-4x-upgrade-guide-4_4.html"> <meta name="generator" content="Antora 3.1.7"> <link rel="stylesheet" href="../_/css/site-b287b96c63.css"> <meta name="application-name" content="Apache Camel"> <meta property="og:title" content="Apache Camel 4.x Upgrade Guide"> <meta property="og:site_name" content="Apache Camel"> <meta property="og:url" content="https://camel.apache.org"> <meta property="og:description" content="Camel is an open source integration framework that empowers you to quickly and easily integrate various systems consuming or producing data."> <meta property="og:type" content="website"> <meta property="og:image" content="https://camel.apache.org/_/img/logo-d-a567cee6fa.svg"> <link rel="manifest" href="../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar" aria-label="Main menu"> <div class="navbar-brand"> <a class="nav-logo" href=".."></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item-section navbar-item navbar-topics" href="../blog/"> <img alt="Blog" src="/_/img/blog-4c7fa4cb60.svg"> Blog </a> <a class="navbar-item-section navbar-item navbar-topics" href="../docs/"> <img alt="Documentation" src="/_/img/documentation-abb1b7f8b1.svg"> Documentation </a> <a class="navbar-item-section navbar-item navbar-topics" href="../community/"> <img alt="Community" src="/_/img/community-2ec8a3dc8b.svg"> Community </a> <a class="navbar-item-section navbar-item navbar-topics" href="../download/"> <img alt="Download" src="/_/img/download-63cdd75074.svg"> Download </a> <a class="navbar-item-section navbar-item navbar-topics" href="../security/"> <img alt="Security" src="/_/img/security-06abe157b3.svg"> Security </a> </div> </div> <div class="navbar-fill"></div> <div class="break-row"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <img src="../_/img/cancel-1ed239489b.svg" alt="Clear" id="search-cancel"> <div id="search_results"></div> </div> <div class="navbar-tools"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg focusable="false" class="brand-icon"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <a id="top"></a> <div class="body"> <div class="nav-container" data-component="manual" data-version=""> <aside class="nav" aria-label="Side menu"> <div class="panels"> <div class="nav-panel-menu is-active"> <nav class="nav-menu" data-panel="menu" aria-label="Topics"> <h3 class="title"><a href="index.html">User manual</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="getting-started.html">Getting started</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Resources &amp; Guides</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/books/">Books</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="building.html">Building</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-console.html">Camel Developer Console</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="camel-jbang.html">Camel JBang</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-kubernetes.html">Camel Kubernetes plugin</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="camel-jbang-k.html">Camel K plugin</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-plugin.html">Camel Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-component-maven-plugin.html">Camel Component Maven Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-report-maven-plugin.html">Camel Maven Report Plugin</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-maven-archetypes.html">Camel Maven Archetypes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="configuring-route-startup-ordering-and-autostartup.html">Configuring route startup ordering and autostartup</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component-dsl.html">Component DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="Endpoint-dsl.html">Endpoint DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dataformat-dsl.html">DataFormat DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="examples.html">Examples</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="graceful-shutdown.html">Graceful Shutdown</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-propertyplaceholder.html">How to use Camel property placeholders</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="variables.html">How to use Variables</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="testing.html">Testing</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="test-infra.html">Test Infra</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="notify-builder.html">NotifyBuilder</a> </li> <li class="nav-item" data-depth="3"> <a class="nav-link" href="advice-with.html">AdviceWith</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="rest-dsl.html">Working with REST and Rest DSL</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="rest-dsl-openapi.html">Rest DSL contract first</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="writing-components.html">Writing Components</a> </li> <li class="nav-item" data-depth="2"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="release-guide.html">Release guide</a> <ul class="nav-list"> <li class="nav-item" data-depth="3"> <a class="nav-link" href="release-guide-website.html">Adding doc versions to the website</a> </li> </ul> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="improving-the-documentation.html">Improving the Documentation</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="migration-and-upgrade.html">Migration and Upgrade</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-4-migration-guide.html">Camel 3.x to 4.0 Migration Guide</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-4x-upgrade-guide.html">Camel 4.x Upgrade Guide</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="architecture.html">Architecture</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-debugger.html">Backlog debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlog-tracer.html">Backlog Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-consumer.html">Batch Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-binding.html">Bean Binding</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-integration.html">Bean Integration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext.html">CamelContext</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext-autoconfigure.html">CamelContext Auto Configuration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="clustering.html">Clustering and Load Balancing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component.html">Component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="data-format.html">Data Format</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="debugger.html">Debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-interceptor.html">Delayer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint.html">Endpoints</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint-annotations.html">Endpoint Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exception-clause.html">Exception Clause</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pooling.html">Exchange Pooling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="http-session-handling.html">HTTP-Session Handling</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-producing.html">POJO Producing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="producertemplate.html">ProducerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="consumertemplate.html">ConsumerTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error Handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange.html">Message Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="expression.html">Expressions</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/content-enricher.html">Content Enrichment</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="injector.html">Injector</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="../components/4.8.x/eips/intercept.html">Intercept</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="jmx.html">JMX</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="oncompletion.html">OnCompletion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pluggable-class-resolvers.html">Pluggable Class Resolvers</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="predicate.html">Predicates</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="processor.html">Processor</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="registry.html">Registry</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-builder.html">RouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lambda-route-builder.html">LambdaRouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-controller.html">RouteController</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-policy.html">RoutePolicy</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-configuration.html">RouteConfiguration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="context-reload.html">ContextReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-reload.html">RouteReload</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-template.html">RouteTemplate</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routes.html">Routes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="startup-condition.html">Startup Condition</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stream-caching.html">Stream caching</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transformer.html">Transformer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="threading-model.html">Threading Model</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="tracer.html">Tracer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="type-converter.html">Type Converter</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uris.html">URIs</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="uuidgenerator.html">UuidGenerator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validator.html">Validator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="health-check.html">Health Checks</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <span class="nav-text">Domain Specific Languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">Languages</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="java-dsl.html">Java DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring.html">Spring support</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle" type="button" aria-label="Expand or contract topic"></button> <a class="nav-link" href="faq/index.html">FAQ</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="/community/support/">How can I get help?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">What languages are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a> </li> </ul> </li> </ul> </li> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <span class="nav-text"><strong>Reference</strong></span> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/index.html">Components</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/dataformats/index.html">Data Formats</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/languages/index.html">Languages</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="../components/4.8.x/eips/enterprise-integration-patterns.html">EIPs</a> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title noversion">User manual</span> </div> <ul class="components"> <li class="component is-current"> <span class="title"> <a href="index.html">User manual</a> </span></li> <li class="component"><span class="title">Camel Components</span> <ul class="versions"> <li class="version"> <a href="../components/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../components/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../components/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../components/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"> <span class="title"> <a href="../camel-core/index.html">Camel Core</a> </span></li> <li class="component"><span class="title">Camel K</span> <ul class="versions"> <li class="version"> <a href="../camel-k/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-k/2.4.x/index.html">2.4.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Kafka Connector</span> <ul class="versions"> <li class="version"> <a href="../camel-kafka-connector/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kafka-connector/4.8.x/index.html">4.8.x</a> </li> </ul></li> <li class="component"><span class="title">Kamelet Catalog</span> <ul class="versions"> <li class="version"> <a href="../camel-kamelets/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-kamelets/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-kamelets/4.4.x/index.html">4.4.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Karaf</span> <ul class="versions"> <li class="version"> <a href="../camel-karaf/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> <li class="component"><span class="title">Camel Quarkus</span> <ul class="versions"> <li class="version"> <a href="../camel-quarkus/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-quarkus/3.15.x/index.html">3.15.x</a> </li> <li class="version"> <a href="../camel-quarkus/3.8.x/index.html">3.8.x</a> </li> </ul></li> <li class="component"><span class="title">Camel Spring Boot</span> <ul class="versions"> <li class="version"> <a href="../camel-spring-boot/next/index.html">Next (Pre-release)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.8.x/index.html">4.8.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/4.4.x/index.html">4.4.x (LTS)</a> </li> <li class="version"> <a href="../camel-spring-boot/3.22.x/index.html">3.22.x (LTS)</a> </li> </ul></li> </ul> </div> </div> </aside> </div> <main class="article"> <nav class="toolbar" aria-label="Toolbar"> <button class="nav-toggle" type="button" aria-label="Toggle submenu"></button> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">User manual</a></li> <li><a href="camel-4x-upgrade-guide-4_4.html">Apache Camel 4.x Upgrade Guide</a></li> </ul> </nav> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/main/docs/user-manual/modules/ROOT/pages/camel-4x-upgrade-guide-4_4.adoc">Edit this Page</a></div> </nav> <div class="content"> <article class="doc"> <h1 class="page">Apache Camel 4.x Upgrade Guide</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>This document is for helping you upgrade your Apache Camel application from Camel 4.x to 4.y. For example, if you are upgrading Camel 4.0 to 4.2, then you should follow the guides from both 4.0 to 4.1 and 4.1 to 4.2.</p> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_from_4_4_3_to_4_4_4"><a class="anchor" href="#_upgrading_from_4_4_3_to_4_4_4"></a>Upgrading from 4.4.3 to 4.4.4</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <code>camel-opentelemetry</code> component has had significant bug fixes to handle span activation/deactivations better when Camel route messages synchronously and asynchronously. This component should also work better on Spring Boot.</p> </div> </div> </div> <div class="sect1"> <h2 id="_upgrading_camel_4_3_to_4_4"><a class="anchor" href="#_upgrading_camel_4_3_to_4_4"></a>Upgrading Camel 4.3 to 4.4</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_camel_core"><a class="anchor" href="#_camel_core"></a>camel-core</h3> <div class="paragraph"> <p>The <code>org.apache.camel.spi.DataFormat</code> has changed exception thrown from <code>IOException</code> to <code>Exception</code> in the unmarshal(Exchange exchange, InputStream stream)` method.</p> </div> <div class="paragraph"> <p>Removed the deprecated constructor from the internal class <code>org.apache.camel.util.StopWatch</code>. Users of this class are advised to use the default constructor if necessary.</p> </div> <div class="paragraph"> <p>The method <code>getCreated</code> from the <code>org.apache.camel.Exchange</code> is now deprecated. Access to the time-related information from the exchange should be done via <code>getClock</code>.</p> </div> <div class="paragraph"> <p>We standardized and consolidated code computing durations so that they use a monotonic clock.</p> </div> <div class="paragraph"> <p>Durations and some time-related information were consolidated in a new internal Clock API.</p> </div> <div class="paragraph"> <p>The <code>lookup</code> method in <code>org.apache.camel.component.properties.PropertiesLookup</code> now has a 2nd parameter for the default value.</p> </div> <div class="paragraph"> <p>Some of the Java DSL for <code>tokenize</code>, <code>xmlTokenize</code>, <code>xpath</code>, <code>xquery</code> and <code>jsonpath</code> has been removed as part of making the DSL model consistent.</p> </div> <div class="paragraph"> <p>Here are a few examples of migration before vs after:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> from("direct:in")
    .choice()
        .when().xpath("/invoice/@orderType = 'premium'", "invoiceDetails")
            .to("mock:premium")
        .when() .xpath("/invoice/@orderType = 'standard'", "invoiceDetails")
            .to("mock:standard")
        .otherwise()
            .to("mock:unknown")
    .end();</code></pre> </div> </div> <div class="paragraph"> <p>You can use the <em>fluent expression</em> builder to configure all the options:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// use fluent builder expression to create the languages
var premium = expression().xpath().expression("/invoice/@orderType = 'premium'").source("header:invoiceDetails").end();
var standard = expression().xpath().expression("/invoice/@orderType = 'standard'").source("header:invoiceDetails").end();

from("direct:in")
    .choice()
        .when(premium)
            .to("mock:premium")
        .when(standard)
            .to("mock:standard")
        .otherwise()
            .to("mock:unknown")
    .end();</code></pre> </div> </div> <div class="paragraph"> <p>In the example above notice how we use <code>source</code> to specify the input to use, in this case a header named invoiceDetails. The <code>source</code> can also be variable, or exchange property.</p> </div> <div class="paragraph"> <p>And another example with <code>tokenize</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("direct:start")
    .split().tokenize("\r\n|\n", true, 2, "\n", true)
        .log("${body}")
        .to("mock:line");</code></pre> </div> </div> <div class="paragraph"> <p>You can use the <em>fluent expression</em> builder to configure all the options:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// use fluent builder expression to create the languages
var token = expression().tokenize().token("\r\n|\n").regex(true).group(2).groupDelimiter("\n").skipFirst(true).end();

from("direct:start")
    .split(token)
        .log("${body}")
        .to("mock:line");</code></pre> </div> </div> <div class="sect3"> <h4 id="_languages"><a class="anchor" href="#_languages"></a>Languages</h4> <div class="paragraph"> <p>The way languages are created and configured by Camel has been refactored to be aligned and avoid a thread-safety issues when using Java DSL. The setter/getter on the <code>Language</code> classes for options that are not general has been removed (such as in <code>TokenizeLanguage</code>).</p> </div> <div class="paragraph"> <p>In XML and YAML DSL the <code>type</code> option in <code>&lt;xquery&gt;</code> has been renamed to <code>resultType</code> to be aligned with the other languages.</p> </div> <div class="paragraph"> <p>In XML and YAML DSL The <code>headerName</code> on <code>&lt;xpath&gt;</code>, <code>&lt;xquery&gt;</code> has been renamed to <code>source</code> and you should prefix the value with <code>header:name</code> to declare it is a header, because other kind of sources can be specified also. The same change has applied to <code>@XPath</code> and <code>@XQuery</code> language annotations.</p> </div> </div> <div class="sect3"> <h4 id="_wiretap_eip"><a class="anchor" href="#_wiretap_eip"></a>WireTap EIP</h4> <div class="paragraph"> <p>The copied exchange is no longer having exchange property CORRELATION_ID set that links to the original exchange. The reason is that this link should only be for EIPs with sub exchanges such as Splitter and Multicast.</p> </div> </div> <div class="sect3"> <h4 id="_throttle_eip"><a class="anchor" href="#_throttle_eip"></a>Throttle EIP</h4> <div class="paragraph"> <p>Previously, Camel used a throttler based on the total number of requests over a period of time ("TotalRequests" mode). That was the default on Camel up to version 4.2.0. On Camel 4.3.0 we introduced a new one based on the number of concurrent requests and replaced the former.</p> </div> <div class="paragraph"> <p>With Camel 4.4.0 we refactored the <a href="../components/4.8.x/eips/throttle-eip.html" class="xref page">Throttle EIP</a> implementation so that Camel can support two different modes of throttling.</p> </div> <div class="paragraph"> <p>Check the component documentation for details about how to use each mode.</p> </div> </div> <div class="sect3"> <h4 id="_mdc_logging"><a class="anchor" href="#_mdc_logging"></a>MDC logging</h4> <div class="paragraph"> <p>When using custom MDC keys (need to configure <code>MDCLoggingKeysPattern</code>) then these custom keys are cleared at the end of routing. Also, custom keys is allowed to be changed during routing, using the <code>MDC.set(myKey, &#8230;&#8203;)</code> Java API.</p> </div> </div> </div> <div class="sect2"> <h3 id="_camel_main"><a class="anchor" href="#_camel_main"></a>camel-main</h3> <div class="paragraph"> <p>The route controller configuration has been moved from general main to its own group. All keys started with <code>camel.main.routesController</code> should be renamed to <code>camel.routecontroller.</code>, for example <code>camel.main.routeControllerBackOffDelay</code> should be renamed to <code>camel.routecontroller.backOffDelay</code>. And the option <code>camel.main.routeControllerSuperviseEnabled</code> has been renamed to <code>camel.routecontroller.enabled</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_kamelet"><a class="anchor" href="#_camel_kamelet"></a>camel-kamelet</h3> <div class="paragraph"> <p>All Kamelets are now turned off error handling in the route templates. This is done to make using Kamelets the same as calling a regular Camel component endpoint. Backwards mode can be enabled by setting <code>noErrorHandler=false</code> on the <code>KameletComponent</code> or as URI parameter <code>to("kamelet:http-sink?noErrorHandler=false&amp;uri=xxxxx")</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_cosmosdb"><a class="anchor" href="#_camel_azure_cosmosdb"></a>camel-azure-cosmosdb</h3> <div class="paragraph"> <p>The <code>useDefaultIdentity</code> parameter has been removed in favor of the credentialType parameter. Now user should select between <code>SHARED_ACCOUNT_KEY</code> and <code>AZURE_IDENTITY</code>. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_eventhubs"><a class="anchor" href="#_camel_azure_eventhubs"></a>camel-azure-eventhubs</h3> <div class="paragraph"> <p>The credentialType parameter has been introduced with three possible values: <code>AZURE_IDENTITY</code>, <code>CONNECTION_STRING</code> and <code>TOKEN_CREDENTIAL</code>. With the <code>CONNECTION_STRING</code> mode the user could explicitly set the <code>connectionString</code> parameters or use the <code>sharedAccessName</code> and <code>sharedAccessKey</code> to automatically build the connection string. With the <code>TOKEN_CREDENTIAL</code> mode the user could pass a <code>TokenCredential</code> instance. With the <code>AZURE_IDENTITY</code> mode the user will be able to use the Default Azure Credentials Chain. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_servicebus"><a class="anchor" href="#_camel_azure_servicebus"></a>camel-azure-servicebus</h3> <div class="paragraph"> <p>The credentialType parameter has been introduced with three possible values: <code>AZURE_IDENTITY</code>, <code>CONNECTION_STRING</code> and <code>TOKEN_CREDENTIAL</code>. With the <code>CONNECTION_STRING</code> mode the user could explicitly set the <code>connectionString</code> parameter. With the <code>TOKEN_CREDENTIAL</code> mode the user could pass a <code>TokenCredential</code> instance. With the <code>AZURE_IDENTITY</code> mode the user will be able to use the Default Azure Credentials Chain. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_files"><a class="anchor" href="#_camel_azure_files"></a>camel-azure-files</h3> <div class="paragraph"> <p>The credentialType parameter has been introduced with three possible values: <code>AZURE_IDENTITY</code>, <code>SHARED_ACCOUNT_KEY</code> and <code>AZURE_SAS</code>. With the <code>SHARED_ACCOUNT_KEY</code> mode the user could explicitly set the <code>sharedKey</code> parameter. With the <code>AZURE_IDENTITY</code> mode the user will be able to use the Default Azure Credentials Chain. With the <code>AZURE_SAS</code> mode the user could explicitly set the token parameter. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_storage_datalake"><a class="anchor" href="#_camel_azure_storage_datalake"></a>camel-azure-storage-datalake</h3> <div class="paragraph"> <p>The useDefaultIdentity parameter has been removed in favor of the <code>credentialType</code> parameter. Now user should select between <code>AZURE_IDENTITY</code>, <code>CLIENT_SECRET</code>, <code>SHARED_KEY_CREDENTIAL</code>, <code>AZURE_SAS</code> and <code>SERVICE_CLIENT_INSTANCE</code>. With the <code>SHARED_KEY_CREDENTIAL</code> mode the user could explicitly set the <code>sharedKey</code> parameter or a <code>SharedKeyCredential</code> instance. With the <code>AZURE_IDENTITY</code> mode the user will be able to use the Default Azure Credentials Chain. With the <code>AZURE_SAS</code> mode the user could explicitly set the <code>sasSignature</code> or <code>sasCredential</code> parameter. With the <code>CLIENT_SECRET</code> mode the user could explicitly set <code>clientId</code>, <code>clientSecret</code> and <code>tenantId</code> or specify a <code>ClientSecretCredential</code> instance. With the <code>SERVICE_CLIENT_INSTANCE</code> the user could explicitly set a <code>serviceClient</code> parameter by passing a <code>DataLakeServiceClient</code> instance. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_azure_storage_queue"><a class="anchor" href="#_camel_azure_storage_queue"></a>camel-azure-storage-queue</h3> <div class="paragraph"> <p>The <code>useDefaultIdentity</code> parameter has been removed in favor of the <code>credentialType</code> parameter. Now user should select between <code>AZURE_IDENTITY</code>, <code>SHARED_KEY_CREDENTIAL</code> and <code>SHARED_ACCOUNT_KEY</code>. With the <code>SHARED_KEY_CREDENTIAL</code> mode the user could explicitly set the <code>SharedKeyCredential</code> instance. With the <code>AZURE_IDENTITY</code> mode the user will be able to use the Default Azure Credentials Chain. With the <code>SHARED_ACCOUNT_KEY</code> mode the user could explicitly set the <code>accessKey</code> parameter. This is part of the effort explained in CAMEL-18590.</p> </div> </div> <div class="sect2"> <h3 id="_camel_cassandraql"><a class="anchor" href="#_camel_cassandraql"></a>camel-cassandraql</h3> <div class="paragraph"> <p>The <code>NamedCassandraAggregationRepository</code> now provides a <code>deserializationFilter</code> parameter. The default value for it is allowing all java packages and subpackages and all <code>org.apache.camel</code> packages and subpackages. If you plan to use particular classes, and you want to expand the filter, you should change the value according to your needs. More details in CAMEL-20306.</p> </div> </div> <div class="sect2"> <h3 id="_camel_coap"><a class="anchor" href="#_camel_coap"></a>camel-coap</h3> <div class="paragraph"> <p>Upgraded from <code>org.eclipse.californium</code> v2 to v3 which was a painful upgrade. Removed the <code>"CamelCoapUri</code> header that would allow a producer to create the dynamic client to send to another URL. Use Camel&#8217;s existing <code>toD</code> EIP for that instead.</p> </div> </div> <div class="sect2"> <h3 id="_camel_consul"><a class="anchor" href="#_camel_consul"></a>camel-consul</h3> <div class="paragraph"> <p>This component has migrated from <code>com.orbitz.consul:consul-client</code> to <code>org.kiwiproject:consul-client</code> as the former is no longer maintained, and kiwiproject took over.</p> </div> </div> <div class="sect2"> <h3 id="_camel_dynamic_router"><a class="anchor" href="#_camel_dynamic_router"></a>camel-dynamic-router</h3> <div class="paragraph"> <p>The dynamic router EIP component now handles control messages through a separate control component: <code>dynamic-router-control</code>. These changes were made after a user reported a bug that resulted in query-parameter-based subscriptions being ignored after the first URI control message was processed. All control message parameters can be submitted as query parameters when subscribers are within the same JVM as the dynamic router instance. Users must use "dynamic to", or <code>toD</code> when sending these control message properties as query parameters. Predicates that are not string expressions may be specified in the message body, or bound to the registry and specified as a reference with the <code>predicateBean</code> parameter. Control messages can still be sent in the message body, as in the previous version. The <code>DynamicRouterControlMessage</code> no longer has separate builders for <code>subscribe</code> and <code>unsubscribe</code> messages, so there is only one builder that you can use for any type of control message. The control channel will now report subscription details for a routing channel if a message with a control action of <code>list</code> is submitted, along with the dynamic router channel of interest. Please see the <code>dynamic-router-eip</code> module in the <code>camel-spring-boot-examples</code> repository for useful examples of how you might need to change your code to be compatible with the changes in this version.</p> </div> </div> <div class="sect2"> <h3 id="_camel_hdfs"><a class="anchor" href="#_camel_hdfs"></a>camel-hdfs</h3> <div class="paragraph"> <p>The component has been removed after deprecation in 4.3.0</p> </div> </div> <div class="sect2"> <h3 id="_camel_jms"><a class="anchor" href="#_camel_jms"></a>camel-jms</h3> <div class="paragraph"> <p>The header with key <code>JMSCorrelationIDAsBytes</code> has changed value from <code>String</code> to <code>byte[]</code>.</p> </div> </div> <div class="sect2"> <h3 id="_camel_jsonata"><a class="anchor" href="#_camel_jsonata"></a>camel-jsonata</h3> <div class="paragraph"> <p>Replaced the previous JSONata library with a new one that offers complete compatibility with the JSONata reference implementation&#8217;s features.</p> </div> </div> <div class="sect2"> <h3 id="_camel_sql"><a class="anchor" href="#_camel_sql"></a>camel-sql</h3> <div class="paragraph"> <p>The JdbcAggregationRepository now provides a deserializationFilter parameter. The default value for it is allowing all java packages and subpackages and all org.apache.camel packages and subpackages. If you plan to use particular classes and you want to expand the filter, you should change the value according to your needs. More details in CAMEL-20303.</p> </div> </div> <div class="sect2"> <h3 id="_camel_facebook"><a class="anchor" href="#_camel_facebook"></a>camel-facebook</h3> <div class="paragraph"> <p>The component was removed without deprecation. The library supporting this component has been unmaintained for a long time. We found no indications that the library itself nor the component are working with modern Facebook, along with the absence of community interest, which lead us to decide to remove this component without deprecation.</p> </div> </div> <div class="sect2"> <h3 id="_camel_kafka"><a class="anchor" href="#_camel_kafka"></a>camel-kafka</h3> <div class="paragraph"> <p>The component now has support for batch processing.</p> </div> </div> <div class="sect2"> <h3 id="_camel_json_validator"><a class="anchor" href="#_camel_json_validator"></a>camel-json-validator</h3> <div class="paragraph"> <p>Removed deprecated <code>org.apache.camel.component.jsonvalidator.DefaultJsonSchemaLoader</code>, use <code>org.apache.camel.component.jsonvalidator.DefaultJsonUriSchemaLoader</code> instead.</p> </div> </div> <div class="sect2"> <h3 id="_camel_splunk_hec"><a class="anchor" href="#_camel_splunk_hec"></a>camel-splunk-hec</h3> <div class="paragraph"> <p>Removed <code>token</code> from the URI&#8217;s path in favor of setting it through a <code>token</code> query parameter. While the <code>token</code> was in the URI path, it could potentially be leaked within the logs.</p> </div> </div> <div class="sect2"> <h3 id="_camel_openapi_java_and_camel_rest_openapi"><a class="anchor" href="#_camel_openapi_java_and_camel_rest_openapi"></a>camel-openapi-java and camel-rest-openapi</h3> <div class="paragraph"> <p>Deprecated support for the old Swagger 2.0 spec. Only OpenAPI v3 specs is supported from Camel 4.5 onwards.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="_camel_spring_boot"><a class="anchor" href="#_camel_spring_boot"></a>Camel Spring Boot</h2> <div class="sectionbody"> <div class="sect2"> <h3 id="_ordering_of_bom_imports"><a class="anchor" href="#_ordering_of_bom_imports"></a>Ordering of BOM imports</h3> <div class="paragraph"> <p>When using Camel on Spring Boot, it&#8217;s recommended to use BOMs to import Camel and Spring dependencies. In Camel 4.4 onwards we changed the order to let Camel be first as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencyManagement&gt;
    &lt;dependencies&gt;
        &lt;!-- Camel BOM --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.camel.springboot&lt;/groupId&gt;
            &lt;artifactId&gt;camel-spring-boot-bom&lt;/artifactId&gt;
            &lt;version&gt;${camel-version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;!-- Spring Boot BOM --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;
            &lt;version&gt;${spring-boot-version}&lt;/version&gt;
            &lt;type&gt;pom&lt;/type&gt;
            &lt;scope&gt;import&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;</code></pre> </div> </div> <div class="paragraph"> <p>In previous versions, then we would have <code>spring-boot-dependencies</code> before <code>camel-spring-boot-bom</code>. However, to better align and ensure Camel starters are using supported dependencies, then it&#8217;s recommended to let Camel be first.</p> </div> </div> <div class="sect2"> <h3 id="_auto_configuration"><a class="anchor" href="#_auto_configuration"></a>Auto Configuration</h3> <div class="paragraph"> <p>The route controller configuration has been moved from general main to its own group. All keys started with <code>camel.springboot.routesController</code> should be renamed to <code>camel.routecontroller.</code>, for example <code>camel.springboot.routeControllerBackOffDelay</code> should be renamed to <code>camel.routecontroller.backOffDelay</code>. And the option <code>camel.springboot.routeControllerSuperviseEnabled</code> has been renamed to <code>camel.routecontroller.enabled</code>.</p> </div> </div> <div class="sect2"> <h3 id="_routes_collector"><a class="anchor" href="#_routes_collector"></a>Routes Collector</h3> <div class="paragraph"> <p>Camel Spring Boot will not honor the <code>camel.springboot.includeNonSingletons</code> option (default false). This means that only singleton <code>RouteBuilder</code> beans is added by default. Previously then prototype scoped beans would be added as well.</p> </div> </div> <div class="sect2"> <h3 id="_camel_platform_http_vertx"><a class="anchor" href="#_camel_platform_http_vertx"></a>camel-platform-http-vertx</h3> <div class="paragraph"> <p>Added configuration to enable Vert.x session handling. Sessions are disabled by default, but can be enabled by setting the <code>enabled</code> property on <code>VertxPlatformHttpServerConfiguration.SessionConfig</code> to <code>true</code>. Other properties include <code>sessionCookieName</code>, <code>sessionCookiePath</code>, <code>sessionTimeout</code>, <code>cookieSecure</code>, <code>cookieHttpOnly</code> <code>cookieSameSite</code> and <code>storeType</code>. The session <code>storeType</code> defaults to the Vert.x <code>LocalSessionStore</code> and <code>cookieSameSite</code> to <code>Strict</code>. The remainder of the properties are configured with Vert.x defaults if not set.</p> </div> </div> </div> </div> </article> <aside class="toc sidebar" aria-label="Table of contents" data-title="Contents" data-levels="2"> <div class="toc-menu"></div> </aside> </div> </main> </div> <div class="footer-tools"> <a href="#top" title="Reach the top of the page">Back to top</a> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../_/img/logo-d-a567cee6fa.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section"> <dl> <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt> <dd><a href="../blog/">Blog</a></dd> <dd><a href="../docs/">Documentation</a></dd> <dd><a href="../community/support/">Community</a></dd> <dd><a href="../download/">Download</a></dd> </dl> <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section"> <dl> <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt> <dd><a href="../manual/">User Manual</a></dd> <dd><a href="../components/next/index.html">Components</a></dd> <dd><a href="../camel-k/next/">Camel-K</a></dd> <dd><a href="../camel-kafka-connector/next/">Camel Kafka Connector</a></dd> <dd><a href="../camel-quarkus/next/">Camel Quarkus</a></dd> <dd><a href="../camel-spring-boot/next/">Camel Spring Boot</a></dd> <dd><a href="../camel-karaf/3.22.x/">Camel Karaf</a></dd> <dd><a href="../manual/faq/index.html">FAQ</a></dd> </dl> <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section"> <dl> <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt> <dd><a href="../community/support/">Support</a></dd> <dd><a href="../community/contributing/">Contributing</a></dd> <dd><a href="../community/mailing-list/">Mailing Lists</a></dd> <dd><a href="../community/user-stories/">User stories</a></dd> <dd><a href="../community/articles/">Articles</a></dd> <dd><a href="../community/books/">Books</a></dd> <dd><a href="../community/team/">Team</a></dd> </dl> <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section"> <dl> <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt> <dd><a href="../acknowledgments/">Acknowledgments</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p class="remark"> &copy; 2004-2024 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> <div class="resources"> <div class="context"> <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy Policy</a> </div> <div class="context"> <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a> </div> <div class="context"> <a href="../sitemap/">Sitemap</a> </div> </div> <div class="footer-icons"> <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#github"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#zulip"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#twitter"/></svg></a> <a rel="noopener noreferrer nofollow" href="https://www.linkedin.com/groups/2447439/" title="Apache Camel group on Linkedin"><svg class="brand-icon" focusable="false"><use xlink:href="../_/img/brand-logos-f2e689f4d4.svg#linkedin"/></svg></a> </div> </div> </footer> <script src="../_/js/vendor/algoliasearch-bad45193e2.js"></script> <script src="../_/js/site-c215fb6972.js"></script> <script async src="../_/js/vendor/highlight-621a10fe1b.js"></script> <script async src="../_/js/vendor/svg4everybody-a0c573f2b9.js"></script> <script async src="../_/js/vendor/tabs-5aea11bcf5.js" data-sync-storage-key="preferred-tab"></script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Organization", "name": "Apache Camel", "url": "https://camel.apache.org", "sameAs": [ "https://twitter.com/ApacheCamel" ], "logo": "../_/img/logo-d-a567cee6fa.svg", "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL." } </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Apache Camel", "item": "https://camel.apache.org/" }, { "@type": "ListItem", "position": 2, "name": "User manual", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 3, "name": "default", "item": "https://camel.apache.org/manual/index.html" }, { "@type": "ListItem", "position": 4, "name": "Apache Camel 4.x Upgrade Guide", "item": "https://camel.apache.org/manual/camel-4x-upgrade-guide-4_4.html" }] } </script> </body> </html> 